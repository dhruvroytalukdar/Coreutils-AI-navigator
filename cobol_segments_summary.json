[{"fileName": "lgacvs01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgacvs01.cbl\"\nStructure: LINKAGE SECTION\nDescription: Analyzing the COBOL data structure reveals that it represents a policy-related data entity. The structure can be divided into several sections: CUSTOMER, POLICY, CLAIM.\nFields: CA-REQUEST-ID, CA-CUSTOMER-NUM, CA-POLICY-NUMPIC, CA-LASTCHANGED"}, {"fileName": "lgapvs01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgapvs01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: CA-REQUEST-ID, CA-RETURN-CODE, CA-CUSTOMER-NUM, CA-POLICY-DATAPIC, POLICY-NUMPIC9, POLICY-COMMON-ISSUE_DATE, ENDOWMENT-REDEFINES-CA-POLICY-SPECIFIC-E-WITH-PROFITSPICX, HOUSEREDEFINES-CA-POLICY-SPECIFIC-H-PROPERTY-TYPEPICX, MOTORREDEFINES-CA-POLICY-SPECIFIC-M-MAKEPICX, COMMERCIALREDEFINES-CA-POLICY-SPECIFIC-B-AddressPICX, CLAIMREDEFINES-CA-POLICY-SPECIFIC-C-NumPIC9"}, {"fileName": "lgacvs01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgacvs01.cbl", "content": " 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-RESP2                  PIC S9(8) COMP.\n\n 01  WS-Comm-Len               PIC S9(8) COMP.\n\n 01  WS-STARTCODE              PIC XX Value spaces.\n\n 01  WS-SYSID                  PIC X(4) Value spaces.\n\n 01  WS-Commarea-Len           PIC S9(4) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGACVS01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(20)\r\n                                        Value ' Write file KSDSCUST'.\n     05 FILLER                 PIC X(6)  VALUE ' RESP='.\n     05 EM-RESPRC              PIC +9(5) USAGE DISPLAY.\n     05 FILLER                 PIC X(7)  VALUE ' RESP2='.\n     05 EM-RESP2RC             PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  CUSTOMER-RECORD-SIZE        PIC S9(4) BINARY VALUE 0225.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgacvs01.cbl\" in the file \"lgacvs01.cbl\"\nStructure: DATA LAYOUT FOR lgacvs01.cbl\nDescription: Legacy COBOL data structure.\nFields: WS-RESP, WS-Comm-Len, WS-SYSID, CUSTOMER-RECORD-SIZE"}, {"fileName": "lgapvs01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgapvs01.cbl", "content": " 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-RESP2                  PIC S9(8) COMP.\n\n 01  WS-Comm-Len               PIC S9(8) COMP.\n\n 01  WS-STARTCODE              PIC XX Value spaces.\n\n 01  WS-SYSID                  PIC X(4) Value spaces.\n\n 01  WS-Commarea-Len           PIC S9(4) COMP.\n\n 01  WF-Policy-Info.\n   03  WF-Policy-Key.\n     05  WF-Request-ID           Pic X.\n     05  WF-Customer-Num         Pic X(10).\n     05  WF-Policy-Num           Pic X(10).\n   03 WF-Policy-Data             Pic X(43).\n   03 WF-C-Policy-Data Redefines WF-Policy-Data.\n     05  WF-B-Postcode           Pic X(8).\n     05  WF-B-Status             Pic 9(4).\n     05  WF-B-Customer           Pic X(31).\n   03 WF-E-Policy-Data Redefines WF-Policy-Data.\n     05  WF-E-WITH-PROFITS       Pic X.\n     05  WF-E-EQUITIES           Pic X.\n     05  WF-E-MANAGED-FUND       Pic X.\n     05  WF-E-FUND-NAME          Pic X(10).\n     05  WF-E-LIFE-ASSURED       Pic X(30).\n   03 WF-H-Policy-Data Redefines WF-Policy-Data.\n     05  WF-H-PROPERTY-TYPE      Pic X(15).\n     05  WF-H-BEDROOMS           Pic 999.\n     05  WF-H-VALUE              Pic 9(8).\n     05  WF-H-POSTCODE           Pic X(8).\n     05  WF-H-HOUSE-NAME         Pic X(9).\n   03 WF-M-Policy-Data Redefines WF-Policy-Data.\n     05  WF-M-MAKE               Pic X(15).\n     05  WF-M-MODEL              Pic X(15).\n     05  WF-M-VALUE              Pic 9(6).\n     05  WF-M-REGNUMBER          Pic X(7).\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGAPVS01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' PNUM='.\n     05 EM-POLNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(20)\r\n                                        Value ' Write file KSDSPOLY'.\n     05 FILLER                 PIC X(6)  VALUE ' RESP='.\n     05 EM-RESPRC              PIC +9(5) USAGE DISPLAY.\n     05 FILLER                 PIC X(7)  VALUE ' RESP2='.\n     05 EM-RESP2RC             PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgapvs01.cbl\" in the file \"lgapvs01.cbl\"\nStructure: DATA LAYOUT FOR lgapvs01.cbl\nDescription: Analysis of a COBOL Data Structure Record Layout\nFields: WF-Policy-Key, WF-Customer-Num, WF-Policy-Num"}, {"fileName": "lgacvs01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-Cusnum\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 166, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgacvs01.cbl\" at line number \"166\"\nBusiness Intent: Retrieve and format customer information, including date and time, and link to an external program for further processing.\nTechnical Action: Uses CICS commands (ASKTIME, FORMATTIME, LINK) to retrieve and manipulate date/time data, and handles error scenarios.\nKeywords: CICS, COBOL, MAINFRAME, DATE/TIME, CUSTOMER INFORMATION, ERROR HANDLING, LINK PROGRAM"}, {"fileName": "lgapvs01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-Cusnum\nMove CA-Policy-Num   To EM-POLNUM\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 197, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgapvs01.cbl\" at line number \"197\"\nBusiness Intent: Retrieve and process customer information, including dates and times.\nTechnical Action: Executes CICS commands to inquire system time, format the date and time, and perform a link program operation to LGSTSQ. It also handles error handling for unexpected lengths of COMMAREA data.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK, COMMAREA, ERROR-MESSAGE, DATE, TIME, CUSTOMER INFORMATION"}, {"fileName": "lgacvs01.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 188, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgacvs01.cbl\" at line number \"188\"\nBusiness Intent: Terminates and returns control to the calling program, effectively ending the current transaction.\nTechnical Action: Uses COBOL commands 'EXIT' and 'GOBACK' to transfer control back to the parent program, typically used in situations where further processing is not required or an error has occurred.\nKeywords: COBOL, Exit, GoBack, Transaction, Error Handling"}, {"fileName": "lgapvs01.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 254, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgapvs01.cbl\" at line number \"254\"\nBusiness Intent: Terminates the current program flow and returns control to the calling program.\nTechnical Action: Executes a COBOL exit statement, which is equivalent to a return from a subroutine or a jump out of a loop. It then executes a GOBACK statement, effectively returning control back to the calling program.\nKeywords: COBOL, exit, goback, return, terminate, program flow"}, {"fileName": "lgacvs01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-Cusnum\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 192, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgacvs01.cbl\" at line number \"192\"\nBusiness Intent: Retrieve and format the current time, then link to an external program (LGSTSQ) with error handling for incomplete responses.\nTechnical Action: Use CICS commands ASKTIME and FORMATTIME to retrieve and format the current date and time. Then use LINK command to call an external program LGSTSQ, passing error messages as needed. Error handling is implemented through IF-THEN statements to handle incomplete responses.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK, LGSTSQ, Error Handling, Time Format"}, {"fileName": "lgapvs01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-Cusnum\nMove CA-Policy-Num   To EM-POLNUM\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 258, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgapvs01.cbl\" at line number \"258\"\nBusiness Intent: This COBOL code segment handles a customer query, extracting date and time information, customer number, policy number, and response codes.\nTechnical Action: The code uses CICS commands to ask for the current system time, format it as MMDDYYYY and TIME, and link to another program (LGSTSQ) with error handling. It also moves data between variables and checks for errors.\nKeywords: COBOL, CICS, Link Program, Error Handling, System Time, Date and Time Formatting, Customer Query"}, {"fileName": "lgipvs01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n         \n03COMMA-DATA.\r\n           \n05Comma-Data-TextPicX(11).\r\n           \n05Comma-Data-KeyPicX(21).\r\n           \n05FILLERPicX(58).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgipvs01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: Comma-Data-Text, Comma-Data-Key"}, {"fileName": "lgipvs01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgipvs01.cbl", "content": " 01  WS-FLAG-TSQE              PIC X.\n\n 01  WS-FLAG-TSQH              PIC X.\n\n 01  WS-FLAG-TSQL              PIC X.\n\n 01  WS-FLAG                   PIC X.\n\n 01  WS-RANDOM-Seed            PIC S9(4) Comp.\n\n 01  WS-RANDOM-Number          PIC 9(8) Comp.\n\n 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-STARTCODE              PIC XX Value spaces.\n\n 01  WS-SYSID                  PIC X(4) Value spaces.\n\n 01  WS-Invokeprog             PIC X(8) Value spaces.\n\n 01  WS-COMMAREA               PIC X(80).\n\n 01  WS-RECV.\n   03 WS-RECV-TRANID           PIC X(5).\n   03 WS-RECV-DATA             PIC X(74).\n\n 01  WS-RECV-LEN               PIC S9(4) COMP Value 80.\n\n 01  WRITE-MSG.\n   03 WRITE-MSG-Text           PIC X(11) Value 'Policy Key='.\n   03 WRITE-MSG-Key.\n     05  WRITE-Msg-Type        Pic X Value 'X'.\n     05  WRITE-Msg-CustNum     Pic 9(10).\n     05  WRITE-Msg-PolNum      Pic 9(10).\n   03 Filler                   PIC X(48) Value Spaces.\n\n 01 PART-KEY.\n   03 PART-KEY-Type           PIC X.\n   03 PART-KEY-Num            PIC 9(10).\n\n 01 CA-AREA.\n   03  CA-POLICY-TYPE          Pic X.\n   03  CA-CUSTOMER-NUM         Pic X(10).\n   03  CA-POLICY-NUM           Pic X(10).\n   03  Filler                  Pic X(43).\n\n 01  DFHCOMMAREA.\n   03  COMMA-DATA.\n     05  Comma-Data-Text      Pic X(11).\n     05  Comma-Data-Key       Pic X(21).\n     05  FILLER               Pic X(58).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgipvs01.cbl\" in the file \"lgipvs01.cbl\"\nStructure: DATA LAYOUT FOR lgipvs01.cbl\nDescription: Legacy COBOL data structure for processing policy information\nFields: WS-RECV-TRANID, WS-RECV-DATA, WRITE-MSG-Key, PART-KEY-Type, PART-KEY-Num, CA-POLICY-TYPE"}, {"fileName": "lgipvs01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\n", "lineNumber": 75, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgipvs01.cbl\" at line number \"75\"\nBusiness Intent: End program execution and return control to the calling program\nTechnical Action: COBOL statement used for unconditional exit from a program or subroutine\nKeywords: exit, goback, cics, program termination"}, {"fileName": "lgipvs01.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 146, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgipvs01.cbl\" at line number \"146\"\nBusiness Intent: Terminate and return control to the calling program\nTechnical Action: COBOL statement sequence that immediately exits and returns control to the previous point of execution\nKeywords: EXIT, GOBACK, COBOL, Program Termination"}, {"fileName": "lgsetup.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n         \n03COMMA-DATA.\r\n           \n05Comma-Data-HPicX(14).\r\n           \n05Comma-Data-HighPic9(10).\r\n           \n05FILLERPicX(60).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgsetup.cbl\"\nStructure: LINKAGE SECTION\nDescription: Analyzing the COBOL Data Structure...\nFields: Comma-Data-HPicX, Comma-Data-HighPic9"}, {"fileName": "lgsetup.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgsetup.cbl", "content": " 01  WS-FLAG-TSQE              PIC X.\n\n 01  WS-FLAG-TSQH              PIC X.\n\n 01  WS-FLAG-TSQL              PIC X.\n\n 01  WS-FLAG                   PIC X.\n\n 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-RECV.\n   03 WS-RECV-TRANID           PIC X(5).\n   03 WS-RECV-DATA             PIC X(74).\n\n 01  WS-RECV-LEN               PIC S9(4) COMP Value 80.\n\n 01  READ-MSG.\n   03 READ-MSG-MSG             PIC X(80).\n\n 01  FILLER REDEFINES Read-MSG.\n   03 FILLER                   PIC X(13).\n   03 READ-CUST-LOW            PIC 9(10).\n\n 01  FILLER REDEFINES Read-MSG.\n   03 FILLER                   PIC X(14).\n   03 READ-CUST-HIGH           PIC 9(10).\n\n 01  WS-Cust-Low               Pic S9(10).\n\n 01  WS-Cust-High              Pic S9(10).\n\n 01  WS-Cust-Number            Pic X(10).\n\n 01  WRITE-MSG.\n   03 WRITE-MSG-E            PIC X(20) Value '**** GENAPP CNTL'.\n   03 WRITE-MSG-L              PIC X(13) Value 'LOW CUSTOMER='.\n   03 WRITE-MSG-LOW            PIC 9(10).\n   03 FILLER                   PIC X.\n   03 WRITE-MSG-H              PIC X(14) Value 'HIGH CUSTOMER='.\n   03 WRITE-MSG-High           PIC 9(10).\n   03 FILLER                   Pic X(60).\n\n 01  FrstCustNum               PIC S9(8)  Value +0000001.\n\n 01  LastCustNum               PIC S9(8)  Value +0000011 COMP.\n\n 01  GENAcount                 PIC X(16) Value 'GENACUSTNUM'.\n\n 01  GENApool                  PIC X(8)  Value 'GENA'.\n\n 01  STSQ-STRT                 PIC X(8)  Value 'GENASTRT'.\n\n 01  STSQ-STAT                 PIC X(8)  Value 'GENASTAT'.\n\n 01  STSQ-ERRS                 PIC X(8)  Value 'GENAERRS'.\n\n 01  GENACNT100                PIC X(16) Value 'GENA01ICUS00'.\n\n 01  GENACNT199                PIC X(16) Value 'GENA01ICUS99'.\n\n 01  GENACNT200                PIC X(16) Value 'GENA01ACUS00'.\n\n 01  GENACNT299                PIC X(16) Value 'GENA01ACUS99'.\n\n 01  GENACNT300                PIC X(16) Value 'GENA01IMOT00'.\n\n 01  GENACNT399                PIC X(16) Value 'GENA01IMOT99'.\n\n 01  GENACNT400                PIC X(16) Value 'GENA01AMOT00'.\n\n 01  GENACNT499                PIC X(16) Value 'GENA01AMOT99'.\n\n 01  GENACNT500                PIC X(16) Value 'GENA01DMOT00'.\n\n 01  GENACNT599                PIC X(16) Value 'GENA01DMOT99'.\n\n 01  GENACNT600                PIC X(16) Value 'GENA01UMOT00'.\n\n 01  GENACNT699                PIC X(16) Value 'GENA01UMOT99'.\n\n 01  GENACNT700                PIC X(16) Value 'GENA01IEND00'.\n\n 01  GENACNT799                PIC X(16) Value 'GENA01IEND99'.\n\n 01  GENACNT800                PIC X(16) Value 'GENA01AEND00'.\n\n 01  GENACNT899                PIC X(16) Value 'GENA01AEND99'.\n\n 01  GENACNT900                PIC X(16) Value 'GENA01DEND00'.\n\n 01  GENACNT999                PIC X(16) Value 'GENA01DEND99'.\n\n 01  GENACNTA00                PIC X(16) Value 'GENA01UEND00'.\n\n 01  GENACNTA99                PIC X(16) Value 'GENA01UEND99'.\n\n 01  GENACNTB00                PIC X(16) Value 'GENA01IHOU00'.\n\n 01  GENACNTB99                PIC X(16) Value 'GENA01IHOU99'.\n\n 01  GENACNTC00                PIC X(16) Value 'GENA01AHOU00'.\n\n 01  GENACNTC99                PIC X(16) Value 'GENA01AHOU99'.\n\n 01  GENACNTD00                PIC X(16) Value 'GENA01DHOU00'.\n\n 01  GENACNTD99                PIC X(16) Value 'GENA01DHOU99'.\n\n 01  GENACNTE00                PIC X(16) Value 'GENA01UHOU00'.\n\n 01  GENACNTE99                PIC X(16) Value 'GENA01UHOU99'.\n\n 01  GENACNTF00                PIC X(16) Value 'GENA01ICOM00'.\n\n 01  GENACNTF99                PIC X(16) Value 'GENA01ICOM99'.\n\n 01  GENACNTG00                PIC X(16) Value 'GENA01ACOM00'.\n\n 01  GENACNTG99                PIC X(16) Value 'GENA01ACOM99'.\n\n 01  GENACNTH00                PIC X(16) Value 'GENA01DCOM00'.\n\n 01  GENACNTH99                PIC X(16) Value 'GENA01DCOM99'.\n\n 01  GENACNTI00                PIC X(16) Value 'GENA01UCUS00'.\n\n 01  GENACNTI99                PIC X(16) Value 'GENA01UCUS99'.\n\n 01  STSQ.\n   03  STSQ-NAME                 PIC X(8) Value 'GENACNTL'.\n\n 01  FILLER REDEFINES STSQ.\n   03 FILLER                   PIC X(4).\n   03 STSQ-EXT                 PIC X(4).\n\n 01 TEMPO                      PIC X(90) VALUE SPACES.\n\n 01 CA-AREA.\n   03  CA-CUSTOMER-NUM         Pic X(10).\n   03  Filler                  Pic X(72).\n\n 01  DFHCOMMAREA.\n   03  COMMA-DATA.\n     05 Comma-Data-H           Pic X(14).\n     05 Comma-Data-High        Pic 9(10).\n     05 FILLER                 Pic X(60).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgsetup.cbl\" in the file \"lgsetup.cbl\"\nStructure: DATA LAYOUT FOR lgsetup.cbl\nDescription: Analyzing the legacy COBOL data structure...\nFields: WS-FLAG-TSQE, WS-RESP, WS-Cust-Low, WS-Cust-High, WS-Cust-Number, READ-CUST-LOW, READ-CUST-HIGH"}, {"fileName": "lgsetup.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\n", "lineNumber": 126, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgsetup.cbl\" at line number \"126\"\nBusiness Intent: Terminate program execution and return control to the calling program.\nTechnical Action: Utilizes the CICS commands 'EXIT' and 'GOBACK' to exit the current program and pass control back to the previous program or transaction.\nKeywords: CICS, Exit Program, GoBack, Mainframe Modernization"}, {"fileName": "lgsetup.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 530, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgsetup.cbl\" at line number \"530\"\nBusiness Intent: Terminates the current program flow and returns control to the calling program.\nTechnical Action: Uses COBOL statements EXIT and GOBACK to exit the program and return control.\nKeywords: COBOL, EXIT, GOBACK"}, {"fileName": "lgdpdb01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n EXEC SQL\r INCLUDE LGCMAREA\r END-EXEC.", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgdpdb01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: LGCMAREA"}, {"fileName": "lgucdb01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n EXEC SQL\r INCLUDE LGCMAREA\r END-EXEC.", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgucdb01.cbl\"\nStructure: LINKAGE SECTION\nDescription: Analysis of the provided COBOL structure.\nFields: DFHCOMMAREA"}, {"fileName": "lgdpdb01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgdpdb01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGDPDB01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGDPDB01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(6)  VALUE ' PNUM='.\n     05 EM-POLNUM              PIC X(10)  VALUE SPACES.\n     05 EM-SQLREQ              PIC X(16) VALUE SPACES.\n     05 FILLER                 PIC X(9)  VALUE ' SQLCODE='.\n     05 EM-SQLRC               PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01 LGDPVS01                  PIC x(8) Value 'LGDPVS01'.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN          PIC S9(4) COMP VALUE +28.\n\n 01 DB2-IN-INTEGERS.\n   03 DB2-CUSTOMERNUM-INT       PIC S9(9) COMP.\n   03 DB2-POLICYNUM-INT         PIC S9(9) COMP.\n\n 01  DFHCOMMAREA.\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgdpdb01.cbl\" in the file \"lgdpdb01.cbl\"\nStructure: DATA LAYOUT FOR lgdpdb01.cbl\nDescription: \nFields: WS-EYECATCHER, WS-TRANSID, WS-TERMID, WS-TASKNUM, WS-CALLEN, WS-ADDR-DFHCOMMAREA"}, {"fileName": "lgucdb01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgucdb01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGUCDB01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n   03 WS-RETRY                 PIC X.\n\n 01 DB2-IN-INTEGERS.\n   03 DB2-CUSTOMERNUM-INT       PIC S9(9) COMP.\n   03 DB2-POLICYNUM-INT         PIC S9(9) COMP.\n   03 DB2-BROKERID-INT          PIC S9(9) COMP.\n   03 DB2-PAYMENT-INT           PIC S9(9) COMP.\n   03 DB2-E-TERM-SINT           PIC S9(4) COMP.\n   03 DB2-E-SUMASSURED-INT      PIC S9(9) COMP.\n   03 DB2-H-BEDROOMS-SINT       PIC S9(4) COMP.\n   03 DB2-H-VALUE-INT           PIC S9(9) COMP.\n   03 DB2-M-VALUE-INT           PIC S9(9) COMP.\n   03 DB2-M-CC-SINT             PIC S9(4) COMP.\n   03 DB2-M-PREMIUM-INT         PIC S9(9) COMP.\n   03 DB2-M-ACCIDENTS-INT       PIC S9(9) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGUCDB01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 EM-SQLREQ              PIC X(16) VALUE SPACES.\n     05 FILLER                 PIC X(9)  VALUE ' SQLCODE='.\n     05 EM-SQLRC               PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  DFHCOMMAREA.\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgucdb01.cbl\" in the file \"lgucdb01.cbl\"\nStructure: DATA LAYOUT FOR lgucdb01.cbl\nDescription: \nFields: , , DB2-CUSTOMERNUM-INT, DB2-POLICYNUM-INT, DB2-BROKERID-INT"}, {"fileName": "lgucdb01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXEC CICS RETURN END-EXEC\n\nEXIT\n\nMOVE ' UPDATE CUST  ' TO EM-SQLREQ\nEXEC SQL\r\n       UPDATE CUSTOMER\r\n       SET\r\n       FIRSTNAME     = :CA-FIRST-NAME,\r\n       LASTNAME      = :CA-LAST-NAME,\r\n       DATEOFBIRTH   = :CA-DOB,\r\n       HOUSENAME     = :CA-HOUSE-NAME,\r\n       HOUSENUMBER   = :CA-HOUSE-NUM,\r\n       POSTCODE      = :CA-POSTCODE,\r\n       PHONEMOBILE   = :CA-PHONE-MOBILE,\r\n       PHONEHOME     = :CA-PHONE-HOME,\r\n       EMAILADDRESS  = :CA-EMAIL-ADDRESS\r\n       WHERE\r\n       CUSTOMERNUMBER = :DB2-CUSTOMERNUM-INT\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n      *>       Non-zero SQLCODE from UPDATE statement\r\n             IF SQLCODE EQUAL 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n\nMOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 101, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgucdb01.cbl\" at line number \"101\"\nBusiness Intent: Update a customer's information in the CUSTOMER table.\nTechnical Action: Executes an SQL UPDATE statement using COBOL code. Handles errors by writing error messages to TD QUEUE(CSMT).\nKeywords: COBOL, CICS, SQL, UPDATE, CUSTOMER, Error Handling"}, {"fileName": "lgdpdb01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\nMOVE ' DELETE POLICY  ' TO EM-SQLREQ\nEXEC SQL\r\n       DELETE\r\n       FROM POLICY\r\n       WHERE ( CUSTOMERNUMBER = :DB2-CUSTOMERNUM-INT AND\r\n       POLICYNUMBER  = :DB2-POLICYNUM-INT      )\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0 Then\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n\nMOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(Ws-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 111, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgdpdb01.cbl\" at line number \"111\"\nBusiness Intent: Delete a policy from the database based on customer number and policy number, handling errors if necessary.\nTechnical Action: Executes an SQL DELETE statement to remove a policy record from the POLICY table in a DB2 database. It also formats the current system time into a human-readable format and links to another program for further processing or error reporting.\nKeywords: COBOL, CICS, DB2, SQL, DELETE, POLICY, CUSTOMERNUMBER, POLICYNUMBER, Error Handling"}, {"fileName": "lgucdb01.cbl", "type": "PARAGRAPH", "name": "END-PROGRAM", "content": "EXEC CICS RETURN END-EXEC\n", "lineNumber": 142, "summary": "The below code segment is a \"PARAGRAPH\" named \"END-PROGRAM\" which is in the file \"lgucdb01.cbl\" at line number \"142\"\nBusiness Intent: Handles a request for returning control to the calling program\nTechnical Action: Executes a CICS Return command\nKeywords: CICS, Return, COBOL"}, {"fileName": "lgucdb01.cbl", "type": "PARAGRAPH", "name": "UPDATE-CUSTOMER-INFO", "content": "MOVE ' UPDATE CUST  ' TO EM-SQLREQ\nEXEC SQL\r\n       UPDATE CUSTOMER\r\n       SET\r\n       FIRSTNAME     = :CA-FIRST-NAME,\r\n       LASTNAME      = :CA-LAST-NAME,\r\n       DATEOFBIRTH   = :CA-DOB,\r\n       HOUSENAME     = :CA-HOUSE-NAME,\r\n       HOUSENUMBER   = :CA-HOUSE-NUM,\r\n       POSTCODE      = :CA-POSTCODE,\r\n       PHONEMOBILE   = :CA-PHONE-MOBILE,\r\n       PHONEHOME     = :CA-PHONE-HOME,\r\n       EMAILADDRESS  = :CA-EMAIL-ADDRESS\r\n       WHERE\r\n       CUSTOMERNUMBER = :DB2-CUSTOMERNUM-INT\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n      *>       Non-zero SQLCODE from UPDATE statement\r\n             IF SQLCODE EQUAL 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 152, "summary": "The below code segment is a \"PARAGRAPH\" named \"UPDATE-CUSTOMER-INFO\" which is in the file \"lgucdb01.cbl\" at line number \"152\"\nBusiness Intent: Update customer information in a database\nTechnical Action: EXEC SQL UPDATE statement\nKeywords: CICS, COBOL, SQL, UPDATE, CUSTOMER, ERROR HANDLING"}, {"fileName": "lgdpdb01.cbl", "type": "PARAGRAPH", "name": "DELETE-POLICY-DB2-INFO", "content": "MOVE ' DELETE POLICY  ' TO EM-SQLREQ\nEXEC SQL\r\n       DELETE\r\n       FROM POLICY\r\n       WHERE ( CUSTOMERNUMBER = :DB2-CUSTOMERNUM-INT AND\r\n       POLICYNUMBER  = :DB2-POLICYNUM-INT      )\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0 Then\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n", "lineNumber": 186, "summary": "The below code segment is a \"PARAGRAPH\" named \"DELETE-POLICY-DB2-INFO\" which is in the file \"lgdpdb01.cbl\" at line number \"186\"\nBusiness Intent: Delete a policy record from the database based on customer and policy numbers.\nTechnical Action: Executes an SQL DELETE statement using DB2, handling potential errors with error code 90 and writing error messages.\nKeywords: COBOL, CICS, DB2, DELETE, SQL, Error Handling"}, {"fileName": "lgucdb01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "MOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 189, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgucdb01.cbl\" at line number \"189\"\nBusiness Intent: Retrieve and format time information for error handling purposes\nTechnical Action: Executing CICS ASKTIME and FORMATTIME commands, processing COMMAREA and linking to 'LGSTSQ' program for error handling\nKeywords: CICS, ASKTIME, FORMATTIME, COMMAREA, ERROR-MESSAGE, SQLCODE, Error Handling"}, {"fileName": "lgdpdb01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "MOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(Ws-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 212, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgdpdb01.cbl\" at line number \"212\"\nBusiness Intent: Retrieve and format the current system time, handle errors, and link to a program ('LGSTSQ') for further processing.\nTechnical Action: COBOL code segment involves MOVE statements, CICS commands (ASKTIME, FORMATTIME), LINK command, and error handling using SQLCODE.\nKeywords: CICS, COBOL, SQLCODE, ASKTIME, FORMATTIME, LINK, Error Handling, System Time Retrieval"}, {"fileName": "lgupdb01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n EXEC SQL\r INCLUDE LGCMAREA\r END-EXEC.", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgupdb01.cbl\"\nStructure: LINKAGE SECTION\nDescription: A COBOL linkage section is used to define a common area that can be shared between multiple programs or modules.\nFields: DFHCOMMAREA"}, {"fileName": "lgupdb01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgupdb01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGUPDB01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n   03 WS-RETRY                 PIC X.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGUPDB01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(6)  VALUE ' PNUM='.\n     05 EM-POLNUM              PIC X(10)  VALUE SPACES.\n     05 EM-SQLREQ              PIC X(16) VALUE SPACES.\n     05 FILLER                 PIC X(9)  VALUE ' SQLCODE='.\n     05 EM-SQLRC               PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN         PIC S9(4) COMP VALUE +28.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4) COMP VALUE +0.\n\n 01 WS-VARY-FIELD.\n   49 WS-VARY-LEN               PIC S9(4) COMP.\n   49 WS-VARY-CHAR              PIC X(3900).\n\n 01 DB2-IN-INTEGERS.\n   03 DB2-CUSTOMERNUM-INT       PIC S9(9) COMP.\n   03 DB2-POLICYNUM-INT         PIC S9(9) COMP.\n   03 DB2-BROKERID-INT          PIC S9(9) COMP.\n   03 DB2-PAYMENT-INT           PIC S9(9) COMP.\n   03 DB2-E-TERM-SINT           PIC S9(4) COMP.\n   03 DB2-E-SUMASSURED-INT      PIC S9(9) COMP.\n   03 DB2-H-BEDROOMS-SINT       PIC S9(4) COMP.\n   03 DB2-H-VALUE-INT           PIC S9(9) COMP.\n   03 DB2-M-VALUE-INT           PIC S9(9) COMP.\n   03 DB2-M-CC-SINT             PIC S9(4) COMP.\n   03 DB2-M-PREMIUM-INT         PIC S9(9) COMP.\n   03 DB2-M-ACCIDENTS-INT       PIC S9(9) COMP.\n\n 01  DFHCOMMAREA.\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgupdb01.cbl\" in the file \"lgupdb01.cbl\"\nStructure: DATA LAYOUT FOR lgupdb01.cbl\nDescription: \nFields: WS-EYECATCHER, WS-TASKNUM, DB2-CUSTOMERNUM-INT, DB2-POLICYNUM-INT"}, {"fileName": "lgupdb01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXEC CICS RETURN END-EXEC\n\nEXIT\n\nMOVE ' FETCH  ROW   ' TO EM-SQLREQ\nEXEC SQL\r\n       FETCH POLICY_CURSOR\r\n       INTO  :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-BROKERID-INT INDICATOR :IND-BROKERID,\r\n       :DB2-BROKERSREF INDICATOR :IND-BROKERSREF,\r\n       :DB2-PAYMENT-INT INDICATOR :IND-PAYMENT\r\n       END-EXEC\nEXIT\n\nMOVE ' OPEN   PCURSOR ' TO EM-SQLREQ\nEXEC SQL\r\n       OPEN POLICY_CURSOR\r\n       END-EXEC\nEvaluate SQLCODE\r\n             When 0\r\n               MOVE '00' TO CA-RETURN-CODE\r\n             When -913\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n             When Other\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-Evaluate\nPERFORM FETCH-DB2-POLICY-ROW\nIF SQLCODE = 0\r\n      *>       Fetch was successful\r\n      *>       Compare timestamp in commarea with that in DB2\r\n             IF CA-LASTCHANGED EQUAL TO DB2-LASTCHANGED\r\n       \r\n      *> ----------------------------------------------------------------*\r\n      *>       Select for Update and Update specific policy type table   *\r\n      *> ----------------------------------------------------------------*\r\n             EVALUATE CA-REQUEST-ID\r\n       \r\n      *> ** Endowment ***\r\n               WHEN '01UEND'\r\n      *>           Call routine to update Endowment table\r\n                 PERFORM UPDATE-ENDOW-DB2-INFO\r\n       \r\n      *> ** House ***\r\n               WHEN '01UHOU'\r\n      *>           Call routine to update Housetable\r\n                 PERFORM UPDATE-HOUSE-DB2-INFO\r\n       \r\n      *> ** Motor ***\r\n               WHEN '01UMOT'\r\n      *>           Call routine to update Motor table\r\n                 PERFORM UPDATE-MOTOR-DB2-INFO\r\n       \r\n             END-EVALUATE\r\n      *> ----------------------------------------------------------------*\r\n              IF CA-RETURN-CODE NOT EQUAL '00'\r\n      *>          Update policy type specific table has failed\r\n      *>          So close cursor and return\r\n                PERFORM CLOSE-PCURSOR\r\n       EXEC CICS RETURN END-EXEC\r\n              END-IF\r\n       \r\n      *> ----------------------------------------------------------------*\r\n      *>         Now update Policy table and set new timestamp           *\r\n      *> ----------------------------------------------------------------*\r\n      *>         Move numeric commarea fields to integer format\r\n               MOVE CA-BROKERID      TO DB2-BROKERID-INT\r\n               MOVE CA-PAYMENT       TO DB2-PAYMENT-INT\r\n       \r\n      *>         Update policy table details\r\n               MOVE ' UPDATE POLICY  ' TO EM-SQLREQ\r\n       EXEC SQL\r\n       UPDATE POLICY\r\n       SET ISSUEDATE        = :CA-ISSUE-DATE,\r\n       EXPIRYDATE       = :CA-EXPIRY-DATE,\r\n       LASTCHANGED      = CURRENT TIMESTAMP ,\r\n       BROKERID         = :DB2-BROKERID-INT,\r\n       BROKERSREFERENCE = :CA-BROKERSREF\r\n       WHERE CURRENT OF POLICY_CURSOR\r\n       END-EXEC\r\n       \r\n      *>         get value of assigned Timestamp for return in commarea\r\n       EXEC SQL\r\n       SELECT LASTCHANGED\r\n       INTO :CA-LASTCHANGED\r\n       FROM POLICY\r\n       WHERE POLICYNUMBER = :DB2-POLICYNUM-INT\r\n       END-EXEC\r\n       \r\n               IF SQLCODE NOT EQUAL 0\r\n      *>           Non-zero SQLCODE from Update of policy table\r\n       EXEC CICS SYNCPOINT ROLLBACK END-EXEC\r\n                   MOVE '90' TO CA-RETURN-CODE\r\n      *>             Write error message to TD QUEUE(CSMT)\r\n                   PERFORM WRITE-ERROR-MESSAGE\r\n               END-IF\r\n       \r\n             ELSE\r\n      *>         Timestamps do not match (policy table v commarea)\r\n               MOVE '02' TO CA-RETURN-CODE\r\n             END-IF\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nPERFORM CLOSE-PCURSOR\n\nMOVE ' CLOSE  PCURSOR' TO EM-SQLREQ\nEXEC SQL\r\n       CLOSE POLICY_CURSOR\r\n       END-EXEC\nEvaluate SQLCODE\r\n             When 0\r\n               MOVE '00' TO CA-RETURN-CODE\r\n             When -501\r\n               MOVE '00' TO CA-RETURN-CODE\r\n               MOVE '-501 detected c' TO EM-SQLREQ\r\n       EXEC CICS RETURN END-EXEC\r\n             When Other\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-Evaluate\nEXIT\n\nMOVE CA-E-TERM        TO DB2-E-TERM-SINT\nMOVE CA-E-SUM-ASSURED TO DB2-E-SUMASSURED-INT\nMOVE ' UPDATE ENDOW ' TO EM-SQLREQ\nEXEC SQL\r\n       UPDATE ENDOWMENT\r\n       SET\r\n       WITHPROFITS   = :CA-E-WITH-PROFITS,\r\n       EQUITIES    = :CA-E-EQUITIES,\r\n       MANAGEDFUND = :CA-E-MANAGED-FUND,\r\n       FUNDNAME    = :CA-E-FUND-NAME,\r\n       TERM        = :DB2-E-TERM-SINT,\r\n       SUMASSURED  = :DB2-E-SUMASSURED-INT,\r\n       LIFEASSURED = :CA-E-LIFE-ASSURED\r\n       WHERE\r\n       POLICYNUMBER = :DB2-POLICYNUM-INT\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n      *>       Non-zero SQLCODE from UPDATE statement\r\n             IF SQLCODE EQUAL 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n\nMOVE CA-H-BEDROOMS    TO DB2-H-BEDROOMS-SINT\nMOVE CA-H-VALUE       TO DB2-H-VALUE-INT\nMOVE ' UPDATE HOUSE ' TO EM-SQLREQ\nEXEC SQL\r\n       UPDATE HOUSE\r\n       SET\r\n       PROPERTYTYPE = :CA-H-PROPERTY-TYPE,\r\n       BEDROOMS     = :DB2-H-BEDROOMS-SINT,\r\n       VALUE        = :DB2-H-VALUE-INT,\r\n       HOUSENAME    = :CA-H-HOUSE-NAME,\r\n       HOUSENUMBER  = :CA-H-HOUSE-NUMBER,\r\n       POSTCODE     = :CA-H-POSTCODE\r\n       WHERE\r\n       POLICYNUMBER = :DB2-POLICYNUM-INT\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n      *>       Non-zero SQLCODE from UPDATE statement\r\n             IF SQLCODE = 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n\nMOVE CA-M-CC          TO DB2-M-CC-SINT\nMOVE CA-M-VALUE       TO DB2-M-VALUE-INT\nMOVE CA-M-PREMIUM     TO DB2-M-PREMIUM-INT\nMOVE CA-M-ACCIDENTS   TO DB2-M-ACCIDENTS-INT\nMOVE ' UPDATE MOTOR ' TO EM-SQLREQ\nEXEC SQL\r\n       UPDATE MOTOR\r\n       SET\r\n       MAKE              = :CA-M-MAKE,\r\n       MODEL             = :CA-M-MODEL,\r\n       VALUE             = :DB2-M-VALUE-INT,\r\n       REGNUMBER         = :CA-M-REGNUMBER,\r\n       COLOUR            = :CA-M-COLOUR,\r\n       CC                = :DB2-M-CC-SINT,\r\n       YEAROFMANUFACTURE = :CA-M-MANUFACTURED,\r\n       PREMIUM           = :DB2-M-PREMIUM-INT,\r\n       ACCIDENTS         = :DB2-M-ACCIDENTS-INT\r\n       WHERE\r\n       POLICYNUMBER      = :DB2-POLICYNUM-INT\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n      *>       Non-zero SQLCODE from UPDATE statement\r\n             IF SQLCODE EQUAL 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n\nMOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 162, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgupdb01.cbl\" at line number \"162\"\nBusiness Intent: mainframe modernization\nTechnical Action: architect\nKeywords: mainframe modernization, COBOL, DB2, SQL, PL/I, CICS, IMS"}, {"fileName": "lgupdb01.cbl", "type": "PARAGRAPH", "name": "END-PROGRAM", "content": "EXEC CICS RETURN END-EXEC\n", "lineNumber": 215, "summary": "The below code segment is a \"PARAGRAPH\" named \"END-PROGRAM\" which is in the file \"lgupdb01.cbl\" at line number \"215\"\nBusiness Intent: Terminate program execution and return control to the calling program\nTechnical Action: EXEC CICS RETURN command is used to exit a program and relinquish control back to the caller, typically used in conjunction with transaction processing systems like CICS (Customer Information Control System)\nKeywords: COBOL, CICS, Transaction Processing, Return Control"}, {"fileName": "lgupdb01.cbl", "type": "PARAGRAPH", "name": "FETCH-DB2-POLICY-ROW", "content": "MOVE ' FETCH  ROW   ' TO EM-SQLREQ\nEXEC SQL\r\n       FETCH POLICY_CURSOR\r\n       INTO  :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-BROKERID-INT INDICATOR :IND-BROKERID,\r\n       :DB2-BROKERSREF INDICATOR :IND-BROKERSREF,\r\n       :DB2-PAYMENT-INT INDICATOR :IND-PAYMENT\r\n       END-EXEC\nEXIT\n", "lineNumber": 228, "summary": "The below code segment is a \"PARAGRAPH\" named \"FETCH-DB2-POLICY-ROW\" which is in the file \"lgupdb01.cbl\" at line number \"228\"\nBusiness Intent: Retrieve policy cursor data from DB2\nTechnical Action: Fetch Policy Cursor using SQL, handling errors if necessary\nKeywords: COBOL, CICS, DB2, SQL, Fetch, Policy Cursor, Error Handling"}, {"fileName": "lgupdb01.cbl", "type": "PARAGRAPH", "name": "UPDATE-POLICY-DB2-INFO", "content": "MOVE ' OPEN   PCURSOR ' TO EM-SQLREQ\nEXEC SQL\r\n       OPEN POLICY_CURSOR\r\n       END-EXEC\nEvaluate SQLCODE\r\n             When 0\r\n               MOVE '00' TO CA-RETURN-CODE\r\n             When -913\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n             When Other\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-Evaluate\nPERFORM FETCH-DB2-POLICY-ROW\nIF SQLCODE = 0\r\n      *>       Fetch was successful\r\n      *>       Compare timestamp in commarea with that in DB2\r\n             IF CA-LASTCHANGED EQUAL TO DB2-LASTCHANGED\r\n       \r\n      *> ----------------------------------------------------------------*\r\n      *>       Select for Update and Update specific policy type table   *\r\n      *> ----------------------------------------------------------------*\r\n             EVALUATE CA-REQUEST-ID\r\n       \r\n      *> ** Endowment ***\r\n               WHEN '01UEND'\r\n      *>           Call routine to update Endowment table\r\n                 PERFORM UPDATE-ENDOW-DB2-INFO\r\n       \r\n      *> ** House ***\r\n               WHEN '01UHOU'\r\n      *>           Call routine to update Housetable\r\n                 PERFORM UPDATE-HOUSE-DB2-INFO\r\n       \r\n      *> ** Motor ***\r\n               WHEN '01UMOT'\r\n      *>           Call routine to update Motor table\r\n                 PERFORM UPDATE-MOTOR-DB2-INFO\r\n       \r\n             END-EVALUATE\r\n      *> ----------------------------------------------------------------*\r\n              IF CA-RETURN-CODE NOT EQUAL '00'\r\n      *>          Update policy type specific table has failed\r\n      *>          So close cursor and return\r\n                PERFORM CLOSE-PCURSOR\r\n       EXEC CICS RETURN END-EXEC\r\n              END-IF\r\n       \r\n      *> ----------------------------------------------------------------*\r\n      *>         Now update Policy table and set new timestamp           *\r\n      *> ----------------------------------------------------------------*\r\n      *>         Move numeric commarea fields to integer format\r\n               MOVE CA-BROKERID      TO DB2-BROKERID-INT\r\n               MOVE CA-PAYMENT       TO DB2-PAYMENT-INT\r\n       \r\n      *>         Update policy table details\r\n               MOVE ' UPDATE POLICY  ' TO EM-SQLREQ\r\n       EXEC SQL\r\n       UPDATE POLICY\r\n       SET ISSUEDATE        = :CA-ISSUE-DATE,\r\n       EXPIRYDATE       = :CA-EXPIRY-DATE,\r\n       LASTCHANGED      = CURRENT TIMESTAMP ,\r\n       BROKERID         = :DB2-BROKERID-INT,\r\n       BROKERSREFERENCE = :CA-BROKERSREF\r\n       WHERE CURRENT OF POLICY_CURSOR\r\n       END-EXEC\r\n       \r\n      *>         get value of assigned Timestamp for return in commarea\r\n       EXEC SQL\r\n       SELECT LASTCHANGED\r\n       INTO :CA-LASTCHANGED\r\n       FROM POLICY\r\n       WHERE POLICYNUMBER = :DB2-POLICYNUM-INT\r\n       END-EXEC\r\n       \r\n               IF SQLCODE NOT EQUAL 0\r\n      *>           Non-zero SQLCODE from Update of policy table\r\n       EXEC CICS SYNCPOINT ROLLBACK END-EXEC\r\n                   MOVE '90' TO CA-RETURN-CODE\r\n      *>             Write error message to TD QUEUE(CSMT)\r\n                   PERFORM WRITE-ERROR-MESSAGE\r\n               END-IF\r\n       \r\n             ELSE\r\n      *>         Timestamps do not match (policy table v commarea)\r\n               MOVE '02' TO CA-RETURN-CODE\r\n             END-IF\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nPERFORM CLOSE-PCURSOR\n", "lineNumber": 251, "summary": "The below code segment is a \"PARAGRAPH\" named \"UPDATE-POLICY-DB2-INFO\" which is in the file \"lgupdb01.cbl\" at line number \"251\"\nBusiness Intent: Update Policy Table and Set New Timestamp for Endowment, House, or Motor Policies\nTechnical Action: Fetch and Update Policy Type Specific Tables in DB2, then Update Policy Table with Current Timestamp\nKeywords: COBOL, CICS, DB2, Policy Management, Endowment, House, Motor, Timestamp, Update, Fetch, SQLCODE"}, {"fileName": "lgupdb01.cbl", "type": "PARAGRAPH", "name": "CLOSE-PCURSOR", "content": "MOVE ' CLOSE  PCURSOR' TO EM-SQLREQ\nEXEC SQL\r\n       CLOSE POLICY_CURSOR\r\n       END-EXEC\nEvaluate SQLCODE\r\n             When 0\r\n               MOVE '00' TO CA-RETURN-CODE\r\n             When -501\r\n               MOVE '00' TO CA-RETURN-CODE\r\n               MOVE '-501 detected c' TO EM-SQLREQ\r\n       EXEC CICS RETURN END-EXEC\r\n             When Other\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-Evaluate\nEXIT\n", "lineNumber": 362, "summary": "The below code segment is a \"PARAGRAPH\" named \"CLOSE-PCURSOR\" which is in the file \"lgupdb01.cbl\" at line number \"362\"\nBusiness Intent: Close a cursor using SQL and handle potential errors\nTechnical Action: Executes a CLOSE POLICY_CURSOR SQL statement and handles the resulting SQLCODE value\nKeywords: COBOL, CICS, SQL, CLOSE, CURSOR, ERROR HANDLING"}, {"fileName": "lgupdb01.cbl", "type": "PARAGRAPH", "name": "UPDATE-ENDOW-DB2-INFO", "content": "MOVE CA-E-TERM        TO DB2-E-TERM-SINT\nMOVE CA-E-SUM-ASSURED TO DB2-E-SUMASSURED-INT\nMOVE ' UPDATE ENDOW ' TO EM-SQLREQ\nEXEC SQL\r\n       UPDATE ENDOWMENT\r\n       SET\r\n       WITHPROFITS   = :CA-E-WITH-PROFITS,\r\n       EQUITIES    = :CA-E-EQUITIES,\r\n       MANAGEDFUND = :CA-E-MANAGED-FUND,\r\n       FUNDNAME    = :CA-E-FUND-NAME,\r\n       TERM        = :DB2-E-TERM-SINT,\r\n       SUMASSURED  = :DB2-E-SUMASSURED-INT,\r\n       LIFEASSURED = :CA-E-LIFE-ASSURED\r\n       WHERE\r\n       POLICYNUMBER = :DB2-POLICYNUM-INT\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n      *>       Non-zero SQLCODE from UPDATE statement\r\n             IF SQLCODE EQUAL 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 387, "summary": "The below code segment is a \"PARAGRAPH\" named \"UPDATE-ENDOW-DB2-INFO\" which is in the file \"lgupdb01.cbl\" at line number \"387\"\nBusiness Intent: Update endowment policy details and handle errors accordingly.\nTechnical Action: Executes an SQL UPDATE statement to modify policy information in a database, handling potential errors with error codes and logging error messages.\nKeywords: COBOL, CICS, DB2, SQL, ENDOWMENT, POLICY, UPDATE, ERROR HANDLING"}, {"fileName": "lgupdb01.cbl", "type": "PARAGRAPH", "name": "UPDATE-HOUSE-DB2-INFO", "content": "MOVE CA-H-BEDROOMS    TO DB2-H-BEDROOMS-SINT\nMOVE CA-H-VALUE       TO DB2-H-VALUE-INT\nMOVE ' UPDATE HOUSE ' TO EM-SQLREQ\nEXEC SQL\r\n       UPDATE HOUSE\r\n       SET\r\n       PROPERTYTYPE = :CA-H-PROPERTY-TYPE,\r\n       BEDROOMS     = :DB2-H-BEDROOMS-SINT,\r\n       VALUE        = :DB2-H-VALUE-INT,\r\n       HOUSENAME    = :CA-H-HOUSE-NAME,\r\n       HOUSENUMBER  = :CA-H-HOUSE-NUMBER,\r\n       POSTCODE     = :CA-H-POSTCODE\r\n       WHERE\r\n       POLICYNUMBER = :DB2-POLICYNUM-INT\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n      *>       Non-zero SQLCODE from UPDATE statement\r\n             IF SQLCODE = 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 424, "summary": "The below code segment is a \"PARAGRAPH\" named \"UPDATE-HOUSE-DB2-INFO\" which is in the file \"lgupdb01.cbl\" at line number \"424\"\nBusiness Intent: Update house details in a database using SQL\nTechnical Action: Executes an UPDATE statement on a DB2 database to update house property information based on policy number\nKeywords: COBOL, DB2, SQL, UPDATE, House Property Information, Policy Number, Error Handling"}, {"fileName": "lgupdb01.cbl", "type": "PARAGRAPH", "name": "UPDATE-MOTOR-DB2-INFO", "content": "MOVE CA-M-CC          TO DB2-M-CC-SINT\nMOVE CA-M-VALUE       TO DB2-M-VALUE-INT\nMOVE CA-M-PREMIUM     TO DB2-M-PREMIUM-INT\nMOVE CA-M-ACCIDENTS   TO DB2-M-ACCIDENTS-INT\nMOVE ' UPDATE MOTOR ' TO EM-SQLREQ\nEXEC SQL\r\n       UPDATE MOTOR\r\n       SET\r\n       MAKE              = :CA-M-MAKE,\r\n       MODEL             = :CA-M-MODEL,\r\n       VALUE             = :DB2-M-VALUE-INT,\r\n       REGNUMBER         = :CA-M-REGNUMBER,\r\n       COLOUR            = :CA-M-COLOUR,\r\n       CC                = :DB2-M-CC-SINT,\r\n       YEAROFMANUFACTURE = :CA-M-MANUFACTURED,\r\n       PREMIUM           = :DB2-M-PREMIUM-INT,\r\n       ACCIDENTS         = :DB2-M-ACCIDENTS-INT\r\n       WHERE\r\n       POLICYNUMBER      = :DB2-POLICYNUM-INT\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n      *>       Non-zero SQLCODE from UPDATE statement\r\n             IF SQLCODE EQUAL 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 460, "summary": "The below code segment is a \"PARAGRAPH\" named \"UPDATE-MOTOR-DB2-INFO\" which is in the file \"lgupdb01.cbl\" at line number \"460\"\nBusiness Intent: Update motor insurance policy information in a database\nTechnical Action: Executes an SQL UPDATE statement using CICS and DB2\nKeywords: COBOL, CICS, DB2, SQL, UPDATE, MOTOR INSURANCE, POLICY INFORMATION, ERROR HANDLING"}, {"fileName": "lgupdb01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "MOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 502, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgupdb01.cbl\" at line number \"502\"\nBusiness Intent: Retrieving and formatting timestamp information for subsequent processing, with error handling capabilities.\nTechnical Action: Executes CICS ASKTIME and FORMATTIME commands to retrieve and format the timestamp, and then performs a LINK operation to a program ('LGSTSQ') with commarea and length parameters. Additionally, it handles errors and truncates data if necessary.\nKeywords: CICS, COBOL, Timestamp, Formatting, Error Handling, LINK, CommArea"}, {"fileName": "lgucus01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgucus01.cbl\"\nStructure: LINKAGE SECTION\nDescription: Linkage section for various business entities, including customer, policy, and claim.\nFields: DFHCOMMAREA, CA-REQUEST-ID, CUSTOMER-NUM, POLICY-DATA"}, {"fileName": "lgucus01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgucus01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGUCUS01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGUCUS01'.\n   03 EM-VARIABLE              PIC X(21) VALUE SPACES.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN         PIC S9(4) COMP VALUE +28.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4) COMP VALUE +0.\n\n 01 WS-VARY-FIELD.\n   49 WS-VARY-LEN               PIC S9(4) COMP.\n   49 WS-VARY-CHAR              PIC X(3900).\n\n 01 LGUCDB01                     PIC X(8) VALUE 'LGUCDB01'.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgucus01.cbl\" in the file \"lgucus01.cbl\"\nStructure: DATA LAYOUT FOR lgucus01.cbl\nDescription: \nFields: WS-EYECATCHER, WS-TRANSID, WS-TASKNUM, DFHCOMMAREA, CA-CUSTOMER-NUM, CA-POLICY-NUM, CA-ISSUE-DATE, CA-EXPIRY-DATE, CA-LASTCHANGED, CA-BROKERID, CA-EMAIL-ADDRESS, CA-DATE, CA-TIME, ERROR-MSG, EM-DATE, EM-TIME, EM-VARIABLE, CA-CUSTSECR-PASS, CA-CUSTSECR-COUNT, CA-CUSTSECR-STATE, CA-CUSTSECR-DATA, CA-ENDOWMENT, CA-HOUSE, CA-MOTOR, CA-COMMERCIAL, CA-CLAIM, WS-CALEN, WS-VARY-LEN, WS-VARY-CHAR, business_entity, %lgucus01.cbl"}, {"fileName": "lgucus01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXEC CICS RETURN END-EXEC\n\nEXIT\n\nEXEC CICS LINK Program(LGUCDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 186, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgucus01.cbl\" at line number \"186\"\nBusiness Intent: Handle requests from a user interface, perform date and time formatting, and link to other programs for data retrieval or error handling.\nTechnical Action: Use CICS commands (RETURN, LINK) to interact with mainframe systems. Perform date and time formatting using ASKTIME and FORMATTIME commands. Handle errors through EIBCALEN checks and execute alternative program links.\nKeywords: CICS, MAINFRAME, DATE FORMATTING, TIME FORMATTING, ERROR HANDLING, LINK PROGRAMS"}, {"fileName": "lgucus01.cbl", "type": "PARAGRAPH", "name": "END-PROGRAM", "content": "EXEC CICS RETURN END-EXEC\n", "lineNumber": 222, "summary": "The below code segment is a \"PARAGRAPH\" named \"END-PROGRAM\" which is in the file \"lgucus01.cbl\" at line number \"222\"\nBusiness Intent: Terminates the current transaction and returns control to the requesting program\nTechnical Action: Executes a CICS Return command to end the current transaction\nKeywords: CICS, Return, Transaction termination"}, {"fileName": "lgucus01.cbl", "type": "PARAGRAPH", "name": "UPDATE-CUSTOMER-INFO", "content": "EXEC CICS LINK Program(LGUCDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n", "lineNumber": 229, "summary": "The below code segment is a \"PARAGRAPH\" named \"UPDATE-CUSTOMER-INFO\" which is in the file \"lgucus01.cbl\" at line number \"229\"\nBusiness Intent: Perform a link request to the LGUCDB01 program using the CICS transaction, utilizing a 32.5K commarea.\nTechnical Action: Link request execution in CICS environment\nKeywords: CICS, LINK, COBOL, Mainframe, Program Linkage, Commarea"}, {"fileName": "lgucus01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 243, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgucus01.cbl\" at line number \"243\"\nBusiness Intent: Retrieve and format the current date and time, then link to an external program 'LGSTSQ' with error handling.\nTechnical Action: Uses CICS commands ASKTIME and FORMATTIME to retrieve the current date and time. Moves the values to working storage and then links to the external program using CICS LINK command, handling errors through EIBCALEN check.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK, error handling"}, {"fileName": "lgstsq.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n         \n02COMMA-DATAPICX(90).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgstsq.cbl\"\nStructure: LINKAGE_SECTION\nDescription: COBOL Linkage Section\nFields: comapicx"}, {"fileName": "lgstsq.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgstsq.cbl", "content": " 01  WS-FLAG                   PIC X.\n\n 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-INVOKEPROG             PIC X(8) Value spaces.\n\n 01  WS-RECV.\n   03 WS-RECV-TRANID           PIC X(5).\n   03 WS-RECV-DATA             PIC X(74).\n\n 01  WS-RECV-LEN               PIC S9(4) COMP Value 80.\n\n 01  WRITE-MSG.\n   03 WRITE-MSG-SYSID          PIC X(4).\n   03 FILLER-X                 PIC X Value SPACES.\n   03 WRITE-MSG-MSG            PIC X(90).\n\n 01  FILLER REDEFINES WRITE-MSG.\n   03 FILLER                   PIC X(5).\n   03 FILLER                   PIC X(7).\n   03 WRITE-MSG-REST           PIC X(83).\n\n 01  STSQ.\n   03  STSQ-NAME                 PIC X(8).\n\n 01  FILLER REDEFINES STSQ.\n   03 FILLER                   PIC X(4).\n   03 STSQ-EXT                 PIC X(4).\n\n 01 TEMPO                      PIC X(90) VALUE SPACES.\n\n 01  DFHCOMMAREA.\n   02  COMMA-DATA              PIC X(90).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgstsq.cbl\" in the file \"lgstsq.cbl\"\nStructure: DATA LAYOUT FOR lgstsq.cbl\nDescription: A legacy COBOL data structure used in a system that processes financial transactions.\nFields: WS-FLAG, WS-RESP, WS-INVOKEPROG, WS-RECV-TRANID, STSQ-NAME"}, {"fileName": "lgstsq.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\n", "lineNumber": 55, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgstsq.cbl\" at line number \"55\"\nBusiness Intent: Terminates a transaction and returns control to the calling program.\nTechnical Action: Executes an EXIT command, followed by a GOBACK instruction, to exit the current program and return to the previous level of execution.\nKeywords: EXIT, GOBACK, COBOL, transaction termination, program termination"}, {"fileName": "lgstsq.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 124, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgstsq.cbl\" at line number \"124\"\nBusiness Intent: Terminate and return control to the calling program, effectively exiting the current transaction.\nTechnical Action: Execute an exit command followed by a GOBACK statement\nKeywords: COBOL, EXIT, GOBACK, Transaction Termination"}, {"fileName": "lgacus01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgacus01.cbl\"\nStructure: LINKAGE_SECTION\nDescription: \nFields: CA-REQUEST-ID, CA-CUSTOMER-NUM, CA-RETURN-CODE, CA-POLICY-DATA"}, {"fileName": "lgacus01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgacus01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGACUS01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGACUS01'.\n   03 EM-VARIABLE              PIC X(21) VALUE SPACES.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN         PIC S9(4) COMP VALUE +18.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4)      VALUE +0.\n\n 01  WS-POLICY-LENGTHS.\n   03 WS-CUSTOMER-LEN          PIC S9(4) COMP VALUE +72.\n   03 WS-POLICY-LEN            PIC S9(4) COMP VALUE +72.\n   03 WS-ENDOW-LEN             PIC S9(4) COMP VALUE +52.\n   03 WS-HOUSE-LEN             PIC S9(4) COMP VALUE +58.\n   03 WS-MOTOR-LEN             PIC S9(4) COMP VALUE +65.\n   03 WS-COMM-LEN              PIC S9(4) COMP VALUE +1102.\n   03 WS-CLAIM-LEN             PIC S9(4) COMP VALUE +546.\n   03 WS-FULL-ENDOW-LEN        PIC S9(4) COMP VALUE +124.\n   03 WS-FULL-HOUSE-LEN        PIC S9(4) COMP VALUE +130.\n   03 WS-FULL-MOTOR-LEN        PIC S9(4) COMP VALUE +137.\n   03 WS-FULL-COMM-LEN         PIC S9(4) COMP VALUE +1174.\n   03 WS-FULL-CLAIM-LEN        PIC S9(4) COMP VALUE +618.\n   03 WS-SUMRY-ENDOW-LEN       PIC S9(4) COMP VALUE +25.\n\n 01  DB2-CUSTOMER.\n   03 DB2-FIRSTNAME            PIC X(10).\n   03 DB2-LASTNAME             PIC X(20).\n   03 DB2-DATEOFBIRTH          PIC X(10).\n   03 DB2-HOUSENAME            PIC X(20).\n   03 DB2-HOUSENUMBER          PIC X(4).\n   03 DB2-POSTCODE             PIC X(8).\n   03 DB2-PHONE-MOBILE         PIC X(20).\n   03 DB2-PHONE-HOME           PIC X(20).\n   03 DB2-EMAIL-ADDRESS        PIC X(100).\n\n 01  DB2-POLICY.\n   03 DB2-POLICYTYPE           PIC X.\n   03 DB2-POLICYNUMBER         PIC 9(10).\n   03 DB2-POLICY-COMMON.\n     05 DB2-ISSUEDATE         PIC X(10).\n     05 DB2-EXPIRYDATE        PIC X(10).\n     05 DB2-LASTCHANGED       PIC X(26).\n     05 DB2-BROKERID          PIC 9(10).\n     05 DB2-BROKERSREF        PIC X(10).\n     05 DB2-PAYMENT           PIC 9(6).\n\n 01  DB2-ENDOWMENT.\n   03 DB2-ENDOW-FIXED.\n     05 DB2-E-WITHPROFITS      PIC X.\n     05 DB2-E-EQUITIES         PIC X.\n     05 DB2-E-MANAGEDFUND      PIC X.\n     05 DB2-E-FUNDNAME         PIC X(10).\n     05 DB2-E-TERM             PIC 9(2).\n     05 DB2-E-SUMASSURED       PIC 9(6).\n     05 DB2-E-LIFEASSURED      PIC X(31).\n   03 DB2-E-PADDINGDATA         PIC X(32611).\n\n 01  DB2-HOUSE.\n   03 DB2-H-PROPERTYTYPE       PIC X(15).\n   03 DB2-H-BEDROOMS           PIC 9(3).\n   03 DB2-H-VALUE              PIC 9(8).\n   03 DB2-H-HOUSENAME          PIC X(20).\n   03 DB2-H-HOUSENUMBER        PIC X(4).\n   03 DB2-H-POSTCODE           PIC X(8).\n\n 01  DB2-MOTOR.\n   03 DB2-M-MAKE               PIC X(15).\n   03 DB2-M-MODEL              PIC X(15).\n   03 DB2-M-VALUE              PIC 9(6).\n   03 DB2-M-REGNUMBER          PIC X(7).\n   03 DB2-M-COLOUR             PIC X(8).\n   03 DB2-M-CC                 PIC 9(4).\n   03 DB2-M-MANUFACTURED       PIC X(10).\n   03 DB2-M-PREMIUM            PIC 9(6).\n   03 DB2-M-ACCIDENTS          PIC 9(6).\n\n 01  DB2-COMMERCIAL.\n   03 DB2-B-Address            PIC X(255).\n   03 DB2-B-Postcode           PIC X(8).\n   03 DB2-B-Latitude           PIC X(11).\n   03 DB2-B-Longitude          PIC X(11).\n   03 DB2-B-Customer           PIC X(255).\n   03 DB2-B-PropType           PIC X(255).\n   03 DB2-B-FirePeril          PIC 9(4).\n   03 DB2-B-FirePremium        PIC 9(8).\n   03 DB2-B-CrimePeril         PIC 9(4).\n   03 DB2-B-CrimePremium       PIC 9(8).\n   03 DB2-B-FloodPeril         PIC 9(4).\n   03 DB2-B-FloodPremium       PIC 9(8).\n   03 DB2-B-WeatherPeril       PIC 9(4).\n   03 DB2-B-WeatherPremium     PIC 9(8).\n   03 DB2-B-Status             PIC 9(4).\n   03 DB2-B-RejectReason       PIC X(255).\n\n 01  DB2-CLAIM.\n   03 DB2-C-Num                PIC 9(10).\n   03 DB2-C-Date               PIC X(10).\n   03 DB2-C-Paid               PIC 9(8).\n   03 DB2-C-Value              PIC 9(8).\n   03 DB2-C-Cause              PIC X(255).\n   03 DB2-C-Observations       PIC X(255).\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgacus01.cbl\" in the file \"lgacus01.cbl\"\nStructure: WS-HEADER\nDescription: Header structure for lgacus01.cbl\nFields: WS-EYECATCHER, WS-TRANSID, WS-TERMID, WS-TASKNUM"}, {"fileName": "lgacus01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\nEXEC CICS LINK Program(LGACDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 288, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgacus01.cbl\" at line number \"288\"\nBusiness Intent: Handles database interactions and date/time formatting for LGACDB01 program, linking to LGSTSQ program with error handling mechanisms.\nTechnical Action: Executes CICS commands (LINK, ASKTIME, FORMATTIME) for database communication and time-related operations.\nKeywords: CICS, COBOL, database interaction, date/time formatting, error handling, linking to LGSTSQ program"}, {"fileName": "lgacus01.cbl", "type": "PARAGRAPH", "name": "INSERT-CUSTOMER", "content": "EXEC CICS LINK Program(LGACDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n", "lineNumber": 342, "summary": "The below code segment is a \"PARAGRAPH\" named \"INSERT-CUSTOMER\" which is in the file \"lgacus01.cbl\" at line number \"342\"\nBusiness Intent: Invoke a program to access database records\nTechnical Action: Link to the LGACDB01 program using CICS EXEC command\nKeywords: CICS, LINK, COBOL, Mainframe, Database, Program Invoke"}, {"fileName": "lgacus01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 357, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgacus01.cbl\" at line number \"357\"\nBusiness Intent: Retrieve and format the current date and time, then link to another program to process the data\nTechnical Action: Use CICS commands (ASKTIME, FORMATTIME, LINK) and conditional statements to handle communication area errors\nKeywords: CICS, COBOL, date and time, error handling, communication area, link program"}, {"fileName": "lgicdb01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n EXEC SQL\r INCLUDE LGCMAREA\r END-EXEC.", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgicdb01.cbl\"\nStructure: LINKAGE SECTION\nDescription: Analyzing legacy COBOL system linkage section\nFields: None"}, {"fileName": "lgicdb01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgicdb01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGICDB01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGICUS01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 EM-SQLREQ              PIC X(16) VALUE SPACES.\n     05 FILLER                 PIC X(9)  VALUE ' SQLCODE='.\n     05 EM-SQLRC               PIC +9(5) USAGE DISPLAY.\n\n 01 CA-ERROR-MSG.\n   03 FILLER                PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA               PIC X(90) VALUE SPACES.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADERTRAILER-LEN  PIC S9(4) COMP VALUE +18.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4)      VALUE +0.\n\n 01  DB2-IN-INTEGERS.\n   03 DB2-CUSTOMERNUMBER-INT   PIC S9(9) COMP.\n\n 01  WS-POLICY-LENGTHS.\n   03 WS-CUSTOMER-LEN          PIC S9(4) COMP VALUE +72.\n   03 WS-POLICY-LEN            PIC S9(4) COMP VALUE +72.\n   03 WS-ENDOW-LEN             PIC S9(4) COMP VALUE +52.\n   03 WS-HOUSE-LEN             PIC S9(4) COMP VALUE +58.\n   03 WS-MOTOR-LEN             PIC S9(4) COMP VALUE +65.\n   03 WS-COMM-LEN              PIC S9(4) COMP VALUE +1102.\n   03 WS-CLAIM-LEN             PIC S9(4) COMP VALUE +546.\n   03 WS-FULL-ENDOW-LEN        PIC S9(4) COMP VALUE +124.\n   03 WS-FULL-HOUSE-LEN        PIC S9(4) COMP VALUE +130.\n   03 WS-FULL-MOTOR-LEN        PIC S9(4) COMP VALUE +137.\n   03 WS-FULL-COMM-LEN         PIC S9(4) COMP VALUE +1174.\n   03 WS-FULL-CLAIM-LEN        PIC S9(4) COMP VALUE +618.\n   03 WS-SUMRY-ENDOW-LEN       PIC S9(4) COMP VALUE +25.\n\n 01  DB2-CUSTOMER.\n   03 DB2-FIRSTNAME            PIC X(10).\n   03 DB2-LASTNAME             PIC X(20).\n   03 DB2-DATEOFBIRTH          PIC X(10).\n   03 DB2-HOUSENAME            PIC X(20).\n   03 DB2-HOUSENUMBER          PIC X(4).\n   03 DB2-POSTCODE             PIC X(8).\n   03 DB2-PHONE-MOBILE         PIC X(20).\n   03 DB2-PHONE-HOME           PIC X(20).\n   03 DB2-EMAIL-ADDRESS        PIC X(100).\n\n 01  DB2-POLICY.\n   03 DB2-POLICYTYPE           PIC X.\n   03 DB2-POLICYNUMBER         PIC 9(10).\n   03 DB2-POLICY-COMMON.\n     05 DB2-ISSUEDATE         PIC X(10).\n     05 DB2-EXPIRYDATE        PIC X(10).\n     05 DB2-LASTCHANGED       PIC X(26).\n     05 DB2-BROKERID          PIC 9(10).\n     05 DB2-BROKERSREF        PIC X(10).\n     05 DB2-PAYMENT           PIC 9(6).\n\n 01  DB2-ENDOWMENT.\n   03 DB2-ENDOW-FIXED.\n     05 DB2-E-WITHPROFITS      PIC X.\n     05 DB2-E-EQUITIES         PIC X.\n     05 DB2-E-MANAGEDFUND      PIC X.\n     05 DB2-E-FUNDNAME         PIC X(10).\n     05 DB2-E-TERM             PIC 9(2).\n     05 DB2-E-SUMASSURED       PIC 9(6).\n     05 DB2-E-LIFEASSURED      PIC X(31).\n   03 DB2-E-PADDINGDATA         PIC X(32611).\n\n 01  DB2-HOUSE.\n   03 DB2-H-PROPERTYTYPE       PIC X(15).\n   03 DB2-H-BEDROOMS           PIC 9(3).\n   03 DB2-H-VALUE              PIC 9(8).\n   03 DB2-H-HOUSENAME          PIC X(20).\n   03 DB2-H-HOUSENUMBER        PIC X(4).\n   03 DB2-H-POSTCODE           PIC X(8).\n\n 01  DB2-MOTOR.\n   03 DB2-M-MAKE               PIC X(15).\n   03 DB2-M-MODEL              PIC X(15).\n   03 DB2-M-VALUE              PIC 9(6).\n   03 DB2-M-REGNUMBER          PIC X(7).\n   03 DB2-M-COLOUR             PIC X(8).\n   03 DB2-M-CC                 PIC 9(4).\n   03 DB2-M-MANUFACTURED       PIC X(10).\n   03 DB2-M-PREMIUM            PIC 9(6).\n   03 DB2-M-ACCIDENTS          PIC 9(6).\n\n 01  DB2-COMMERCIAL.\n   03 DB2-B-Address            PIC X(255).\n   03 DB2-B-Postcode           PIC X(8).\n   03 DB2-B-Latitude           PIC X(11).\n   03 DB2-B-Longitude          PIC X(11).\n   03 DB2-B-Customer           PIC X(255).\n   03 DB2-B-PropType           PIC X(255).\n   03 DB2-B-FirePeril          PIC 9(4).\n   03 DB2-B-FirePremium        PIC 9(8).\n   03 DB2-B-CrimePeril         PIC 9(4).\n   03 DB2-B-CrimePremium       PIC 9(8).\n   03 DB2-B-FloodPeril         PIC 9(4).\n   03 DB2-B-FloodPremium       PIC 9(8).\n   03 DB2-B-WeatherPeril       PIC 9(4).\n   03 DB2-B-WeatherPremium     PIC 9(8).\n   03 DB2-B-Status             PIC 9(4).\n   03 DB2-B-RejectReason       PIC X(255).\n\n 01  DB2-CLAIM.\n   03 DB2-C-Num                PIC 9(10).\n   03 DB2-C-Date               PIC X(10).\n   03 DB2-C-Paid               PIC 9(8).\n   03 DB2-C-Value              PIC 9(8).\n   03 DB2-C-Cause              PIC X(255).\n   03 DB2-C-Observations       PIC X(255).\n\n 01  DFHCOMMAREA.\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgicdb01.cbl\" in the file \"lgicdb01.cbl\"\nStructure: WS-HEADER\nDescription: Header structure for lgicdb01.cbl program. It contains various fields such as Eye Catcher, Transaction ID, Terminal ID, Task Number, and Fillers.\nFields: EYECATCHER, TRANSID, TERMID, TASKNUM"}, {"fileName": "lgicdb01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXEC CICS RETURN END-EXEC\n\nEXIT\n\nEXEC SQL\r\n       SELECT FIRSTNAME,\r\n       LASTNAME,\r\n       DATEOFBIRTH,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE,\r\n       PHONEMOBILE,\r\n       PHONEHOME,\r\n       EMAILADDRESS\r\n       INTO  :CA-FIRST-NAME,\r\n       :CA-LAST-NAME,\r\n       :CA-DOB,\r\n       :CA-HOUSE-NAME,\r\n       :CA-HOUSE-NUM,\r\n       :CA-POSTCODE,\r\n       :CA-PHONE-MOBILE,\r\n       :CA-PHONE-HOME,\r\n       :CA-EMAIL-ADDRESS\r\n       FROM CUSTOMER\r\n       WHERE CUSTOMERNUMBER = :DB2-CUSTOMERNUMBER-INT\r\n       END-EXEC\nEvaluate SQLCODE\r\n             When 0\r\n               MOVE '00' TO CA-RETURN-CODE\r\n             When 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             When -913\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             When Other\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-Evaluate\nEXIT\n\nMOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 209, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgicdb01.cbl\" at line number \"209\"\nBusiness Intent: Retrieve customer information by customernumber and handle errors\nTechnical Action: Execute a SQL query, evaluate the result, and perform error handling using CICS commands\nKeywords: COBOL, CICS, SQL, customer information, error handling"}, {"fileName": "lgicdb01.cbl", "type": "PARAGRAPH", "name": "MAINLINE-END", "content": "EXEC CICS RETURN END-EXEC\n", "lineNumber": 266, "summary": "The below code segment is a \"PARAGRAPH\" named \"MAINLINE-END\" which is in the file \"lgicdb01.cbl\" at line number \"266\"\nBusiness Intent: End the current transaction and return control to the requesting program.\nTechnical Action: Executes a CICS Return command, terminating the current transaction and releasing any held resources.\nKeywords: CICS, Return, Transaction, Error Handling"}, {"fileName": "lgicdb01.cbl", "type": "PARAGRAPH", "name": "GET-CUSTOMER-INFO", "content": "EXEC SQL\r\n       SELECT FIRSTNAME,\r\n       LASTNAME,\r\n       DATEOFBIRTH,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE,\r\n       PHONEMOBILE,\r\n       PHONEHOME,\r\n       EMAILADDRESS\r\n       INTO  :CA-FIRST-NAME,\r\n       :CA-LAST-NAME,\r\n       :CA-DOB,\r\n       :CA-HOUSE-NAME,\r\n       :CA-HOUSE-NUM,\r\n       :CA-POSTCODE,\r\n       :CA-PHONE-MOBILE,\r\n       :CA-PHONE-HOME,\r\n       :CA-EMAIL-ADDRESS\r\n       FROM CUSTOMER\r\n       WHERE CUSTOMERNUMBER = :DB2-CUSTOMERNUMBER-INT\r\n       END-EXEC\nEvaluate SQLCODE\r\n             When 0\r\n               MOVE '00' TO CA-RETURN-CODE\r\n             When 100\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             When -913\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             When Other\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-Evaluate\nEXIT\n", "lineNumber": 274, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-CUSTOMER-INFO\" which is in the file \"lgicdb01.cbl\" at line number \"274\"\nBusiness Intent: Retrieve customer information based on a specified customer number and handle any potential errors that may occur during the process.\nTechnical Action: Executes an SQL query to select specific columns from a CUSTOMER table, using a WHERE clause to filter results by CUSTOMERNUMBER. If an error occurs, the code evaluates the SQLCODE and performs error handling accordingly.\nKeywords: CICS, SQL, SELECT, CUSTOMER, CUSTOMERNUMBER, Error Handling"}, {"fileName": "lgicdb01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "MOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 319, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgicdb01.cbl\" at line number \"319\"\nBusiness Intent: Retrieve and format current time, then link to a program ('LGSTSQ') with error handling.\nTechnical Action: Executes CICS ASKTIME and FORMATTIME commands, retrieves SQL code, and processes COMMAREA with error handling.\nKeywords: CICS, ASKTIME, FORMATTIME, SQLCODE, LINK, COMMAREA, Error Handling, Mainframe"}, {"fileName": "lgacdb01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n EXEC SQL\r INCLUDE LGCMAREA\r END-EXEC.", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgacdb01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: LGCMAREA, COBOLCODE"}, {"fileName": "lgacdb01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgacdb01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGACDB01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  LastCustNum               PIC S9(8) COMP.\n\n 01  GENAcount                 PIC X(16) Value 'GENACUSTNUM'.\n\n 01  GENApool                  PIC X(8)  Value 'GENA'.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGACDB01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 EM-SQLREQ              PIC X(16) VALUE SPACES.\n     05 FILLER                 PIC X(9)  VALUE ' SQLCODE='.\n     05 EM-SQLRC               PIC +9(5) USAGE DISPLAY.\n\n 01  CDB2AREA.\n   03 D2-REQUEST-ID            PIC X(6).\n   03 D2-RETURN-CODE           PIC 9(2).\n   03 D2-CUSTOMER-NUM          PIC 9(10).\n   03 D2-CUSTSECR-PASS         PIC X(32).\n   03 D2-CUSTSECR-COUNT        PIC X(4).\n   03 D2-CUSTSECR-STATE        PIC X.\n   03 D2-CUSTSECR-DATA         PIC X(32445).\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN         PIC S9(4) COMP VALUE +18.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4)      VALUE +0.\n\n 01  WS-POLICY-LENGTHS.\n   03 WS-CUSTOMER-LEN          PIC S9(4) COMP VALUE +72.\n   03 WS-POLICY-LEN            PIC S9(4) COMP VALUE +72.\n   03 WS-ENDOW-LEN             PIC S9(4) COMP VALUE +52.\n   03 WS-HOUSE-LEN             PIC S9(4) COMP VALUE +58.\n   03 WS-MOTOR-LEN             PIC S9(4) COMP VALUE +65.\n   03 WS-COMM-LEN              PIC S9(4) COMP VALUE +1102.\n   03 WS-CLAIM-LEN             PIC S9(4) COMP VALUE +546.\n   03 WS-FULL-ENDOW-LEN        PIC S9(4) COMP VALUE +124.\n   03 WS-FULL-HOUSE-LEN        PIC S9(4) COMP VALUE +130.\n   03 WS-FULL-MOTOR-LEN        PIC S9(4) COMP VALUE +137.\n   03 WS-FULL-COMM-LEN         PIC S9(4) COMP VALUE +1174.\n   03 WS-FULL-CLAIM-LEN        PIC S9(4) COMP VALUE +618.\n   03 WS-SUMRY-ENDOW-LEN       PIC S9(4) COMP VALUE +25.\n\n 01  DB2-CUSTOMER.\n   03 DB2-FIRSTNAME            PIC X(10).\n   03 DB2-LASTNAME             PIC X(20).\n   03 DB2-DATEOFBIRTH          PIC X(10).\n   03 DB2-HOUSENAME            PIC X(20).\n   03 DB2-HOUSENUMBER          PIC X(4).\n   03 DB2-POSTCODE             PIC X(8).\n   03 DB2-PHONE-MOBILE         PIC X(20).\n   03 DB2-PHONE-HOME           PIC X(20).\n   03 DB2-EMAIL-ADDRESS        PIC X(100).\n\n 01  DB2-POLICY.\n   03 DB2-POLICYTYPE           PIC X.\n   03 DB2-POLICYNUMBER         PIC 9(10).\n   03 DB2-POLICY-COMMON.\n     05 DB2-ISSUEDATE         PIC X(10).\n     05 DB2-EXPIRYDATE        PIC X(10).\n     05 DB2-LASTCHANGED       PIC X(26).\n     05 DB2-BROKERID          PIC 9(10).\n     05 DB2-BROKERSREF        PIC X(10).\n     05 DB2-PAYMENT           PIC 9(6).\n\n 01  DB2-ENDOWMENT.\n   03 DB2-ENDOW-FIXED.\n     05 DB2-E-WITHPROFITS      PIC X.\n     05 DB2-E-EQUITIES         PIC X.\n     05 DB2-E-MANAGEDFUND      PIC X.\n     05 DB2-E-FUNDNAME         PIC X(10).\n     05 DB2-E-TERM             PIC 9(2).\n     05 DB2-E-SUMASSURED       PIC 9(6).\n     05 DB2-E-LIFEASSURED      PIC X(31).\n   03 DB2-E-PADDINGDATA         PIC X(32611).\n\n 01  DB2-HOUSE.\n   03 DB2-H-PROPERTYTYPE       PIC X(15).\n   03 DB2-H-BEDROOMS           PIC 9(3).\n   03 DB2-H-VALUE              PIC 9(8).\n   03 DB2-H-HOUSENAME          PIC X(20).\n   03 DB2-H-HOUSENUMBER        PIC X(4).\n   03 DB2-H-POSTCODE           PIC X(8).\n\n 01  DB2-MOTOR.\n   03 DB2-M-MAKE               PIC X(15).\n   03 DB2-M-MODEL              PIC X(15).\n   03 DB2-M-VALUE              PIC 9(6).\n   03 DB2-M-REGNUMBER          PIC X(7).\n   03 DB2-M-COLOUR             PIC X(8).\n   03 DB2-M-CC                 PIC 9(4).\n   03 DB2-M-MANUFACTURED       PIC X(10).\n   03 DB2-M-PREMIUM            PIC 9(6).\n   03 DB2-M-ACCIDENTS          PIC 9(6).\n\n 01  DB2-COMMERCIAL.\n   03 DB2-B-Address            PIC X(255).\n   03 DB2-B-Postcode           PIC X(8).\n   03 DB2-B-Latitude           PIC X(11).\n   03 DB2-B-Longitude          PIC X(11).\n   03 DB2-B-Customer           PIC X(255).\n   03 DB2-B-PropType           PIC X(255).\n   03 DB2-B-FirePeril          PIC 9(4).\n   03 DB2-B-FirePremium        PIC 9(8).\n   03 DB2-B-CrimePeril         PIC 9(4).\n   03 DB2-B-CrimePremium       PIC 9(8).\n   03 DB2-B-FloodPeril         PIC 9(4).\n   03 DB2-B-FloodPremium       PIC 9(8).\n   03 DB2-B-WeatherPeril       PIC 9(4).\n   03 DB2-B-WeatherPremium     PIC 9(8).\n   03 DB2-B-Status             PIC 9(4).\n   03 DB2-B-RejectReason       PIC X(255).\n\n 01  DB2-CLAIM.\n   03 DB2-C-Num                PIC 9(10).\n   03 DB2-C-Date               PIC X(10).\n   03 DB2-C-Paid               PIC 9(8).\n   03 DB2-C-Value              PIC 9(8).\n   03 DB2-C-Cause              PIC X(255).\n   03 DB2-C-Observations       PIC X(255).\n\n 01  DB2-OUT-INTEGERS.\n   03 DB2-CUSTOMERNUM-INT   PIC S9(9) COMP.\n\n 01  DFHCOMMAREA.\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgacdb01.cbl\" in the file \"lgacdb01.cbl\"\nStructure: DATA LAYOUT FOR lgacdb01.cbl\nDescription: \nFields: WS-EYECATCHER, WS-TRANSID, WS-TERMID, WS-TASKNUM, WS-FILLER, WS-CALEN, WS-RESP, LastCustNum, GENAaccount, GENApool, WS-ABSTIME, WS-TIME, WS-DATE, ERROR-MSG, CDB2AREA, CA-ERROR-MSG, WS-COMMAREA-LENGTHS, WS-POLICY-LENGTHS, DB2-CUSTOMER, DB2-POLICY, DB2-ENDOWMENT, DB2-HOUSE, DB2-MOTOR, DB2-COMMERCIAL, DB2-CLAIM, DB2-OUT-INTEGERS"}, {"fileName": "lgacdb01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\nExec CICS Get Counter(GENAcount)\r\n       Pool(GENApool)\r\n       Value(LastCustNum)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nIf WS-RESP Not = DFHRESP(NORMAL)\r\n             MOVE 'NO' TO LGAC-NCS\r\n             Initialize DB2-CUSTOMERNUM-INT\r\n           ELSE\r\n             Move LastCustNum  To DB2-CUSTOMERNUM-INT\r\n           End-If\n\nMOVE ' INSERT CUSTOMER' TO EM-SQLREQ\nIF LGAC-NCS = 'ON'\r\n       EXEC SQL\r\n       INSERT INTO CUSTOMER\r\n       ( CUSTOMERNUMBER,\r\n       FIRSTNAME,\r\n       LASTNAME,\r\n       DATEOFBIRTH,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE,\r\n       PHONEMOBILE,\r\n       PHONEHOME,\r\n       EMAILADDRESS )\r\n       VALUES ( :DB2-CUSTOMERNUM-INT,\r\n       :CA-FIRST-NAME,\r\n       :CA-LAST-NAME,\r\n       :CA-DOB,\r\n       :CA-HOUSE-NAME,\r\n       :CA-HOUSE-NUM,\r\n       :CA-POSTCODE,\r\n       :CA-PHONE-MOBILE,\r\n       :CA-PHONE-HOME,\r\n       :CA-EMAIL-ADDRESS )\r\n       END-EXEC\r\n             IF SQLCODE NOT EQUAL 0\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n             END-IF\r\n           ELSE\r\n       EXEC SQL\r\n       INSERT INTO CUSTOMER\r\n       ( CUSTOMERNUMBER,\r\n       FIRSTNAME,\r\n       LASTNAME,\r\n       DATEOFBIRTH,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE,\r\n       PHONEMOBILE,\r\n       PHONEHOME,\r\n       EMAILADDRESS )\r\n       VALUES ( DEFAULT,\r\n       :CA-FIRST-NAME,\r\n       :CA-LAST-NAME,\r\n       :CA-DOB,\r\n       :CA-HOUSE-NAME,\r\n       :CA-HOUSE-NUM,\r\n       :CA-POSTCODE,\r\n       :CA-PHONE-MOBILE,\r\n       :CA-PHONE-HOME,\r\n       :CA-EMAIL-ADDRESS )\r\n       END-EXEC\r\n             IF SQLCODE NOT EQUAL 0\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n             END-IF\r\n      *>     get value of assigned customer number\r\n       EXEC SQL\r\n       SET :DB2-CUSTOMERNUM-INT = IDENTITY_VAL_LOCAL()\r\n       END-EXEC\r\n           END-IF\nMOVE DB2-CUSTOMERNUM-INT TO CA-CUSTOMER-NUM\nEXIT\n\nMOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 235, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgacdb01.cbl\" at line number \"235\"\nBusiness Intent: Insert a new customer into the CUSTOMER table and retrieve the assigned customer number\nTechnical Action: CICS-based application using COBOL code, interacting with DB2 database and performing SQL INSERT operations\nKeywords: COBOL, CICS, DB2, SQL, INSERT, CUSTOMER, customer number, error handling"}, {"fileName": "lgacdb01.cbl", "type": "PARAGRAPH", "name": "Obtain-CUSTOMER-Number", "content": "Exec CICS Get Counter(GENAcount)\r\n       Pool(GENApool)\r\n       Value(LastCustNum)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nIf WS-RESP Not = DFHRESP(NORMAL)\r\n             MOVE 'NO' TO LGAC-NCS\r\n             Initialize DB2-CUSTOMERNUM-INT\r\n           ELSE\r\n             Move LastCustNum  To DB2-CUSTOMERNUM-INT\r\n           End-If\n", "lineNumber": 306, "summary": "The below code segment is a \"PARAGRAPH\" named \"Obtain-CUSTOMER-Number\" which is in the file \"lgacdb01.cbl\" at line number \"306\"\nBusiness Intent: Retrieve a customer number and update an internal database if the retrieval is successful.\nTechnical Action: Executes a CICS Get Counter command to retrieve a customer number, handles any errors that may occur, and updates a DB2 table with the retrieved value.\nKeywords: CICS, COBOL, Get Counter, DB2, SQL, Error Handling"}, {"fileName": "lgacdb01.cbl", "type": "PARAGRAPH", "name": "INSERT-CUSTOMER", "content": "MOVE ' INSERT CUSTOMER' TO EM-SQLREQ\nIF LGAC-NCS = 'ON'\r\n       EXEC SQL\r\n       INSERT INTO CUSTOMER\r\n       ( CUSTOMERNUMBER,\r\n       FIRSTNAME,\r\n       LASTNAME,\r\n       DATEOFBIRTH,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE,\r\n       PHONEMOBILE,\r\n       PHONEHOME,\r\n       EMAILADDRESS )\r\n       VALUES ( :DB2-CUSTOMERNUM-INT,\r\n       :CA-FIRST-NAME,\r\n       :CA-LAST-NAME,\r\n       :CA-DOB,\r\n       :CA-HOUSE-NAME,\r\n       :CA-HOUSE-NUM,\r\n       :CA-POSTCODE,\r\n       :CA-PHONE-MOBILE,\r\n       :CA-PHONE-HOME,\r\n       :CA-EMAIL-ADDRESS )\r\n       END-EXEC\r\n             IF SQLCODE NOT EQUAL 0\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n             END-IF\r\n           ELSE\r\n       EXEC SQL\r\n       INSERT INTO CUSTOMER\r\n       ( CUSTOMERNUMBER,\r\n       FIRSTNAME,\r\n       LASTNAME,\r\n       DATEOFBIRTH,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE,\r\n       PHONEMOBILE,\r\n       PHONEHOME,\r\n       EMAILADDRESS )\r\n       VALUES ( DEFAULT,\r\n       :CA-FIRST-NAME,\r\n       :CA-LAST-NAME,\r\n       :CA-DOB,\r\n       :CA-HOUSE-NAME,\r\n       :CA-HOUSE-NUM,\r\n       :CA-POSTCODE,\r\n       :CA-PHONE-MOBILE,\r\n       :CA-PHONE-HOME,\r\n       :CA-EMAIL-ADDRESS )\r\n       END-EXEC\r\n             IF SQLCODE NOT EQUAL 0\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n             END-IF\r\n      *>     get value of assigned customer number\r\n       EXEC SQL\r\n       SET :DB2-CUSTOMERNUM-INT = IDENTITY_VAL_LOCAL()\r\n       END-EXEC\r\n           END-IF\nMOVE DB2-CUSTOMERNUM-INT TO CA-CUSTOMER-NUM\nEXIT\n", "lineNumber": 322, "summary": "The below code segment is a \"PARAGRAPH\" named \"INSERT-CUSTOMER\" which is in the file \"lgacdb01.cbl\" at line number \"322\"\nBusiness Intent: Insert a new customer record into the CUSTOMER table in an SQL database, with error handling for unsuccessful operations.\nTechnical Action: Uses COBOL's EXEC SQL statement to execute INSERT INTO and SET commands on a DB2 database. CICS commands are used to return from the program after successful or failed execution.\nKeywords: COBOL, DB2, SQL, INSERT INTO, SET, CICS, Error Handling"}, {"fileName": "lgacdb01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "MOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 402, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgacdb01.cbl\" at line number \"402\"\nBusiness Intent: Retrieve the current date and time, format it in a specific manner, and then link to an external program (LGSTSQ) with error handling.\nTechnical Action: This code segment uses CICS commands (ASKTIME, FORMATTIME, LINK) to retrieve the current date and time, format it in MMDDYYYY and TIME formats, and then link to the LGSTSQ program. Error handling is implemented using SQLCODE and EIBCALEN variables.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK, LGSTSQ, SQLCODE, EIBCALEN, Error Handling"}, {"fileName": "lgupol01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgupol01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: DFHCOMMAREA, CA-REQUEST-ID, CA-RETURN-CODE, CA-CUSTOMER-NUM, CA-REQUEST-SPECIFIC, POLICY-NUMPIC, PHONE-MOBILE, EMAIL-ADDRESS"}, {"fileName": "lgupol01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgupol01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGUPOL01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  WS-POLICY-LENGTHS.\n   03 WS-FULL-ENDOW-LEN        PIC S9(4) COMP VALUE +124.\n   03 WS-FULL-HOUSE-LEN        PIC S9(4) COMP VALUE +130.\n   03 WS-FULL-MOTOR-LEN        PIC S9(4) COMP VALUE +137.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGUPOL01'.\n   03 EM-VARIABLE              PIC X(21) VALUE SPACES.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN         PIC S9(4) COMP VALUE +28.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4) COMP VALUE +0.\n\n 01 LGUPDB01                     PIC X(8) VALUE 'LGUPDB01'.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgupol01.cbl\" in the file \"lgupol01.cbl\"\nStructure: DATA LAYOUT FOR lgupol01.cbl\nDescription: Analyzing legacy COBOL systems.\nFields: WS-HEADER, WS-EYECATCHER, WS-TRANSID, WS-TASKNUM, WS-FILLER, WS-ADDR-DFHCOMMAREA, WS-CALLEN, WS-POLICY-LENGTHS, ERROR-MSG, CA-ERROR-MSG, WS-COMMAREA-LENGTHS, LGUPDB01, DFHCOMMAREA"}, {"fileName": "lgupol01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXEC CICS RETURN END-EXEC\n\nEXIT\n\nEXEC CICS LINK Program(LGUPDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 186, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgupol01.cbl\" at line number \"186\"\nBusiness Intent: Generate a report by linking to another program, formatting the current time and date, and handling errors.\nTechnical Action: Executes CICS commands (RETURN, LINK, ASKTIME, FORMATTIME), handles error conditions, and moves data between variables.\nKeywords: CICS, LINK, ASKTIME, FORMATTIME, ERROR HANDLING, DATE, TIME, REPORT GENERATION"}, {"fileName": "lgupol01.cbl", "type": "PARAGRAPH", "name": "END-PROGRAM", "content": "EXEC CICS RETURN END-EXEC\n", "lineNumber": 249, "summary": "The below code segment is a \"PARAGRAPH\" named \"END-PROGRAM\" which is in the file \"lgupol01.cbl\" at line number \"249\"\nBusiness Intent: Terminate the current program flow and return control to the calling program or session.\nTechnical Action: Executes a CICS RETURN command, ending the current transaction and returning control to the calling program or session.\nKeywords: CICS, RETURN, COBOL, Transaction, Flow Control"}, {"fileName": "lgupol01.cbl", "type": "PARAGRAPH", "name": "UPDATE-POLICY-DB2-INFO", "content": "EXEC CICS LINK Program(LGUPDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n", "lineNumber": 258, "summary": "The below code segment is a \"PARAGRAPH\" named \"UPDATE-POLICY-DB2-INFO\" which is in the file \"lgupol01.cbl\" at line number \"258\"\nBusiness Intent: Invoke a program (LGUPDB01) and establish communication for data exchange.\nTechnical Action: CICS LINK command is used to initiate the interaction between the COBOL application and another program or system.\nKeywords: COBOL, CICS, LINK, Program, Communication, Data Exchange"}, {"fileName": "lgupol01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 272, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgupol01.cbl\" at line number \"272\"\nBusiness Intent: Retrieve and format the current time, then link to an external program 'LGSTSQ' for further processing.\nTechnical Action: Asks for the current system time using CICS ASKTIME command, formats it into a MMDDYYYY date and TIME string using CICS FORMATTIME command, handles error handling, and links to the 'LGSTSQ' program with a COMMAREA message.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK, COMMAREA, Error Handling, Time Processing"}, {"fileName": "lgicvs01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n         \n03COMMA-DATA.\r\n           \n05Comma-Data-HPicX(14).\r\n           \n05Comma-Data-HighPic9(10).\r\n           \n05FILLERPicX(60).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgicvs01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: Comma-Data-HPicX, Comma-Data-HighPic9"}, {"fileName": "lgicvs01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgicvs01.cbl", "content": " 01  WS-FLAG-TSQE              PIC X.\n\n 01  WS-FLAG-TSQH              PIC X.\n\n 01  WS-FLAG-TSQL              PIC X.\n\n 01  WS-FLAG                   PIC X.\n\n 01  WS-RANDOM-Seed            PIC S9(4) Comp.\n\n 01  WS-RANDOM-Number          PIC 9(8) Comp.\n\n 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-STARTCODE              PIC XX Value spaces.\n\n 01  WS-SYSID                  PIC X(4) Value spaces.\n\n 01  WS-Invokeprog             PIC X(8) Value spaces.\n\n 01  WS-COMMAREA               PIC X(80).\n\n 01  WS-RECV.\n   03 WS-RECV-TRANID           PIC X(5).\n   03 WS-RECV-DATA             PIC X(74).\n\n 01  WS-RECV-LEN               PIC S9(4) COMP Value 80.\n\n 01  READ-MSG.\n   03 READ-MSG-MSG             PIC X(80).\n\n 01  FILLER REDEFINES Read-MSG.\n   03 FILLER                   PIC X(13).\n   03 READ-CUST-LOW            PIC 9(10).\n\n 01  FILLER REDEFINES Read-MSG.\n   03 FILLER                   PIC X(14).\n   03 READ-CUST-HIGH           PIC 9(10).\n\n 01  WS-Cust-Low               Pic S9(10).\n\n 01  WS-Cust-High              Pic S9(10).\n\n 01  WS-Cust-Number            Pic X(10).\n\n 01  WRITE-MSG.\n   03 WRITE-MSG-E            PIC X(20) Value '**** GENAPP CNTL'.\n   03 WRITE-MSG-L              PIC X(13) Value 'LOW CUSTOMER='.\n   03 WRITE-MSG-LOW            PIC X(10).\n   03 FILLER                   PIC X.\n   03 WRITE-MSG-H              PIC X(14) Value 'HIGH CUSTOMER='.\n   03 WRITE-MSG-High           PIC 9(10).\n   03 FILLER                   Pic X(60).\n\n 01  STSQ.\n   03  STSQ-NAME                 PIC X(8) Value 'GENACNTL'.\n\n 01  FILLER REDEFINES STSQ.\n   03 FILLER                   PIC X(4).\n   03 STSQ-EXT                 PIC X(4).\n\n 01 TEMPO                      PIC X(90) VALUE SPACES.\n\n 01 CA-AREA.\n   03  CA-CUSTOMER-NUM         Pic X(10).\n   03  Filler                  Pic X(215).\n\n 01  DFHCOMMAREA.\n   03  COMMA-DATA.\n     05 Comma-Data-H           Pic X(14).\n     05 Comma-Data-High        Pic 9(10).\n     05 FILLER                 Pic X(60).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgicvs01.cbl\" in the file \"lgicvs01.cbl\"\nStructure: DATA LAYOUT FOR lgicvs01.cbl\nDescription: Legacy COBOL Data Structure Analysis\nFields: WS-FLAG-TSQE, WS-RANDOM-Seed, WS-RESP, WS-SYSID, CA-CUSTOMER-NUM"}, {"fileName": "lgicvs01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\n", "lineNumber": 93, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgicvs01.cbl\" at line number \"93\"\nBusiness Intent: Terminates program execution and returns control to the calling program.\nTechnical Action: Utilizes GOBACK command to exit the current program and return control to the previous program or task.\nKeywords: COBOL, EXIT, GOBACK, CICS, Program Termination"}, {"fileName": "lgicvs01.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 227, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgicvs01.cbl\" at line number \"227\"\nBusiness Intent: Terminate and return control to the previous program\nTechnical Action: Uses COBOL's EXIT statement followed by a GOBACK command\nKeywords: COBOL, EXIT, GOBACK, Program Termination"}, {"fileName": "lgwebst5.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n         \n03COMMA-DATA.\r\n           \n05Comma-Data-HPicX(14).\r\n           \n05Comma-Data-HighPic9(10).\r\n           \n05FILLERPicX(60).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgwebst5.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: Comma-Data-HPicX, Comma-Data-HighPic9"}, {"fileName": "lgwebst5.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgwebst5.cbl", "content": " 01  CountVal                   PIC S9(8) COMP.\n\n 01  CountSuccess               PIC S9(9) COMP.\n\n 01  CountErrors                PIC S9(8) COMP.\n\n 01  CountInq                   PIC S9(8) COMP.\n\n 01  CountAdd                   PIC S9(8) COMP.\n\n 01  CountUpd                   PIC S9(8) COMP.\n\n 01  CountDel                   PIC S9(8) COMP.\n\n 01  DRateVal                   PIC 9(9).\n\n 01  NRateVal                   PIC 9(9).\n\n 01  ORateVal                   PIC 9(9).\n\n 01  ICountVal                  PIC 9(6).\n\n 01  OCountVal                  PIC 9(6).\n\n 01  NCountVal                  PIC 9(6).\n\n 01  HHval                      PIC 9(6).\n\n 01  MMval                      PIC 9(6).\n\n 01  SSval                      PIC 9(6).\n\n 01  WS-RESP                    PIC S9(8) COMP.\n\n 01  WS-ABSTIME                 PIC S9(8) COMP VALUE +0.\n\n 01  WS-CODE                    Pic 9(4) Comp.\n\n 01  WS-TIME                    Pic X(8).\n\n 01  WS-Startup                 Pic X(40) Value\r\n                     'GENAPP Statistics collector started.'.\n\n 01  TCPservice                Pic X(8) Value 'SSISTAT1'.\n\n 01  TCPaddress                Pic X(15).\n\n 01  TCPaddrLen                Pic S9(8) Comp sync.\n\n 01  Part1                     Pic X(8).\n\n 01  Part2                     Pic X(8).\n\n 01  Part3                     Pic X(8).\n\n 01  Part4                     Pic X(8).\n\n 01  TSQpre                    Pic X(4).\n\n 01  WS-TSQname                 Pic X(8).\n\n 01  WS-TSQdata                 Pic X(9).\n\n 01  WS-TSQstart                Pic X(24).\n\n 01  WS-HHMMSS.\n   03  WS-HH                    Pic X(2).\n   03  WS-MM                    Pic X(2).\n   03  WS-SS                    Pic X(2).\n\n 01  WS-DATE                    PIC X(10) VALUE SPACES.\n\n 01  StatQ                      PIC X(8)  Value 'GENASTAT'.\n\n 01  TemplateName               PIC X(48) Value 'GENAST3TEMP'.\n\n 01  WS-APPLID                  PIC X(8).\n\n 01  WS-TOKEN                   PIC X(16).\n\n 01  WS-TEXT                    PIC X(2)  Value 'OK'.\n\n 01  WS-MTYPE                   Pic X(56) Value 'text/html'.\n\n 01  WS-CHARSET                 Pic X(40) Value 'ISO-8859-1'.\n\n 01  WS-OLDV.\n   02 WS-OLDVHH                 Pic X(2).\n   02 WS-OLDVMM                 Pic X(2).\n   02 WS-OLDVSS                 Pic X(2).\n\n 01  WS-NEWV                    PIC X(6).\n\n 01  WRITE-MSG-H                PIC X(24) Value '  Statistics.'.\n\n 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                       VALUE 'LGWEBST5------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-CALEN                 PIC 9(7).\n\n 01  SymbList.\n   03  Filler                  Pic X(7)  Value 'APPLID='.\n   03  S1                      Pic X(8)  Value Spaces.\n   03  Filler                  Pic X(13) Value '&GENACount-V='.\n   03  S2                      Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT100-V='.\n   03  S3                      Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT199-V='.\n   03  S4                      Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT200-V='.\n   03  S5                      Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT299-V='.\n   03  S6                      Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT300-V='.\n   03  S7                      Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT399-V='.\n   03  S8                      Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT400-V='.\n   03  S9                      Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT499-V='.\n   03  S10                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT500-V='.\n   03  S11                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT599-V='.\n   03  S12                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT600-V='.\n   03  S13                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT699-V='.\n   03  S14                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT700-V='.\n   03  S15                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT799-V='.\n   03  S16                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT800-V='.\n   03  S17                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT899-V='.\n   03  S18                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNT900-V='.\n   03  S19                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNT999-V='.\n   03  S20                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTA00-V='.\n   03  S21                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNTA99-V='.\n   03  S22                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTB00-V='.\n   03  S23                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNTB99-V='.\n   03  S24                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTC00-V='.\n   03  S25                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNTC99-V='.\n   03  S26                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTD00-V='.\n   03  S27                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNTD99-V='.\n   03  S28                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTE00-V='.\n   03  S29                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNTE99-V='.\n   03  S30                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTF00-V='.\n   03  S31                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNTF99-V='.\n   03  S32                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTG00-V='.\n   03  S33                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNTG99-V='.\n   03  S34                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTH00-V='.\n   03  S35                     Pic X(9).\n   03  Filler                  Pic X(14) Value '&GENACNTH99-V='.\n   03  S36                     Pic Z(8)9.\n   03  Filler                  Pic X(14) Value '&GENACNTI99-V='.\n   03  S37                     Pic Z(9)9.\n   03  Filler                  Pic X(14) Value '&GENAsucces-V='.\n   03  S38                     Pic Z(9)9.\n   03  Filler                  Pic X(14) Value '&GENAerrors-V='.\n   03  S39                     Pic Z(9)9.\n   03  Filler                  Pic X(14) Value '&GENAstart='.\n   03  S40                     Pic X(16).\n\n 01 GENACount-V                 Pic 9(9)  Display.\n\n 01 GENACNT100-V                Pic 9(9)  Display.\n\n 01 GENACNT199-V                Pic 9(9)  Display.\n\n 01 GENACNT200-V                Pic 9(9)  Display.\n\n 01 GENACNT299-V                Pic 9(9)  Display.\n\n 01 GENACNT300-V                Pic 9(9)  Display.\n\n 01 GENACNT399-V                Pic 9(9)  Display.\n\n 01 GENACNT400-V                Pic 9(9)  Display.\n\n 01 GENACNT499-V                Pic 9(9)  Display.\n\n 01 GENACNT500-V                Pic 9(9)  Display.\n\n 01 GENACNT599-V                Pic 9(9)  Display.\n\n 01 GENACNT600-V                Pic 9(9)  Display.\n\n 01 GENACNT699-V                Pic 9(9)  Display.\n\n 01 GENACNT700-V                Pic 9(9)  Display.\n\n 01 GENACNT799-V                Pic 9(9)  Display.\n\n 01 GENACNT800-V                Pic 9(9)  Display.\n\n 01 GENACNT899-V                Pic 9(9)  Display.\n\n 01 GENACNT900-V                Pic 9(9)  Display.\n\n 01 GENACNT999-V                Pic 9(9)  Display.\n\n 01 GENACNTA00-V                Pic 9(9)  Display.\n\n 01 GENACNTA99-V                Pic 9(9)  Display.\n\n 01 GENACNTB00-V                Pic 9(9)  Display.\n\n 01 GENACNTB99-V                Pic 9(9)  Display.\n\n 01 GENACNTC00-V                Pic 9(9)  Display.\n\n 01 GENACNTC99-V                Pic 9(9)  Display.\n\n 01 GENACNTD00-V                Pic 9(9)  Display.\n\n 01 GENACNTD99-V                Pic 9(9)  Display.\n\n 01 GENACNTE00-V                Pic 9(9)  Display.\n\n 01 GENACNTE99-V                Pic 9(9)  Display.\n\n 01 GENACNTF00-V                Pic 9(9)  Display.\n\n 01 GENACNTF99-V                Pic 9(9)  Display.\n\n 01 GENACNTG00-V                Pic 9(9)  Display.\n\n 01 GENACNTG99-V                Pic 9(9)  Display.\n\n 01 GENACNTH00-V                Pic 9(9)  Display.\n\n 01 GENACNTH99-V                Pic 9(9)  Display.\n\n 01 GENACNTI00-V                Pic 9(9)  Display.\n\n 01 GENACNTI99-V                Pic 9(9)  Display.\n\n 01 GENAsucces-V                Pic 9(9)  Display.\n\n 01 GENAerrors-V                Pic 9(9)  Display.\n\n 01  GENAcount                 PIC X(16) Value 'GENACUSTNUM'.\n\n 01  GENApool                  PIC X(8)  Value 'GENA'.\n\n 01  GENACNT100                PIC X(16) Value 'GENA01ICUS00'.\n\n 01  GENACNT199                PIC X(32) Value 'GENA01ICUS99'.\n\n 01  GENACNT200                PIC X(16) Value 'GENA01ACUS00'.\n\n 01  GENACNT299                PIC X(32) Value 'GENA01ACUS99'.\n\n 01  GENACNT300                PIC X(16) Value 'GENA01IMOT00'.\n\n 01  GENACNT399                PIC X(32) Value 'GENA01IMOT99'.\n\n 01  GENACNT400                PIC X(16) Value 'GENA01AMOT00'.\n\n 01  GENACNT499                PIC X(32) Value 'GENA01AMOT99'.\n\n 01  GENACNT500                PIC X(16) Value 'GENA01DMOT00'.\n\n 01  GENACNT599                PIC X(32) Value 'GENA01DMOT99'.\n\n 01  GENACNT600                PIC X(16) Value 'GENA01UMOT00'.\n\n 01  GENACNT699                PIC X(32) Value 'GENA01UMOT99'.\n\n 01  GENACNT700                PIC X(16) Value 'GENA01IEND00'.\n\n 01  GENACNT799                PIC X(32) Value 'GENA01IEND99'.\n\n 01  GENACNT800                PIC X(16) Value 'GENA01AEND00'.\n\n 01  GENACNT899                PIC X(32) Value 'GENA01AEND99'.\n\n 01  GENACNT900                PIC X(16) Value 'GENA01DEND00'.\n\n 01  GENACNT999                PIC X(32) Value 'GENA01DEND99'.\n\n 01  GENACNTA00                PIC X(16) Value 'GENA01UEND00'.\n\n 01  GENACNTA99                PIC X(32) Value 'GENA01UEND99'.\n\n 01  GENACNTB00                PIC X(16) Value 'GENA01IHOU00'.\n\n 01  GENACNTB99                PIC X(32) Value 'GENA01IHOU99'.\n\n 01  GENACNTC00                PIC X(16) Value 'GENA01AHOU00'.\n\n 01  GENACNTC99                PIC X(32) Value 'GENA01AHOU99'.\n\n 01  GENACNTD00                PIC X(16) Value 'GENA01DHOU00'.\n\n 01  GENACNTD99                PIC X(32) Value 'GENA01DHOU99'.\n\n 01  GENACNTE00                PIC X(16) Value 'GENA01UHOU00'.\n\n 01  GENACNTE99                PIC X(32) Value 'GENA01UHOU99'.\n\n 01  GENACNTF00                PIC X(16) Value 'GENA01ICOM00'.\n\n 01  GENACNTF99                PIC X(32) Value 'GENA01ICOM99'.\n\n 01  GENACNTG00                PIC X(16) Value 'GENA01ACOM00'.\n\n 01  GENACNTG99                PIC X(32) Value 'GENA01ACOM99'.\n\n 01  GENACNTH00                PIC X(16) Value 'GENA01DCOM00'.\n\n 01  GENACNTH99                PIC X(32) Value 'GENA01DCOM99'.\n\n 01  GENACNTI99                PIC X(16) Value 'GENAOTHER   '.\n\n 01  DFHCOMMAREA.\n   03  COMMA-DATA.\n     05 Comma-Data-H           Pic X(14).\n     05 Comma-Data-High        Pic 9(10).\n     05 FILLER                 Pic X(60).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgwebst5.cbl\" in the file \"lgwebst5.cbl\"\nStructure: DATA LAYOUT FOR lgwebst5.cbl\nDescription: Legacy COBOL data structure for statistics collection.\nFields: CountVal, CountSuccess, CountErrors, DRateVal, NRateVal, ORateVal, ICountVal, OCountVal, NCountVal, HHval, MMval, SSval"}, {"fileName": "lgwebst5.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\nString TSQpre, \r\n                  '000V' Delimited By Spaces\r\n                  Into WS-TSQname\nExec Cics ReadQ TS Queue(WS-TSQname)\r\n       Into(WS-OLDV)\r\n       Item(1)\r\n       Length(Length of WS-OLDV)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nIf WS-RESP Not = DFHRESP(NORMAL)\r\n            Move '120000' To WS-OLDV\nExec Cics DeleteQ TS Queue(WS-TSQNAME)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove WS-TIME   To WS-HHMMSS\nExec Cics WRITEQ TS Queue(WS-TSQNAME)\r\n       FROM(WS-HHMMSS)\r\n       Length(Length of WS-HHMMSS)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove WS-HH     To HHVal\nMove WS-MM     To MMVal\nMove WS-SS     To SSVal\nCompute NCountVal = (HHVal * 3600) +\r\n                               (MMVal * 60)   +\r\n                                SSVal\nMove WS-OLDVHH To HHVal\nMove WS-OLDVMM To MMVal\nMove WS-OLDVSS To SSVal\nCompute OCountVal = (HHVal * 3600) +\r\n                               (MMVal * 60)   +\r\n                                SSVal\nCompute ICountVal = NCountVal - OCountVal\nmove ICountVal To WS-NEWV\nString TSQpre, \r\n                  '000V' Delimited By Spaces\r\n                  Into WS-TSQname\nExec Cics WRITEQ TS Queue(WS-TSQNAME)\r\n       FROM(WS-NEWV)\r\n       Length(Length of WS-NEWV)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nExec Cics Start Transid('SSST')\r\n       After\r\n       Minutes(1)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nExit\n\nExec Cics ReadQ TS Queue(WS-TSQname)\r\n       Into(WS-TSQdata)\r\n       Item(1)\r\n       Length(Length of WS-TSQdata)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove WS-TSQdata  To ORateVal\nExec Cics DeleteQ TS Queue(WS-TSQname)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove NRateVal  To WS-TSQdata\nExec Cics WRITEQ TS Queue(WS-TSQname)\r\n       FROM(WS-TSQdata)\r\n       Length(Length of WS-TSQdata)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove ORateVal   To WS-TSQdata\nExec Cics WRITEQ TS Queue(WS-TSQname)\r\n       FROM(WS-TSQdata)\r\n       Length(Length of WS-TSQdata)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nCompute DRateVal = NRateVal - ORateVal\nMove DRateVal   To WS-TSQdata\nExec Cics WRITEQ TS Queue(WS-TSQname)\r\n       FROM(WS-TSQdata)\r\n       Length(Length of WS-TSQdata)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nExit\n\n", "lineNumber": 250, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgwebst5.cbl\" at line number \"250\"\nBusiness Intent: Update queue with new values after processing old values and calculating differences\nTechnical Action: Reads and writes to CICS TS queues, performs calculations using COBOL instructions\nKeywords: CICS TS, COBOL, queue management, data processing, error handling"}, {"fileName": "lgwebst5.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 711, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgwebst5.cbl\" at line number \"711\"\nBusiness Intent: Terminate and return to the calling program in a CICS environment.\nTechnical Action: Executes an exit statement followed by a go back command, effectively ending the current program flow and returning control to the previous program segment.\nKeywords: CICS, Exit, Go Back, Program Termination"}, {"fileName": "lgwebst5.cbl", "type": "PARAGRAPH", "name": "Tran-Rate-Interval", "content": "String TSQpre, \r\n                  '000V' Delimited By Spaces\r\n                  Into WS-TSQname\nExec Cics ReadQ TS Queue(WS-TSQname)\r\n       Into(WS-OLDV)\r\n       Item(1)\r\n       Length(Length of WS-OLDV)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nIf WS-RESP Not = DFHRESP(NORMAL)\r\n            Move '120000' To WS-OLDV\nExec Cics DeleteQ TS Queue(WS-TSQNAME)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove WS-TIME   To WS-HHMMSS\nExec Cics WRITEQ TS Queue(WS-TSQNAME)\r\n       FROM(WS-HHMMSS)\r\n       Length(Length of WS-HHMMSS)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove WS-HH     To HHVal\nMove WS-MM     To MMVal\nMove WS-SS     To SSVal\nCompute NCountVal = (HHVal * 3600) +\r\n                               (MMVal * 60)   +\r\n                                SSVal\nMove WS-OLDVHH To HHVal\nMove WS-OLDVMM To MMVal\nMove WS-OLDVSS To SSVal\nCompute OCountVal = (HHVal * 3600) +\r\n                               (MMVal * 60)   +\r\n                                SSVal\nCompute ICountVal = NCountVal - OCountVal\nmove ICountVal To WS-NEWV\nString TSQpre, \r\n                  '000V' Delimited By Spaces\r\n                  Into WS-TSQname\nExec Cics WRITEQ TS Queue(WS-TSQNAME)\r\n       FROM(WS-NEWV)\r\n       Length(Length of WS-NEWV)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nExec Cics Start Transid('SSST')\r\n       After\r\n       Minutes(1)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nExit\n", "lineNumber": 715, "summary": "The below code segment is a \"PARAGRAPH\" named \"Tran-Rate-Interval\" which is in the file \"lgwebst5.cbl\" at line number \"715\"\nBusiness Intent: The code segment manages a queue in a CICS (Customer Information Control System) environment, handling old values and updating the queue with new values.\nTechnical Action: This COBOL code segment reads from a TS queue, processes old values, calculates new values, writes to the same queue, and starts a transaction. It also handles errors and includes error handling mechanisms.\nKeywords: CICS, COBOL, TS Queue, ReadQ, WriteQ, DeleteQ, Transaction, Error Handling, Queue Management"}, {"fileName": "lgwebst5.cbl", "type": "PARAGRAPH", "name": "Tran-Rate-Counts", "content": "Exec Cics ReadQ TS Queue(WS-TSQname)\r\n       Into(WS-TSQdata)\r\n       Item(1)\r\n       Length(Length of WS-TSQdata)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove WS-TSQdata  To ORateVal\nExec Cics DeleteQ TS Queue(WS-TSQname)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove NRateVal  To WS-TSQdata\nExec Cics WRITEQ TS Queue(WS-TSQname)\r\n       FROM(WS-TSQdata)\r\n       Length(Length of WS-TSQdata)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nMove ORateVal   To WS-TSQdata\nExec Cics WRITEQ TS Queue(WS-TSQname)\r\n       FROM(WS-TSQdata)\r\n       Length(Length of WS-TSQdata)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nCompute DRateVal = NRateVal - ORateVal\nMove DRateVal   To WS-TSQdata\nExec Cics WRITEQ TS Queue(WS-TSQname)\r\n       FROM(WS-TSQdata)\r\n       Length(Length of WS-TSQdata)\r\n       Resp(WS-RESP)\r\n       End-Exec }\nExit\n", "lineNumber": 769, "summary": "The below code segment is a \"PARAGRAPH\" named \"Tran-Rate-Counts\" which is in the file \"lgwebst5.cbl\" at line number \"769\"\nBusiness Intent: Calculates and updates a rate value by reading, deleting, and writing to a CICS queue.\nTechnical Action: Executes CICS commands (READQ, DELETEQ, WRITEQ) and performs arithmetic operations.\nKeywords: CICS, queue, read, write, delete, rate calculation, arithmetic operation, TS Queue, WS-TSQname, WS-TSQdata, NRateVal, ORateVal, DRateVal"}, {"fileName": "lgapol01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgapol01.cbl\"\nStructure: LINKAGE SECTION\nDescription: This COBOL data structure is a linkage section, which is used to define the structure of a block of memory that is shared between different programs.\nFields: CA-REQUEST-ID, CA-CUSTOMER-NUM, CA-POLICY-NUMPIC9(10), CA-RETURN-CODEPIC9(2)"}, {"fileName": "lgapol01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgapol01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGAPOL01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  ABS-TIME                    PIC S9(8) COMP VALUE +0.\n\n 01  TIME1                       PIC X(8)  VALUE SPACES.\n\n 01  DATE1                       PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGAPOL01'.\n   03 EM-VARIABLE              PIC X(21) VALUE SPACES.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  LGAPDB01                    PIC X(8)  VALUE 'LGAPDB01'.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN         PIC S9(4) COMP VALUE +28.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4)      VALUE +0.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgapol01.cbl\" in the file \"lgapol01.cbl\"\nStructure: DATA LAYOUT FOR lgapol01.cbl\nDescription: \nFields: WS-EYECATCHER, WS-TRANSID, WS-TASKNUM, CA-REQUEST-ID, CA-CUSTOMER-NUM, CA-POLICY-NUM"}, {"fileName": "lgapol01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\nEXEC CICS ASKTIME ABSTIME(ABS-TIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(ABS-TIME)\r\n       MMDDYYYY(DATE1)\r\n       TIME(TIME1)\r\n       END-EXEC\nMOVE DATE1 TO EM-DATE\nMOVE TIME1 TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 183, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgapol01.cbl\" at line number \"183\"\nBusiness Intent: Retrieve and format current date and time, then link to 'LGSTSQ' program with error handling.\nTechnical Action: Use CICS commands (ASKTIME, FORMATTIME) to retrieve and format the current date and time. Then, use LINK command to execute 'LGSTSQ' program with error handling mechanism in place.\nKeywords: CICS, COBOL, ASKTIME, FORMATTIME, LINK, Error Handling, Date and Time, Commarea"}, {"fileName": "lgapol01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(ABS-TIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(ABS-TIME)\r\n       MMDDYYYY(DATE1)\r\n       TIME(TIME1)\r\n       END-EXEC\nMOVE DATE1 TO EM-DATE\nMOVE TIME1 TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 240, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgapol01.cbl\" at line number \"240\"\nBusiness Intent: Retrieve and format the current date and time, then link to an external program (LGSTSQ) with error handling for abnormal lengths of COMMAREA.\nTechnical Action: Use CICS ASKTIME and FORMATTIME commands to retrieve the current date and time. Move the formatted date and time to EM-DATE and EM-TIME variables. Link to the LGSTSQ program using the EXEC CICS LINK command, with error handling for COMMAREA lengths greater than 0.\nKeywords: COBOL, CICS, ASKTIME, FORMATTIME, LINK, COMMAREA, ERROR-MSG, LGSTSQ, MAINFRAME"}, {"fileName": "lgastat1.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgastat1.cbl\"\nStructure: LINKAGE SECTION\nDescription: Analyzing the given COBOL data structure...\nFields: CA-REQUEST-ID, CA-RETURN-CODE, CA-CUSTOMER-NUMBER"}, {"fileName": "lgastat1.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgastat1.cbl", "content": " 01  WS-ABSTIME                 PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                    Pic X(8).\n\n 01  WS-DATE                    Pic X(10).\n\n 01  WS-QAREA.\n   03  WS-Area-D                Pic X(8).\n   03  Filler                   Pic XX Value spaces.\n   03  WS-Area-T                Pic X(6).\n\n 01  WS-Qname                   Pic X(8) value 'GENASTRT'.\n\n 01  WS-CONTname        Pic X(16) value 'DFHEP.CCECONTEXT'.\n\n 01  WS-CHANname        Pic X(16) value 'DFHEP.EVENT'.\n\n 01  WS-CHANname1       Pic X(16) value 'DFHEP.DATA.00001'.\n\n 01  WS-CHANname2       Pic X(16) value 'DFHEP.DATA.00002'.\n\n 01  WS-Data-Req                Pic X(6).\n\n 01  WS-Data-RC                 Pic X(2).\n\n 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGASTAT1------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-CALEN                 PIC 9(7).\n\n 01  WS-RESP                     PIC S9(8) COMP.\n\n 01  GENAcount.\n   03 Filler                     Pic X(4) Value 'GENA'.\n   03 GENAcounter                Pic X(6).\n   03 GENAtype                   Pic X(2).\n   03 Filler                     Pic X(4) Value '    '.\n\n 01  Trancount                   Pic S9(8) COMP.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN         PIC S9(4) COMP VALUE +18.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4)      VALUE +0.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgastat1.cbl\" in the file \"lgastat1.cbl\"\nStructure: DATA LAYOUT FOR lgastat1.cbl\nDescription: Legacy COBOL structure for data processing.\nFields: WS-ABSTIME, WS-TIME, WS-DATE, DFHCOMMAREA.CA-REQUEST-ID, DFHCOMMAREA.CA-CUSTOMER-NUM"}, {"fileName": "lgastat1.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\n", "lineNumber": 172, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgastat1.cbl\" at line number \"172\"\nBusiness Intent: Exit program execution immediately without performing any further actions.\nTechnical Action: \nKeywords: COBOL, EXIT, program termination"}, {"fileName": "lgucvs01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgucvs01.cbl\"\nStructure: LINKAGE SECTION\nDescription: Analyzing the given COBOL code, I identify that this structure represents a comprehensive record of business entity 'Policy' or 'Customer Request'. This linkage section appears to be used for both input/output and database storage purposes. Here's a breakdown of key fields that a developer might search for:\n\nFields: CA-REQUEST-ID, CA-RETURN-CODE, CA-CUSTOMER-NUM, CA-POLICY-NUM, CA-ISSUE-DATE, CA-EXPIRY-DATE, CA-LASTCHANGED, CA-BROKERID, CA-PAYMENT, E-WITH-PROFITS, H-PROPERTY-TYPE, M-MAKE, B-FirePeril, C-Cause, C-Observations"}, {"fileName": "lgucvs01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgucvs01.cbl", "content": " 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-RESP2                  PIC S9(8) COMP.\n\n 01  WS-Comm-Len               PIC S9(8) COMP.\n\n 01  WS-STARTCODE              PIC XX Value spaces.\n\n 01  WS-SYSID                  PIC X(4) Value spaces.\n\n 01  WS-Commarea-Len           PIC S9(4) COMP.\n\n 01  WS-Customer-Area          PIC X(1024) value Spaces.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGUCVS01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(20)\r\n                                        Value ' Re-write  KSDSCUST '.\n     05 FILLER                 PIC X(6)  VALUE ' RESP='.\n     05 EM-RESPRC              PIC +9(5) USAGE DISPLAY.\n     05 FILLER                 PIC X(7)  VALUE ' RESP2='.\n     05 EM-RESP2RC             PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  CUSTOMER-RECORD-SIZE        PIC S9(4) BINARY VALUE 0225.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgucvs01.cbl\" in the file \"lgucvs01.cbl\"\nStructure: DATA LAYOUT FOR lgucvs01.cbl\nDescription:  Legacy COBOL system record layout\nFields: WS-RESP, WS-SYSID, CA-REQUEST-ID, CA-CUSTOMER-NUM, CA-POLICY-NUM, CA-B-FirePeril, CA-B-CrimePeril, CA-B-FloodPeril, CA-B-WeatherPeril"}, {"fileName": "lgucvs01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-Cusnum\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 167, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgucvs01.cbl\" at line number \"167\"\nBusiness Intent: To retrieve and format date and time information, retrieve customer number, response codes, and handle errors while linking to external programs.\nTechnical Action: Uses CICS commands (ASKTIME, FORMATTIME, LINK) to perform date/time formatting, retrieve customer info, and link to 'LGSTSQ' program. Error handling is implemented using IF-THEN statements.\nKeywords: CICS, COBOL, DATE/TIME FORMATTING, CUSTOMER INFORMATION, ERROR HANDLING, LINK PROGRAM, COMMAREA"}, {"fileName": "lgucvs01.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 203, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgucvs01.cbl\" at line number \"203\"\nBusiness Intent: Terminates the program flow and returns control to the calling program.\nTechnical Action: Executes a GOBACK statement, which terminates the current task and passes control back to the previous task or program.\nKeywords: CICS, Program Flow Control, Error Handling"}, {"fileName": "lgucvs01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-Cusnum\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 207, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgucvs01.cbl\" at line number \"207\"\nBusiness Intent: Retrieve current system time and customer information, then link to LGSTSQ program for further processing.\nTechnical Action: ASKTIME CICS command retrieves current system time, FORMATTIME formats the date and time, MOVE operations copy data between variables. LINK PROGRAM('LGSTSQ') links to an external program, handling error messages.\nKeywords: CICS, COBOL, MAINFRAME, SYSTEM TIME, CUSTOMER INFORMATION, LINK PROGRAM, ERROR HANDLING, MAINFRAME MODERNIZATION"}, {"fileName": "lgdpol01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgdpol01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: CA-REQUEST-ID, CA-CUSTOMER-NUMP, CA-POLICY-DATAPIC, CA-CUSTSECR-STATEPIC, CA-ISSUE-DATE, CA-PAYMENTPIC"}, {"fileName": "lgdpol01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgdpol01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGDPOL01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGDPOL01'.\n   03 EM-VARIABLE              PIC X(21) VALUE SPACES.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN          PIC S9(4) COMP VALUE +28.\n\n 01 LGDPDB01                  PIC x(8) Value 'LGDPDB01'.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgdpol01.cbl\" in the file \"lgdpol01.cbl\"\nStructure: DATA LAYOUT FOR lgdpol01.cbl\nDescription: \nFields: WS-EYECATCHER, WS-TRANSID, WS-TERMID, WS-TASKNUM, WS-ADDR-DFHCOMMAREA, WS-CALEN, WS-ABSTIME, WS-TIME, WS-DATE"}, {"fileName": "lgdpol01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\nEXEC CICS LINK PROGRAM(LGDPDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(Ws-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 181, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgdpol01.cbl\" at line number \"181\"\nBusiness Intent: Integrate LGDPDB01 program with CICS services to retrieve time and date, format it according to MMDDYYYY and TIME formats, and handle errors by linking to LGSTSQ program.\nTechnical Action: Executes CICS commands (LINK, ASKTIME, FORMATTIME) to interact with the database and retrieve date and time information. It handles error conditions by executing specific programs depending on the length of the COMMAREA.\nKeywords: CICS, COBOL, MAINFRAME, PROGRAMMING, DATABASE, DATE, TIME, ERROR HANDLING, LINK, ASKTIME, FORMATTIME"}, {"fileName": "lgdpol01.cbl", "type": "PARAGRAPH", "name": "DELETE-POLICY-DB2-INFO", "content": "EXEC CICS LINK PROGRAM(LGDPDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n", "lineNumber": 242, "summary": "The below code segment is a \"PARAGRAPH\" named \"DELETE-POLICY-DB2-INFO\" which is in the file \"lgdpol01.cbl\" at line number \"242\"\nBusiness Intent: Initiates a link request to the LGDPDB01 program, facilitating data exchange and processing.\nTechnical Action: Executes a CICS LINK command with a COMMAREA buffer and specifies the target program and length.\nKeywords: CICS, LINK, COMMAREA, DFHCOMMAREA, PROGRAM, LENGTH, Mainframe, Legacy System"}, {"fileName": "lgdpol01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(Ws-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 257, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgdpol01.cbl\" at line number \"257\"\nBusiness Intent: Retrieve and format the current system time, then link to a program 'LGSTSQ' for further processing.\nTechnical Action: Uses CICS ASKTIME and FORMATTIME commands to get the system time, followed by MOVE statements to extract date and time components. The code then executes a LINK command to 'LGSTSQ' program with error handling and conditional logic to handle COMMAREA data.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK, COMMAREA, Error Handling, System Time, Date, Time"}, {"fileName": "lgdpvs01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgdpvs01.cbl\"\nStructure: LINKAGE SECTION\nDescription: COBOL Data Structure Analysis\nFields: DFHCOMMAREA, REQUEST-ID, RETURN-CODE, CUSTOMER-NUMBER, REQUEST-SPECIFIC, POLICY-DATA, CUSTSECR-PASS, PHONE-MOBILE, EMAIL-ADDRESS, POLICY-NUMBER"}, {"fileName": "lgdpvs01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgdpvs01.cbl", "content": " 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-RESP2                  PIC S9(8) COMP.\n\n 01  WS-Comm-Len               PIC S9(8) COMP.\n\n 01  WS-STARTCODE              PIC XX Value spaces.\n\n 01  WS-SYSID                  PIC X(4) Value spaces.\n\n 01  WS-Commarea-Len           PIC S9(4) COMP.\n\n 01  WF-Policy-Info.\n   03  WF-Policy-Key.\n     05  WF-Request-ID           Pic X.\n     05  WF-Customer-Num         Pic X(10).\n     05  WF-Policy-Num           Pic X(10).\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGDPVS01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' PNUM='.\n     05 EM-POLNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(21)\r\n                                        Value ' Delete file KSDSPOLY'.\n     05 FILLER                 PIC X(6)  VALUE ' RESP='.\n     05 EM-RESPRC              PIC +9(5) USAGE DISPLAY.\n     05 FILLER                 PIC X(7)  VALUE ' RESP2='.\n     05 EM-RESP2RC             PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgdpvs01.cbl\" in the file \"lgdpvs01.cbl\"\nStructure: DATA LAYOUT FOR lgdpvs01.cbl\nDescription: \nFields: WF-Request-ID, WF-Customer-Num, WF-Policy-Num, EM-POLNUM, EM-CUSNUM, DFHCOMMAREA-CA-REQUEST-ID, DFHCOMMAREA-CA-CUSTOMER-NUM, DFHCOMMAREA-CA-POLICY-NUM, CA-POLICY-NUM, CA-B-FirePeril, CA-B-CrimePeril, CA-B-FloodPeril, CA-B-WeatherPeril, CA-B-RejectReason, CA-C-Num, CA-C-Date, CA-C-Paid, CA-C-Value, CA-C-Cause, CA-C-Observations, WF-Policy-Key-WF-Request-ID, WF-Policy-Key-WF-Customer-Num, WF-Policy-Key-WF-Policy-Num, EM-VARIABLE-EM-POLNUM, EM-VARIABLE-EM-CUSNUM"}, {"fileName": "lgdpvs01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-CUSNUM\nMove CA-POLICY-NUM To EM-POLNUM\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 175, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgdpvs01.cbl\" at line number \"175\"\nBusiness Intent: Generate a timestamp and link to an external program (LGSTSQ) to process customer data.\nTechnical Action: Ask for the current time, format it as MMDDYYYY and TIME, move data from WS variables to EM variables, and link to LGSTSQ with error handling.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK PROGRAM, COMMAREA, ERROR HANDLING"}, {"fileName": "lgdpvs01.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 198, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgdpvs01.cbl\" at line number \"198\"\nBusiness Intent: Terminates program execution and returns control to the calling program.\nTechnical Action: Executes a GOBACK statement, effectively exiting the current program and returning control to the caller.\nKeywords: program termination, control flow, COBOL programming, GOBACK, EXIT"}, {"fileName": "lgdpvs01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-CUSNUM\nMove CA-POLICY-NUM To EM-POLNUM\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 202, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgdpvs01.cbl\" at line number \"202\"\nBusiness Intent: Retrieve current system time and policy information, and link to LGSTSQ program for further processing.\nTechnical Action: Use CICS commands (ASKTIME, FORMATTIME) to retrieve the current date and time. Move data from WS-DATE, WS-TIME, CA-Customer-Num, CA-POLICY-NUM, WS-RESP, and WS-RESP2 to EM variables. Use IF-THEN statement to handle EIBCALEN value and link to LGSTSQ program with COMMAREA and LENGTH parameters.\nKeywords: COBOL, CICS, ASKTIME, FORMATTIME, LINK, COMMAREA, LENGTH, IF-THEN, EIBCALEN, LGSTSQ, Error Handling"}, {"fileName": "lgacdb02.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n           \n03D2-REQUEST-IDPICX(6).\r\n           \n03D2-RETURN-CODEPIC9(2).\r\n           \n03D2-CUSTOMER-NUMPIC9(10).\r\n           \n03D2-CUSTSECR-PASSPICX(32).\r\n           \n03D2-CUSTSECR-COUNTPICX(4).\r\n           \n03D2-CUSTSECR-STATEPICX.\r\n           \n03D2-CUSTSECR-DATAPICX(32445).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgacdb02.cbl\"\nStructure: LINKAGE_SECTION\nDescription: \nFields: REQUEST-ID, RETURN-CODE, CUSTOMER-NUM"}, {"fileName": "lgacdb02.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgacdb02.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGACDB02------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  LastCustNum               PIC S9(8) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGACDB02'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 EM-SQLREQ              PIC X(16) VALUE SPACES.\n     05 FILLER                 PIC X(9)  VALUE ' SQLCODE='.\n     05 EM-SQLRC               PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  WS-POLICY-LENGTHS.\n   03 WS-CUSTOMER-LEN          PIC S9(4) COMP VALUE +72.\n   03 WS-POLICY-LEN            PIC S9(4) COMP VALUE +72.\n   03 WS-ENDOW-LEN             PIC S9(4) COMP VALUE +52.\n   03 WS-HOUSE-LEN             PIC S9(4) COMP VALUE +58.\n   03 WS-MOTOR-LEN             PIC S9(4) COMP VALUE +65.\n   03 WS-COMM-LEN              PIC S9(4) COMP VALUE +1102.\n   03 WS-CLAIM-LEN             PIC S9(4) COMP VALUE +546.\n   03 WS-FULL-ENDOW-LEN        PIC S9(4) COMP VALUE +124.\n   03 WS-FULL-HOUSE-LEN        PIC S9(4) COMP VALUE +130.\n   03 WS-FULL-MOTOR-LEN        PIC S9(4) COMP VALUE +137.\n   03 WS-FULL-COMM-LEN         PIC S9(4) COMP VALUE +1174.\n   03 WS-FULL-CLAIM-LEN        PIC S9(4) COMP VALUE +618.\n   03 WS-SUMRY-ENDOW-LEN       PIC S9(4) COMP VALUE +25.\n\n 01  DB2-CUSTOMER.\n   03 DB2-FIRSTNAME            PIC X(10).\n   03 DB2-LASTNAME             PIC X(20).\n   03 DB2-DATEOFBIRTH          PIC X(10).\n   03 DB2-HOUSENAME            PIC X(20).\n   03 DB2-HOUSENUMBER          PIC X(4).\n   03 DB2-POSTCODE             PIC X(8).\n   03 DB2-PHONE-MOBILE         PIC X(20).\n   03 DB2-PHONE-HOME           PIC X(20).\n   03 DB2-EMAIL-ADDRESS        PIC X(100).\n\n 01  DB2-POLICY.\n   03 DB2-POLICYTYPE           PIC X.\n   03 DB2-POLICYNUMBER         PIC 9(10).\n   03 DB2-POLICY-COMMON.\n     05 DB2-ISSUEDATE         PIC X(10).\n     05 DB2-EXPIRYDATE        PIC X(10).\n     05 DB2-LASTCHANGED       PIC X(26).\n     05 DB2-BROKERID          PIC 9(10).\n     05 DB2-BROKERSREF        PIC X(10).\n     05 DB2-PAYMENT           PIC 9(6).\n\n 01  DB2-ENDOWMENT.\n   03 DB2-ENDOW-FIXED.\n     05 DB2-E-WITHPROFITS      PIC X.\n     05 DB2-E-EQUITIES         PIC X.\n     05 DB2-E-MANAGEDFUND      PIC X.\n     05 DB2-E-FUNDNAME         PIC X(10).\n     05 DB2-E-TERM             PIC 9(2).\n     05 DB2-E-SUMASSURED       PIC 9(6).\n     05 DB2-E-LIFEASSURED      PIC X(31).\n   03 DB2-E-PADDINGDATA         PIC X(32611).\n\n 01  DB2-HOUSE.\n   03 DB2-H-PROPERTYTYPE       PIC X(15).\n   03 DB2-H-BEDROOMS           PIC 9(3).\n   03 DB2-H-VALUE              PIC 9(8).\n   03 DB2-H-HOUSENAME          PIC X(20).\n   03 DB2-H-HOUSENUMBER        PIC X(4).\n   03 DB2-H-POSTCODE           PIC X(8).\n\n 01  DB2-MOTOR.\n   03 DB2-M-MAKE               PIC X(15).\n   03 DB2-M-MODEL              PIC X(15).\n   03 DB2-M-VALUE              PIC 9(6).\n   03 DB2-M-REGNUMBER          PIC X(7).\n   03 DB2-M-COLOUR             PIC X(8).\n   03 DB2-M-CC                 PIC 9(4).\n   03 DB2-M-MANUFACTURED       PIC X(10).\n   03 DB2-M-PREMIUM            PIC 9(6).\n   03 DB2-M-ACCIDENTS          PIC 9(6).\n\n 01  DB2-COMMERCIAL.\n   03 DB2-B-Address            PIC X(255).\n   03 DB2-B-Postcode           PIC X(8).\n   03 DB2-B-Latitude           PIC X(11).\n   03 DB2-B-Longitude          PIC X(11).\n   03 DB2-B-Customer           PIC X(255).\n   03 DB2-B-PropType           PIC X(255).\n   03 DB2-B-FirePeril          PIC 9(4).\n   03 DB2-B-FirePremium        PIC 9(8).\n   03 DB2-B-CrimePeril         PIC 9(4).\n   03 DB2-B-CrimePremium       PIC 9(8).\n   03 DB2-B-FloodPeril         PIC 9(4).\n   03 DB2-B-FloodPremium       PIC 9(8).\n   03 DB2-B-WeatherPeril       PIC 9(4).\n   03 DB2-B-WeatherPremium     PIC 9(8).\n   03 DB2-B-Status             PIC 9(4).\n   03 DB2-B-RejectReason       PIC X(255).\n\n 01  DB2-CLAIM.\n   03 DB2-C-Num                PIC 9(10).\n   03 DB2-C-Date               PIC X(10).\n   03 DB2-C-Paid               PIC 9(8).\n   03 DB2-C-Value              PIC 9(8).\n   03 DB2-C-Cause              PIC X(255).\n   03 DB2-C-Observations       PIC X(255).\n\n 01  DB2-OUT-INTEGERS.\n   03 DB2-CUSTOMERNUM-INT   PIC S9(9) COMP.\n   03 DB2-CUSTOMERCNT-INT   PIC S9(9) COMP.\n\n 01  DFHCOMMAREA.\n   03 D2-REQUEST-ID            PIC X(6).\n   03 D2-RETURN-CODE           PIC 9(2).\n   03 D2-CUSTOMER-NUM          PIC 9(10).\n   03 D2-CUSTSECR-PASS         PIC X(32).\n   03 D2-CUSTSECR-COUNT        PIC X(4).\n   03 D2-CUSTSECR-STATE        PIC X.\n   03 D2-CUSTSECR-DATA         PIC X(32445).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgacdb02.cbl\" in the file \"lgacdb02.cbl\"\nStructure: WS-HEADER\nDescription: \nFields: WS-EYECATCHER, WS-TRANSID, WS-TERMID, WS-TASKNUM"}, {"fileName": "lgacdb02.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\nMOVE ' INSERT SECURITY' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO CUSTOMER_SECURE\r\n       ( customerNumber,\r\n       customerPass,\r\n       state_indicator,\r\n       pass_changes   )\r\n       VALUES ( :DB2-CUSTOMERNUM-INT,\r\n       :D2-CUSTSECR-PASS,\r\n       :D2-CUSTSECR-STATE,\r\n       :DB2-CUSTOMERCNT-INT)\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '98' TO D2-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n\nMOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 222, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgacdb02.cbl\" at line number \"222\"\nBusiness Intent: Inserts a new customer's security details into the CUSTOMER_SECURE table.\nTechnical Action: Executes an SQL INSERT statement to insert data into the CUSTOMER_SECURE table, handles errors, and retrieves date and time information. Subsequently, links to another program ('LGSTSQ') with error message parameters.\nKeywords: COBOL, CICS, SQL, INSERT, CUSTOMER_SECURE, Error Handling, Link Program"}, {"fileName": "lgacdb02.cbl", "type": "PARAGRAPH", "name": "INSERT-CUSTOMER-PASSWORD", "content": "MOVE ' INSERT SECURITY' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO CUSTOMER_SECURE\r\n       ( customerNumber,\r\n       customerPass,\r\n       state_indicator,\r\n       pass_changes   )\r\n       VALUES ( :DB2-CUSTOMERNUM-INT,\r\n       :D2-CUSTSECR-PASS,\r\n       :D2-CUSTSECR-STATE,\r\n       :DB2-CUSTOMERCNT-INT)\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '98' TO D2-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n", "lineNumber": 268, "summary": "The below code segment is a \"PARAGRAPH\" named \"INSERT-CUSTOMER-PASSWORD\" which is in the file \"lgacdb02.cbl\" at line number \"268\"\nBusiness Intent: Insert a new customer record into the CUSTOMER_SECURE table with associated security details.\nTechnical Action: Executes an SQL INSERT statement to store customer information, handles errors with Error Handling, and returns control to the calling program.\nKeywords: CICS, COBOL, SQL, INSERT, CUSTOMER_SECURE, Error Handling"}, {"fileName": "lgacdb02.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "MOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 299, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgacdb02.cbl\" at line number \"299\"\nBusiness Intent: Retrieve the current time and process a request to an external program, LGSTSQ.\nTechnical Action: Executes CICS commands to ask for the current time, formats it into MMDDYYYY and TIME format, and then links to another program using COMMAREA. If there is error information available (EIBCALEN > 0), extracts relevant data and sends an error message to LGSTSQ.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK PROGRAM, COMMAREA, Error Handling"}, {"fileName": "lgapdb01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n EXEC SQL\r INCLUDE LGCMAREA\r END-EXEC.", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgapdb01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: "}, {"fileName": "lgapdb01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgapdb01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGAPDB01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  ABS-TIME                    PIC S9(8) COMP VALUE +0.\n\n 01  TIME1                       PIC X(8)  VALUE SPACES.\n\n 01  DATE1                       PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGAPDB01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(6)  VALUE ' PNUM='.\n     05 EM-POLNUM              PIC X(10)  VALUE SPACES.\n     05 EM-SQLREQ              PIC X(16) VALUE SPACES.\n     05 FILLER                 PIC X(9)  VALUE ' SQLCODE='.\n     05 EM-SQLRC               PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADER-LEN         PIC S9(4) COMP VALUE +28.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4)      VALUE +0.\n\n 01 WS-VARY-FIELD.\n   49 WS-VARY-LEN               PIC S9(4) COMP.\n   49 WS-VARY-CHAR              PIC X(3900).\n\n 01 DB2-IN-INTEGERS.\n   03 DB2-CUSTOMERNUM-INT      PIC S9(9) COMP.\n   03 DB2-BROKERID-INT         PIC S9(9) COMP.\n   03 DB2-PAYMENT-INT          PIC S9(9) COMP.\n   03 DB2-E-TERM-SINT          PIC S9(4) COMP.\n   03 DB2-E-SUMASSURED-INT     PIC S9(9) COMP.\n   03 DB2-E-PADDING-LEN        PIC S9(9) COMP.\n   03 DB2-H-BEDROOMS-SINT      PIC S9(4) COMP.\n   03 DB2-H-VALUE-INT          PIC S9(9) COMP.\n   03 DB2-M-VALUE-INT          PIC S9(9) COMP.\n   03 DB2-M-CC-SINT            PIC S9(4) COMP.\n   03 DB2-M-PREMIUM-int        PIC S9(9) COMP.\n   03 DB2-M-ACCIDENTS-int      PIC S9(9) COMP.\n   03 DB2-B-FirePeril-Int      PIC S9(4) COMP.\n   03 DB2-B-FirePremium-Int    PIC S9(9) COMP.\n   03 DB2-B-CrimePeril-Int     PIC S9(4) COMP.\n   03 DB2-B-CrimePremium-Int   PIC S9(9) COMP.\n   03 DB2-B-FloodPeril-Int     PIC S9(4) COMP.\n   03 DB2-B-FloodPremium-Int   PIC S9(9) COMP.\n   03 DB2-B-WeatherPeril-Int   PIC S9(4) COMP.\n   03 DB2-B-WeatherPremium-Int PIC S9(9) COMP.\n   03 DB2-B-Status-Int         PIC S9(4) COMP.\n   03 DB2-C-Policynum-Int      PIC S9(9) COMP.\n   03 DB2-C-Num-INT            PIC S9(9) COMP Value +0.\n   03 DB2-C-Paid-INT           PIC S9(9) COMP.\n   03 DB2-C-Value-INT          PIC S9(9) COMP.\n\n 01 DB2-OUT-INTEGERS.\n   03 DB2-POLICYNUM-INT        PIC S9(9) COMP VALUE +0.\n\n 01  LGAPVS01                    PIC X(8)  VALUE 'LGAPVS01'.\n\n 01  DFHCOMMAREA.\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgapdb01.cbl\" in the file \"lgapdb01.cbl\"\nStructure: Data Layout for lgapdb01.cbl\nDescription: Legacy COBOL data structure analysis\nFields: WS-EYECATCHER, WS-TRANSID, WS-TERMID, WS-TASKNUM, ABS-TIME, ERROR-MSG, DB2-CUSTOMERNUM-INT, DB2-POLICYNUM-INT"}, {"fileName": "lgapdb01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\nMOVE CA-BROKERID TO DB2-BROKERID-INT\nMOVE CA-PAYMENT TO DB2-PAYMENT-INT\nMOVE ' INSERT POLICY' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO POLICY\r\n       ( POLICYNUMBER,\r\n       CUSTOMERNUMBER,\r\n       ISSUEDATE,\r\n       EXPIRYDATE,\r\n       POLICYTYPE,\r\n       LASTCHANGED,\r\n       BROKERID,\r\n       BROKERSREFERENCE,\r\n       PAYMENT           )\r\n       VALUES ( DEFAULT,\r\n       :DB2-CUSTOMERNUM-INT,\r\n       :CA-ISSUE-DATE,\r\n       :CA-EXPIRY-DATE,\r\n       :DB2-POLICYTYPE,\r\n       CURRENT TIMESTAMP,\r\n       :DB2-BROKERID-INT,\r\n       :CA-BROKERSREF,\r\n       :DB2-PAYMENT-INT      )\r\n       END-EXEC\nEvaluate SQLCODE\r\n       \r\n             When 0\r\n               MOVE '00' TO CA-RETURN-CODE\r\n       \r\n             When -530\r\n               MOVE '70' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n       \r\n             When Other\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n       \r\n           END-Evaluate\nEXEC SQL\r\n       SET :DB2-POLICYNUM-INT = IDENTITY_VAL_LOCAL()\r\n       END-EXEC\nMOVE DB2-POLICYNUM-INT TO CA-POLICY-NUM\nMOVE CA-POLICY-NUM TO EM-POLNUM\nEXEC SQL\r\n       SELECT LASTCHANGED\r\n       INTO :CA-LASTCHANGED\r\n       FROM POLICY\r\n       WHERE POLICYNUMBER = :DB2-POLICYNUM-INT\r\n       END-EXEC\nEXIT\n\nMOVE CA-E-TERM        TO DB2-E-TERM-SINT\nMOVE CA-E-SUM-ASSURED TO DB2-E-SUMASSURED-INT\nMOVE ' INSERT ENDOW ' TO EM-SQLREQ\nSUBTRACT WS-REQUIRED-CA-LEN FROM EIBCALEN\r\n               GIVING WS-VARY-LEN\nIF WS-VARY-LEN IS GREATER THAN ZERO\r\n      *>        Commarea contains data for Varchar field\r\n              MOVE CA-E-PADDING-DATA\r\n                  TO WS-VARY-CHAR(1:WS-VARY-LEN)\r\n       EXEC SQL\r\n       INSERT INTO ENDOWMENT\r\n       ( POLICYNUMBER,\r\n       WITHPROFITS,\r\n       EQUITIES,\r\n       MANAGEDFUND,\r\n       FUNDNAME,\r\n       TERM,\r\n       SUMASSURED,\r\n       LIFEASSURED,\r\n       PADDINGDATA    )\r\n       VALUES ( :DB2-POLICYNUM-INT,\r\n       :CA-E-WITH-PROFITS,\r\n       :CA-E-EQUITIES,\r\n       :CA-E-MANAGED-FUND,\r\n       :CA-E-FUND-NAME,\r\n       :DB2-E-TERM-SINT,\r\n       :DB2-E-SUMASSURED-INT,\r\n       :CA-E-LIFE-ASSURED,\r\n       :WS-VARY-FIELD )\r\n       END-EXEC\r\n           ELSE\r\n       EXEC SQL\r\n       INSERT INTO ENDOWMENT\r\n       ( POLICYNUMBER,\r\n       WITHPROFITS,\r\n       EQUITIES,\r\n       MANAGEDFUND,\r\n       FUNDNAME,\r\n       TERM,\r\n       SUMASSURED,\r\n       LIFEASSURED    )\r\n       VALUES ( :DB2-POLICYNUM-INT,\r\n       :CA-E-WITH-PROFITS,\r\n       :CA-E-EQUITIES,\r\n       :CA-E-MANAGED-FUND,\r\n       :CA-E-FUND-NAME,\r\n       :DB2-E-TERM-SINT,\r\n       :DB2-E-SUMASSURED-INT,\r\n       :CA-E-LIFE-ASSURED )\r\n       END-EXEC\r\n           END-IF\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '90' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n      *>       Issue Abend to cause backout of update to Policy table\r\n       EXEC CICS ABEND ABCODE('LGSQ') NODUMP END-EXEC\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n\nMOVE CA-H-VALUE       TO DB2-H-VALUE-INT\nMOVE CA-H-BEDROOMS    TO DB2-H-BEDROOMS-SINT\nMOVE ' INSERT HOUSE ' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO HOUSE\r\n       ( POLICYNUMBER,\r\n       PROPERTYTYPE,\r\n       BEDROOMS,\r\n       VALUE,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE          )\r\n       VALUES ( :DB2-POLICYNUM-INT,\r\n       :CA-H-PROPERTY-TYPE,\r\n       :DB2-H-BEDROOMS-SINT,\r\n       :DB2-H-VALUE-INT,\r\n       :CA-H-HOUSE-NAME,\r\n       :CA-H-HOUSE-NUMBER,\r\n       :CA-H-POSTCODE      )\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '90' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n      *>       Issue Abend to cause backout of update to Policy table\r\n       EXEC CICS ABEND ABCODE('LGSQ') NODUMP END-EXEC\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n\nMOVE CA-M-VALUE       TO DB2-M-VALUE-INT\nMOVE CA-M-CC          TO DB2-M-CC-SINT\nMOVE CA-M-PREMIUM     TO DB2-M-PREMIUM-INT\nMOVE CA-M-ACCIDENTS   TO DB2-M-ACCIDENTS-INT\nMOVE ' INSERT MOTOR ' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO MOTOR\r\n       ( POLICYNUMBER,\r\n       MAKE,\r\n       MODEL,\r\n       VALUE,\r\n       REGNUMBER,\r\n       COLOUR,\r\n       CC,\r\n       YEAROFMANUFACTURE,\r\n       PREMIUM,\r\n       ACCIDENTS )\r\n       VALUES ( :DB2-POLICYNUM-INT,\r\n       :CA-M-MAKE,\r\n       :CA-M-MODEL,\r\n       :DB2-M-VALUE-INT,\r\n       :CA-M-REGNUMBER,\r\n       :CA-M-COLOUR,\r\n       :DB2-M-CC-SINT,\r\n       :CA-M-MANUFACTURED,\r\n       :DB2-M-PREMIUM-INT,\r\n       :DB2-M-ACCIDENTS-INT )\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '90' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n      *>       Issue Abend to cause backout of update to Policy table\r\n       EXEC CICS ABEND ABCODE('LGSQ') NODUMP END-EXEC\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n\nMOVE CA-B-FirePeril       To DB2-B-FirePeril-Int\nMOVE CA-B-FirePremium     To DB2-B-FirePremium-Int\nMOVE CA-B-CrimePeril      To DB2-B-CrimePeril-Int\nMOVE CA-B-CrimePremium    To DB2-B-CrimePremium-Int\nMOVE CA-B-FloodPeril      To DB2-B-FloodPeril-Int\nMOVE CA-B-FloodPremium    To DB2-B-FloodPremium-Int\nMOVE CA-B-WeatherPeril    To DB2-B-WeatherPeril-Int\nMOVE CA-B-WeatherPremium  To DB2-B-WeatherPremium-Int\nMOVE CA-B-Status          To DB2-B-Status-Int\nMOVE ' INSERT COMMER' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO COMMERCIAL\r\n       (\r\n       PolicyNumber,\r\n       RequestDate,\r\n       StartDate,\r\n       RenewalDate,\r\n       Address,\r\n       Zipcode,\r\n       LatitudeN,\r\n       LongitudeW,\r\n       Customer,\r\n       PropertyType,\r\n       FirePeril,\r\n       FirePremium,\r\n       CrimePeril,\r\n       CrimePremium,\r\n       FloodPeril,\r\n       FloodPremium,\r\n       WeatherPeril,\r\n       WeatherPremium,\r\n       Status,\r\n       RejectionReason\r\n       )\r\n       VALUES (\r\n       :DB2-POLICYNUM-INT,\r\n       :CA-LASTCHANGED,\r\n       :CA-ISSUE-DATE,\r\n       :CA-EXPIRY-DATE,\r\n       :CA-B-Address,\r\n       :CA-B-Postcode,\r\n       :CA-B-Latitude,\r\n       :CA-B-Longitude,\r\n       :CA-B-Customer,\r\n       :CA-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :CA-B-RejectReason\r\n       )\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '90' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n      *>       Issue Abend to cause backout of update to Policy table\r\n       EXEC CICS ABEND ABCODE('LGSQ') NODUMP END-EXEC\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n\nMOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(ABS-TIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(ABS-TIME)\r\n       MMDDYYYY(DATE1)\r\n       TIME(TIME1)\r\n       END-EXEC\nMOVE DATE1 TO EM-DATE\nMOVE TIME1 TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 146, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgapdb01.cbl\" at line number \"146\"\nBusiness Intent: mainframe_modernization\nTechnical Action: insert_data_into_multiple_tables\nKeywords: COBOL, Mainframe, DB2, INSERT, COMMERCE"}, {"fileName": "lgapdb01.cbl", "type": "PARAGRAPH", "name": "INSERT-POLICY", "content": "MOVE CA-BROKERID TO DB2-BROKERID-INT\nMOVE CA-PAYMENT TO DB2-PAYMENT-INT\nMOVE ' INSERT POLICY' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO POLICY\r\n       ( POLICYNUMBER,\r\n       CUSTOMERNUMBER,\r\n       ISSUEDATE,\r\n       EXPIRYDATE,\r\n       POLICYTYPE,\r\n       LASTCHANGED,\r\n       BROKERID,\r\n       BROKERSREFERENCE,\r\n       PAYMENT           )\r\n       VALUES ( DEFAULT,\r\n       :DB2-CUSTOMERNUM-INT,\r\n       :CA-ISSUE-DATE,\r\n       :CA-EXPIRY-DATE,\r\n       :DB2-POLICYTYPE,\r\n       CURRENT TIMESTAMP,\r\n       :DB2-BROKERID-INT,\r\n       :CA-BROKERSREF,\r\n       :DB2-PAYMENT-INT      )\r\n       END-EXEC\nEvaluate SQLCODE\r\n       \r\n             When 0\r\n               MOVE '00' TO CA-RETURN-CODE\r\n       \r\n             When -530\r\n               MOVE '70' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n       \r\n             When Other\r\n               MOVE '90' TO CA-RETURN-CODE\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n       EXEC CICS RETURN END-EXEC\r\n       \r\n           END-Evaluate\nEXEC SQL\r\n       SET :DB2-POLICYNUM-INT = IDENTITY_VAL_LOCAL()\r\n       END-EXEC\nMOVE DB2-POLICYNUM-INT TO CA-POLICY-NUM\nMOVE CA-POLICY-NUM TO EM-POLNUM\nEXEC SQL\r\n       SELECT LASTCHANGED\r\n       INTO :CA-LASTCHANGED\r\n       FROM POLICY\r\n       WHERE POLICYNUMBER = :DB2-POLICYNUM-INT\r\n       END-EXEC\nEXIT\n", "lineNumber": 261, "summary": "The below code segment is a \"PARAGRAPH\" named \"INSERT-POLICY\" which is in the file \"lgapdb01.cbl\" at line number \"261\"\nBusiness Intent: Inserts a new policy into the database and retrieves its updated policy number.\nTechnical Action: Executes SQL INSERT statement to insert a policy record, handles potential errors with error handling logic, sets an identity value for the inserted policy number, and selects the last changed timestamp for the inserted policy.\nKeywords: CICS, COBOL, DB2, SQL, INSERT, POLICY, IDENTITY_VAL_LOCAL, ERROR HANDLING"}, {"fileName": "lgapdb01.cbl", "type": "PARAGRAPH", "name": "INSERT-ENDOW", "content": "MOVE CA-E-TERM        TO DB2-E-TERM-SINT\nMOVE CA-E-SUM-ASSURED TO DB2-E-SUMASSURED-INT\nMOVE ' INSERT ENDOW ' TO EM-SQLREQ\nSUBTRACT WS-REQUIRED-CA-LEN FROM EIBCALEN\r\n               GIVING WS-VARY-LEN\nIF WS-VARY-LEN IS GREATER THAN ZERO\r\n      *>        Commarea contains data for Varchar field\r\n              MOVE CA-E-PADDING-DATA\r\n                  TO WS-VARY-CHAR(1:WS-VARY-LEN)\r\n       EXEC SQL\r\n       INSERT INTO ENDOWMENT\r\n       ( POLICYNUMBER,\r\n       WITHPROFITS,\r\n       EQUITIES,\r\n       MANAGEDFUND,\r\n       FUNDNAME,\r\n       TERM,\r\n       SUMASSURED,\r\n       LIFEASSURED,\r\n       PADDINGDATA    )\r\n       VALUES ( :DB2-POLICYNUM-INT,\r\n       :CA-E-WITH-PROFITS,\r\n       :CA-E-EQUITIES,\r\n       :CA-E-MANAGED-FUND,\r\n       :CA-E-FUND-NAME,\r\n       :DB2-E-TERM-SINT,\r\n       :DB2-E-SUMASSURED-INT,\r\n       :CA-E-LIFE-ASSURED,\r\n       :WS-VARY-FIELD )\r\n       END-EXEC\r\n           ELSE\r\n       EXEC SQL\r\n       INSERT INTO ENDOWMENT\r\n       ( POLICYNUMBER,\r\n       WITHPROFITS,\r\n       EQUITIES,\r\n       MANAGEDFUND,\r\n       FUNDNAME,\r\n       TERM,\r\n       SUMASSURED,\r\n       LIFEASSURED    )\r\n       VALUES ( :DB2-POLICYNUM-INT,\r\n       :CA-E-WITH-PROFITS,\r\n       :CA-E-EQUITIES,\r\n       :CA-E-MANAGED-FUND,\r\n       :CA-E-FUND-NAME,\r\n       :DB2-E-TERM-SINT,\r\n       :DB2-E-SUMASSURED-INT,\r\n       :CA-E-LIFE-ASSURED )\r\n       END-EXEC\r\n           END-IF\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '90' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n      *>       Issue Abend to cause backout of update to Policy table\r\n       EXEC CICS ABEND ABCODE('LGSQ') NODUMP END-EXEC\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n", "lineNumber": 327, "summary": "The below code segment is a \"PARAGRAPH\" named \"INSERT-ENDOW\" which is in the file \"lgapdb01.cbl\" at line number \"327\"\nBusiness Intent: Insert new records into the ENDOWMENT table based on policy data from CA-E-TERM and related variables.\nTechnical Action: Executes SQL INSERT statement to insert data into the ENDOWMENT table using CICS commands\nKeywords: CICS, COBOL, DB2, SQL, INSERT, ENDOWMENT, POLICYNUMBER, WITHPROFITS, EQUITIES, MANAGEDFUND, FUNDNAME, TERM, SUMASSURED, LIFEASSURED, PADDINGDATA"}, {"fileName": "lgapdb01.cbl", "type": "PARAGRAPH", "name": "INSERT-HOUSE", "content": "MOVE CA-H-VALUE       TO DB2-H-VALUE-INT\nMOVE CA-H-BEDROOMS    TO DB2-H-BEDROOMS-SINT\nMOVE ' INSERT HOUSE ' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO HOUSE\r\n       ( POLICYNUMBER,\r\n       PROPERTYTYPE,\r\n       BEDROOMS,\r\n       VALUE,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE          )\r\n       VALUES ( :DB2-POLICYNUM-INT,\r\n       :CA-H-PROPERTY-TYPE,\r\n       :DB2-H-BEDROOMS-SINT,\r\n       :DB2-H-VALUE-INT,\r\n       :CA-H-HOUSE-NAME,\r\n       :CA-H-HOUSE-NUMBER,\r\n       :CA-H-POSTCODE      )\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '90' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n      *>       Issue Abend to cause backout of update to Policy table\r\n       EXEC CICS ABEND ABCODE('LGSQ') NODUMP END-EXEC\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n", "lineNumber": 402, "summary": "The below code segment is a \"PARAGRAPH\" named \"INSERT-HOUSE\" which is in the file \"lgapdb01.cbl\" at line number \"402\"\nBusiness Intent: Insert a new house record into the HOUSE table\nTechnical Action: Executes an SQL INSERT statement with variables from COBOL program, handles errors and returns code if unsuccessful\nKeywords: COBOL, CICS, DB2, SQL, House Insert, Error Handling, ABEND"}, {"fileName": "lgapdb01.cbl", "type": "PARAGRAPH", "name": "INSERT-MOTOR", "content": "MOVE CA-M-VALUE       TO DB2-M-VALUE-INT\nMOVE CA-M-CC          TO DB2-M-CC-SINT\nMOVE CA-M-PREMIUM     TO DB2-M-PREMIUM-INT\nMOVE CA-M-ACCIDENTS   TO DB2-M-ACCIDENTS-INT\nMOVE ' INSERT MOTOR ' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO MOTOR\r\n       ( POLICYNUMBER,\r\n       MAKE,\r\n       MODEL,\r\n       VALUE,\r\n       REGNUMBER,\r\n       COLOUR,\r\n       CC,\r\n       YEAROFMANUFACTURE,\r\n       PREMIUM,\r\n       ACCIDENTS )\r\n       VALUES ( :DB2-POLICYNUM-INT,\r\n       :CA-M-MAKE,\r\n       :CA-M-MODEL,\r\n       :DB2-M-VALUE-INT,\r\n       :CA-M-REGNUMBER,\r\n       :CA-M-COLOUR,\r\n       :DB2-M-CC-SINT,\r\n       :CA-M-MANUFACTURED,\r\n       :DB2-M-PREMIUM-INT,\r\n       :DB2-M-ACCIDENTS-INT )\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '90' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n      *>       Issue Abend to cause backout of update to Policy table\r\n       EXEC CICS ABEND ABCODE('LGSQ') NODUMP END-EXEC\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n", "lineNumber": 440, "summary": "The below code segment is a \"PARAGRAPH\" named \"INSERT-MOTOR\" which is in the file \"lgapdb01.cbl\" at line number \"440\"\nBusiness Intent: Insert motor information into a database\nTechnical Action: Execute an SQL INSERT statement to populate the MOTOR table with policy-related data, and handle potential errors\nKeywords: COBOL, CICS, SQL, INSERT, MOTOR, POLICYNUMBER, MAKE, MODEL, REGNUMBER, COLOUR, CC, YEAROFMANUFACTURE, PREMIUM, ACCIDENTS"}, {"fileName": "lgapdb01.cbl", "type": "PARAGRAPH", "name": "INSERT-COMMERCIAL", "content": "MOVE CA-B-FirePeril       To DB2-B-FirePeril-Int\nMOVE CA-B-FirePremium     To DB2-B-FirePremium-Int\nMOVE CA-B-CrimePeril      To DB2-B-CrimePeril-Int\nMOVE CA-B-CrimePremium    To DB2-B-CrimePremium-Int\nMOVE CA-B-FloodPeril      To DB2-B-FloodPeril-Int\nMOVE CA-B-FloodPremium    To DB2-B-FloodPremium-Int\nMOVE CA-B-WeatherPeril    To DB2-B-WeatherPeril-Int\nMOVE CA-B-WeatherPremium  To DB2-B-WeatherPremium-Int\nMOVE CA-B-Status          To DB2-B-Status-Int\nMOVE ' INSERT COMMER' TO EM-SQLREQ\nEXEC SQL\r\n       INSERT INTO COMMERCIAL\r\n       (\r\n       PolicyNumber,\r\n       RequestDate,\r\n       StartDate,\r\n       RenewalDate,\r\n       Address,\r\n       Zipcode,\r\n       LatitudeN,\r\n       LongitudeW,\r\n       Customer,\r\n       PropertyType,\r\n       FirePeril,\r\n       FirePremium,\r\n       CrimePeril,\r\n       CrimePremium,\r\n       FloodPeril,\r\n       FloodPremium,\r\n       WeatherPeril,\r\n       WeatherPremium,\r\n       Status,\r\n       RejectionReason\r\n       )\r\n       VALUES (\r\n       :DB2-POLICYNUM-INT,\r\n       :CA-LASTCHANGED,\r\n       :CA-ISSUE-DATE,\r\n       :CA-EXPIRY-DATE,\r\n       :CA-B-Address,\r\n       :CA-B-Postcode,\r\n       :CA-B-Latitude,\r\n       :CA-B-Longitude,\r\n       :CA-B-Customer,\r\n       :CA-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :CA-B-RejectReason\r\n       )\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '90' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n      *>       Issue Abend to cause backout of update to Policy table\r\n       EXEC CICS ABEND ABCODE('LGSQ') NODUMP END-EXEC\r\n       EXEC CICS RETURN END-EXEC\r\n           END-IF\nEXIT\n", "lineNumber": 486, "summary": "The below code segment is a \"PARAGRAPH\" named \"INSERT-COMMERCIAL\" which is in the file \"lgapdb01.cbl\" at line number \"486\"\nBusiness Intent: Insert commercial policy data into a database, including fire peril, crime premium, flood peril, and weather premium\nTechnical Action: Executes an SQL INSERT statement to store commercial policy information in a database, performs error handling if the operation fails, and abends the program if necessary\nKeywords: CICS, COBOL, DB2, SQL, INSERT, COMMERCIAL, POLICYNUMBER, REQUESTDATE, STARTDATE, RENEWALDATE, ADDRESS, ZIPCODE, LATITUDE, LONGITUDE, CUSTOMER, PROPERTYPE, FIREPERIL, CRIMEPREMIUM, FLOODPERIL, WEATHERPREMIUM"}, {"fileName": "lgapdb01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "MOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(ABS-TIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(ABS-TIME)\r\n       MMDDYYYY(DATE1)\r\n       TIME(TIME1)\r\n       END-EXEC\nMOVE DATE1 TO EM-DATE\nMOVE TIME1 TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 562, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgapdb01.cbl\" at line number \"562\"\nBusiness Intent: Retrieve and format date/time information, handle errors, and initiate a linked program to perform additional processing.\nTechnical Action: Uses CICS commands (ASKTIME, FORMATTIME, LINK) and COBOL statements (MOVE, IF-THEN-ELSE) to execute the desired functionality.\nKeywords: CICS, COBOL, DATE/TIME, LINKED PROGRAM, ERROR HANDLING"}, {"fileName": "lgupvs01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgupvs01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: CA-REQUEST-ID, CA-CUSTOMER-NUMP, CA-RETURN-CODE"}, {"fileName": "lgupvs01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgupvs01.cbl", "content": " 01  WS-RESP                   PIC S9(8) COMP.\n\n 01  WS-RESP2                  PIC S9(8) COMP.\n\n 01  WS-Comm-Len               PIC S9(8) COMP.\n\n 01  WS-STARTCODE              PIC XX Value spaces.\n\n 01  WS-SYSID                  PIC X(4) Value spaces.\n\n 01  WS-Commarea-Len           PIC S9(4) COMP Value 64.\n\n 01  WS-Commarea-LenF          PIC S9(4) COMP Value 64.\n\n 01  WF-Policy-Info.\n   03  WF-Policy-Key.\n     05  WF-Request-ID           Pic X.\n     05  WF-Customer-Num         Pic X(10).\n     05  WF-Policy-Num           Pic X(10).\n   03 WF-Policy-Data             Pic X(43).\n   03 WF-C-Policy-Data Redefines WF-Policy-Data.\n     05  WF-B-Postcode           Pic X(8).\n     05  WF-B-Status             Pic 9(4).\n     05  WF-B-Customer           Pic X(31).\n   03 WF-E-Policy-Data Redefines WF-Policy-Data.\n     05  WF-E-WITH-PROFITS       Pic X.\n     05  WF-E-EQUITIES           Pic X.\n     05  WF-E-MANAGED-FUND       Pic X.\n     05  WF-E-FUND-NAME          Pic X(10).\n     05  WF-E-LIFE-ASSURED       Pic X(30).\n   03 WF-H-Policy-Data Redefines WF-Policy-Data.\n     05  WF-H-PROPERTY-TYPE      Pic X(15).\n     05  WF-H-BEDROOMS           Pic 999.\n     05  WF-H-VALUE              Pic 9(8).\n     05  WF-H-POSTCODE           Pic X(8).\n     05  WF-H-HOUSE-NAME         Pic X(9).\n   03 WF-M-Policy-Data Redefines WF-Policy-Data.\n     05  WF-M-MAKE               Pic X(15).\n     05  WF-M-MODEL              Pic X(15).\n     05  WF-M-VALUE              Pic 9(6).\n     05  WF-M-REGNUMBER          Pic X(7).\n\n 01  WS-FileIn                   Pic X(1024) value Spaces.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGUPVS01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' PNUM='.\n     05 EM-POLNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(20)\r\n                                        Value ' Re-write  KSDSPOLY '.\n     05 FILLER                 PIC X(6)  VALUE ' RESP='.\n     05 EM-RESPRC              PIC +9(5) USAGE DISPLAY.\n     05 FILLER                 PIC X(7)  VALUE ' RESP2='.\n     05 EM-RESP2RC             PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgupvs01.cbl\" in the file \"lgupvs01.cbl\"\nStructure: DATA LAYOUT FOR lgupvs01.cbl\nDescription: This is a COBOL data structure that appears to be related to insurance policies, customer information, and policy details.\nFields: WF-Policy-Key.Request-ID, WF-Customer-Num, WF-Policy-Num, CA-Request-ID, CA-Customers-NUM, CA-Policy-NUM, CA-ISSUE-DATE, CA-EXPIRY-DATE"}, {"fileName": "lgupvs01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\nGOBACK\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-Cusnum\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 200, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgupvs01.cbl\" at line number \"200\"\nBusiness Intent: Handles customer transactions by retrieving current timestamp, formatting date and time, and initiating a link to the LGSTSQ program.\nTechnical Action: Executes CICS commands (ASKTIME, FORMATTIME) for timestamp retrieval, performs data moves between variables, and initiates links (LINK PROGRAM) with error handling.\nKeywords: CICS, COBOL, timestamp, date, time, customer transactions, error handling, link program, LGSTSQ"}, {"fileName": "lgupvs01.cbl", "type": "PARAGRAPH", "name": "A-EXIT", "content": "EXIT\nGOBACK\n", "lineNumber": 273, "summary": "The below code segment is a \"PARAGRAPH\" named \"A-EXIT\" which is in the file \"lgupvs01.cbl\" at line number \"273\"\nBusiness Intent: Terminates program execution and returns control to the calling program.\nTechnical Action: Executes a logical exit from the program, which in turn executes a Go Back command to return control to the calling program.\nKeywords: COBOL, Exit, Go Back, Program Termination"}, {"fileName": "lgupvs01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nMove CA-Customer-Num To EM-Cusnum\nMove WS-RESP         To EM-RespRC\nMove WS-RESP2        To EM-Resp2RC\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(Length Of CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 277, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgupvs01.cbl\" at line number \"277\"\nBusiness Intent: Retrieve and format date and time information for customer inquiry processing.\nTechnical Action: Uses CICS ASKTIME and FORMATTIME commands to extract current date and time, handles errors through EIBCALEN checking, and links to LGSTSQ program for further processing.\nKeywords: CICS, COBOL, ASKTIME, FORMATTIME, DATE, TIME, LINK PROGRAM, ERROR HANDLING"}, {"fileName": "lgicus01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgicus01.cbl\"\nStructure: LINKAGE_SECTION\nDescription: \nFields: CA-REQUEST-ID, CA-CUSTOMER-NUM, CA-RETURN-CODE"}, {"fileName": "lgicus01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgicus01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGICUS01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  WS-ABSTIME                  PIC S9(8) COMP VALUE +0.\n\n 01  WS-TIME                     PIC X(8)  VALUE SPACES.\n\n 01  WS-DATE                     PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGICUS01'.\n   03 EM-VARIABLE              PIC X(21) VALUE SPACES.\n\n 01 CA-ERROR-MSG.\n   03 FILLER                PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA               PIC X(90) VALUE SPACES.\n\n 01 LGICDB01                  PIC X(8) Value 'LGICDB01'.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADERTRAILER-LEN  PIC S9(4) COMP VALUE +18.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4)      VALUE +0.\n\n 01  WS-POLICY-LENGTHS.\n   03 WS-CUSTOMER-LEN          PIC S9(4) COMP VALUE +72.\n   03 WS-POLICY-LEN            PIC S9(4) COMP VALUE +72.\n   03 WS-ENDOW-LEN             PIC S9(4) COMP VALUE +52.\n   03 WS-HOUSE-LEN             PIC S9(4) COMP VALUE +58.\n   03 WS-MOTOR-LEN             PIC S9(4) COMP VALUE +65.\n   03 WS-COMM-LEN              PIC S9(4) COMP VALUE +1102.\n   03 WS-CLAIM-LEN             PIC S9(4) COMP VALUE +546.\n   03 WS-FULL-ENDOW-LEN        PIC S9(4) COMP VALUE +124.\n   03 WS-FULL-HOUSE-LEN        PIC S9(4) COMP VALUE +130.\n   03 WS-FULL-MOTOR-LEN        PIC S9(4) COMP VALUE +137.\n   03 WS-FULL-COMM-LEN         PIC S9(4) COMP VALUE +1174.\n   03 WS-FULL-CLAIM-LEN        PIC S9(4) COMP VALUE +618.\n   03 WS-SUMRY-ENDOW-LEN       PIC S9(4) COMP VALUE +25.\n\n 01  DB2-CUSTOMER.\n   03 DB2-FIRSTNAME            PIC X(10).\n   03 DB2-LASTNAME             PIC X(20).\n   03 DB2-DATEOFBIRTH          PIC X(10).\n   03 DB2-HOUSENAME            PIC X(20).\n   03 DB2-HOUSENUMBER          PIC X(4).\n   03 DB2-POSTCODE             PIC X(8).\n   03 DB2-PHONE-MOBILE         PIC X(20).\n   03 DB2-PHONE-HOME           PIC X(20).\n   03 DB2-EMAIL-ADDRESS        PIC X(100).\n\n 01  DB2-POLICY.\n   03 DB2-POLICYTYPE           PIC X.\n   03 DB2-POLICYNUMBER         PIC 9(10).\n   03 DB2-POLICY-COMMON.\n     05 DB2-ISSUEDATE         PIC X(10).\n     05 DB2-EXPIRYDATE        PIC X(10).\n     05 DB2-LASTCHANGED       PIC X(26).\n     05 DB2-BROKERID          PIC 9(10).\n     05 DB2-BROKERSREF        PIC X(10).\n     05 DB2-PAYMENT           PIC 9(6).\n\n 01  DB2-ENDOWMENT.\n   03 DB2-ENDOW-FIXED.\n     05 DB2-E-WITHPROFITS      PIC X.\n     05 DB2-E-EQUITIES         PIC X.\n     05 DB2-E-MANAGEDFUND      PIC X.\n     05 DB2-E-FUNDNAME         PIC X(10).\n     05 DB2-E-TERM             PIC 9(2).\n     05 DB2-E-SUMASSURED       PIC 9(6).\n     05 DB2-E-LIFEASSURED      PIC X(31).\n   03 DB2-E-PADDINGDATA         PIC X(32611).\n\n 01  DB2-HOUSE.\n   03 DB2-H-PROPERTYTYPE       PIC X(15).\n   03 DB2-H-BEDROOMS           PIC 9(3).\n   03 DB2-H-VALUE              PIC 9(8).\n   03 DB2-H-HOUSENAME          PIC X(20).\n   03 DB2-H-HOUSENUMBER        PIC X(4).\n   03 DB2-H-POSTCODE           PIC X(8).\n\n 01  DB2-MOTOR.\n   03 DB2-M-MAKE               PIC X(15).\n   03 DB2-M-MODEL              PIC X(15).\n   03 DB2-M-VALUE              PIC 9(6).\n   03 DB2-M-REGNUMBER          PIC X(7).\n   03 DB2-M-COLOUR             PIC X(8).\n   03 DB2-M-CC                 PIC 9(4).\n   03 DB2-M-MANUFACTURED       PIC X(10).\n   03 DB2-M-PREMIUM            PIC 9(6).\n   03 DB2-M-ACCIDENTS          PIC 9(6).\n\n 01  DB2-COMMERCIAL.\n   03 DB2-B-Address            PIC X(255).\n   03 DB2-B-Postcode           PIC X(8).\n   03 DB2-B-Latitude           PIC X(11).\n   03 DB2-B-Longitude          PIC X(11).\n   03 DB2-B-Customer           PIC X(255).\n   03 DB2-B-PropType           PIC X(255).\n   03 DB2-B-FirePeril          PIC 9(4).\n   03 DB2-B-FirePremium        PIC 9(8).\n   03 DB2-B-CrimePeril         PIC 9(4).\n   03 DB2-B-CrimePremium       PIC 9(8).\n   03 DB2-B-FloodPeril         PIC 9(4).\n   03 DB2-B-FloodPremium       PIC 9(8).\n   03 DB2-B-WeatherPeril       PIC 9(4).\n   03 DB2-B-WeatherPremium     PIC 9(8).\n   03 DB2-B-Status             PIC 9(4).\n   03 DB2-B-RejectReason       PIC X(255).\n\n 01  DB2-CLAIM.\n   03 DB2-C-Num                PIC 9(10).\n   03 DB2-C-Date               PIC X(10).\n   03 DB2-C-Paid               PIC 9(8).\n   03 DB2-C-Value              PIC 9(8).\n   03 DB2-C-Cause              PIC X(255).\n   03 DB2-C-Observations       PIC X(255).\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgicus01.cbl\" in the file \"lgicus01.cbl\"\nStructure: WS-HEADER\nDescription: Header structure containing eye catcher, transaction ID, terminal ID, task number, filler, and address of the data area.\nFields: WS-EYECATCHER, WS-TRANSID, WS-TERMID, WS-TASKNUM, WS-ADDR-DFHCOMMAREA"}, {"fileName": "lgicus01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXEC CICS RETURN END-EXEC\n\nEXIT\n\nEXEC CICS LINK Program(LGICDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n\nEXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 287, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgicus01.cbl\" at line number \"287\"\nBusiness Intent: Retrieve and display date and time information from a database\nTechnical Action: CICS transactions: ASKTIME, FORMATTIME, LINK, RETURN\nKeywords: CICS, COBOL, database, date, time, LINK, RETURN, ASKTIME, FORMATTIME"}, {"fileName": "lgicus01.cbl", "type": "PARAGRAPH", "name": "MAINLINE-END", "content": "EXEC CICS RETURN END-EXEC\n", "lineNumber": 324, "summary": "The below code segment is a \"PARAGRAPH\" named \"MAINLINE-END\" which is in the file \"lgicus01.cbl\" at line number \"324\"\nBusiness Intent: Return control to the calling program\nTechnical Action: Issue a CICS return command\nKeywords: CICS, return, command"}, {"fileName": "lgicus01.cbl", "type": "PARAGRAPH", "name": "GET-CUSTOMER-INFO", "content": "EXEC CICS LINK Program(LGICDB01)\r\n       Commarea(DFHCOMMAREA)\r\n       LENGTH(32500)\r\n       END-EXEC\nEXIT\n", "lineNumber": 330, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-CUSTOMER-INFO\" which is in the file \"lgicus01.cbl\" at line number \"330\"\nBusiness Intent: Invoke an external program or service from a COBOL application using CICS Link\nTechnical Action: Executes the LINK command with parameters, transferring control to the linked program and utilizing a shared memory area\nKeywords: CICS Link, COBOL Application, External Program, Shared Memory Area, Error Handling"}, {"fileName": "lgicus01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(WS-ABSTIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(WS-ABSTIME)\r\n       MMDDYYYY(WS-DATE)\r\n       TIME(WS-TIME)\r\n       END-EXEC\nMOVE WS-DATE TO EM-DATE\nMOVE WS-TIME TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 345, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgicus01.cbl\" at line number \"345\"\nBusiness Intent: Retrieve and format the current date and time for subsequent processing.\nTechnical Action: The program uses CICS commands ASKTIME, FORMATTIME to retrieve the current date and time, and then performs error handling through LINK PROGRAM commands. Error handling involves checking the length of COMMAREA and executing specific logic based on its value.\nKeywords: CICS, ASKTIME, FORMATTIME, LINK, PROGRAM, COMMAREA, ERROR-MSG, DATE, TIME, EIBCALEN, DFHCOMMAREA, CA-DATA, LGSTSQ"}, {"fileName": "lgipdb01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n EXEC SQL\r INCLUDE LGCMAREA\r END-EXEC.\r\n       \r\n       \n01ICOM-RecordPicX(1202).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgipdb01.cbl\"\nStructure: LINKAGE SECTION\nDescription: Analysis of the provided COBOL data structure\nFields: ICOM-RecordPicX"}, {"fileName": "lgipdb01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgipdb01.cbl", "content": " 01 TSAREA.\n   03  TSAREAPOSTCODE           Pic X(8).\n   03  Filler                   Pic X Value Spaces.\n   03  TSAREACUSTNUM            Pic 9(10).\n   03  Filler                   Pic X Value Spaces.\n   03  TSAREAPOLNUM             Pic 9(10).\n   03  Filler                   Pic X Value Spaces.\n\n 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGIPDB01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  ABS-TIME                    PIC S9(8) COMP VALUE +0.\n\n 01  TIME1                       PIC X(8)  VALUE SPACES.\n\n 01  DATE1                       PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGIPDB01'.\n   03 EM-VARIABLE.\n     05 FILLER                 PIC X(6)  VALUE ' CNUM='.\n     05 EM-CUSNUM              PIC X(10)  VALUE SPACES.\n     05 FILLER                 PIC X(6)  VALUE ' PNUM='.\n     05 EM-POLNUM              PIC X(10)  VALUE SPACES.\n     05 EM-SQLREQ              PIC X(16) VALUE SPACES.\n     05 FILLER                 PIC X(9)  VALUE ' SQLCODE='.\n     05 EM-SQLRC               PIC +9(5) USAGE DISPLAY.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01 MINUS-ONE                    PIC S9(4) COMP VALUE -1.\n\n 01  WS-COMMAREA-LENGTHS.\n   03 WS-CA-HEADERTRAILER-LEN  PIC S9(4) COMP VALUE +33.\n   03 WS-REQUIRED-CA-LEN       PIC S9(4)      VALUE +0.\n\n 01  END-POLICY-POS              PIC S9(4) COMP VALUE +1.\n\n 01  ICOM-Record-Count           PIC S9(4) COMP.\n\n 01  WS-Request-ID               Pic X(6).\n\n 01 DB2-IN-INTEGERS.\n   03 DB2-CUSTOMERNUM-INT      PIC S9(9) COMP VALUE +0.\n   03 DB2-POLICYNUM-INT        PIC S9(9) COMP VALUE +0.\n   03 DB2-CLAIMNUM-INT         PIC S9(9) COMP VALUE +0.\n\n 01 DB2-OUT-INTEGERS.\n   03 DB2-BROKERID-INT         PIC S9(9) COMP.\n   03 DB2-PAYMENT-INT          PIC S9(9) COMP.\n   03 DB2-E-TERM-SINT          PIC S9(4) COMP.\n   03 DB2-E-SUMASSURED-INT     PIC S9(9) COMP.\n   03 DB2-E-PADDING-LEN        PIC S9(9) COMP.\n   03 DB2-H-BEDROOMS-SINT      PIC S9(4) COMP.\n   03 DB2-H-VALUE-INT          PIC S9(9) COMP.\n   03 DB2-M-VALUE-INT          PIC S9(9) COMP.\n   03 DB2-M-CC-SINT            PIC S9(4) COMP.\n   03 DB2-M-PREMIUM-INT        PIC S9(9) COMP.\n   03 DB2-M-ACCIDENTS-INT      PIC S9(9) COMP.\n   03 DB2-B-FirePeril-Int      PIC S9(4) COMP.\n   03 DB2-B-FirePremium-Int    PIC S9(9) COMP.\n   03 DB2-B-CrimePeril-Int     PIC S9(4) COMP.\n   03 DB2-B-CrimePremium-Int   PIC S9(9) COMP.\n   03 DB2-B-FloodPeril-Int     PIC S9(4) COMP.\n   03 DB2-B-FloodPremium-Int   PIC S9(9) COMP.\n   03 DB2-B-WeatherPeril-Int   PIC S9(4) COMP.\n   03 DB2-B-WeatherPremium-Int PIC S9(9) COMP.\n   03 DB2-B-Status-Int         PIC S9(4) COMP.\n   03 DB2-C-Paid-int           PIC S9(9) COMP.\n   03 DB2-C-Value-int          PIC S9(9) COMP.\n\n 01  DFHCOMMAREA.\n\n 01  ICOM-Record                 Pic X(1202).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgipdb01.cbl\" in the file \"lgipdb01.cbl\"\nStructure: DATA LAYOUT FOR lgipdb01.cbl\nDescription: Analysis of a COBOL data structure representing various business entities and key fields.\nFields: TSAREAPOSTCODE, TSAREACUSTNUM, TSAREAPOLNUM, WS-EYECATCHER, WS-TRANSID, WS-TASKNUM, DB2-CUSTOMERNUM-INT, DB2-POLICYNUM-INT, DB2-CLAIMNUM-INT"}, {"fileName": "lgipdb01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXEC CICS RETURN END-EXEC\n\nEXIT\n\nMOVE ' SELECT ENDOW ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT  ISSUEDATE,\r\n       EXPIRYDATE,\r\n       LASTCHANGED,\r\n       BROKERID,\r\n       BROKERSREFERENCE,\r\n       PAYMENT,\r\n       WITHPROFITS,\r\n       EQUITIES,\r\n       MANAGEDFUND,\r\n       FUNDNAME,\r\n       TERM,\r\n       SUMASSURED,\r\n       LIFEASSURED,\r\n       PADDINGDATA,\r\n       LENGTH(PADDINGDATA)\r\n       INTO  :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-BROKERID-INT INDICATOR :IND-BROKERID,\r\n       :DB2-BROKERSREF INDICATOR :IND-BROKERSREF,\r\n       :DB2-PAYMENT-INT INDICATOR :IND-PAYMENT,\r\n       :DB2-E-WITHPROFITS,\r\n       :DB2-E-EQUITIES,\r\n       :DB2-E-MANAGEDFUND,\r\n       :DB2-E-FUNDNAME,\r\n       :DB2-E-TERM-SINT,\r\n       :DB2-E-SUMASSURED-INT,\r\n       :DB2-E-LIFEASSURED,\r\n       :DB2-E-PADDINGDATA INDICATOR :IND-E-PADDINGDATA,\r\n       :DB2-E-PADDING-LEN INDICATOR :IND-E-PADDINGDATAL\r\n       FROM  POLICY,ENDOWMENT\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       ENDOWMENT.POLICYNUMBER   AND\r\n       POLICY.CUSTOMERNUMBER =\r\n       :DB2-CUSTOMERNUM-INT             AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-ENDOW-LEN       TO WS-REQUIRED-CA-LEN\r\n       \r\n      *> ----------------------------------------------------------------*\r\n      *>       Specific code to allow for length of VACHAR data\r\n      *>       check whether PADDINGDATA field is non-null\r\n      *>         and calculate length of endowment policy\r\n      *>         and position of free space in commarea after policy data\r\n      *> ----------------------------------------------------------------*\r\n             IF IND-E-PADDINGDATAL NOT EQUAL MINUS-ONE\r\n               ADD DB2-E-PADDING-LEN TO WS-REQUIRED-CA-LEN\r\n               ADD DB2-E-PADDING-LEN TO END-POLICY-POS\r\n             END-IF\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n      *>         Length is sufficent so move data to commarea\r\n      *>         Move Integer fields to required length numerics\r\n      *>         Don't move null fields\r\n               IF IND-BROKERID NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-BROKERID-INT    TO DB2-BROKERID\r\n               END-IF\r\n               IF IND-PAYMENT NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-PAYMENT-INT TO DB2-PAYMENT\r\n               END-IF\r\n      *> ----------------------------------------------------------------*\r\n               MOVE DB2-E-TERM-SINT       TO DB2-E-TERM\r\n               MOVE DB2-E-SUMASSURED-INT  TO DB2-E-SUMASSURED\r\n       \r\n               MOVE DB2-POLICY-COMMON     TO CA-POLICY-COMMON\r\n               MOVE DB2-ENDOW-FIXED\r\n                   TO CA-ENDOWMENT(1:WS-ENDOW-LEN)\r\n               IF IND-E-PADDINGDATA NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-E-PADDINGDATA TO\r\n                     CA-E-PADDING-DATA(1:DB2-E-PADDING-LEN)\r\n               END-IF\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-E-PADDING-DATA(END-POLICY-POS:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n       \r\n           END-IF\nEXIT\n\nMOVE ' SELECT HOUSE ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT  ISSUEDATE,\r\n       EXPIRYDATE,\r\n       LASTCHANGED,\r\n       BROKERID,\r\n       BROKERSREFERENCE,\r\n       PAYMENT,\r\n       PROPERTYTYPE,\r\n       BEDROOMS,\r\n       VALUE,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE\r\n       INTO  :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-BROKERID-INT INDICATOR :IND-BROKERID,\r\n       :DB2-BROKERSREF INDICATOR :IND-BROKERSREF,\r\n       :DB2-PAYMENT-INT INDICATOR :IND-PAYMENT,\r\n       :DB2-H-PROPERTYTYPE,\r\n       :DB2-H-BEDROOMS-SINT,\r\n       :DB2-H-VALUE-INT,\r\n       :DB2-H-HOUSENAME,\r\n       :DB2-H-HOUSENUMBER,\r\n       :DB2-H-POSTCODE\r\n       FROM  POLICY,HOUSE\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       HOUSE.POLICYNUMBER   AND\r\n       POLICY.CUSTOMERNUMBER =\r\n       :DB2-CUSTOMERNUM-INT             AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-HOUSE-LEN       TO WS-REQUIRED-CA-LEN\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n      *>         Length is sufficent so move data to commarea\r\n      *>         Move Integer fields to required length numerics\r\n      *>         Don't move null fields\r\n               IF IND-BROKERID NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-BROKERID-INT  TO DB2-BROKERID\r\n               END-IF\r\n               IF IND-PAYMENT NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-PAYMENT-INT TO DB2-PAYMENT\r\n               END-IF\r\n               MOVE DB2-H-BEDROOMS-SINT TO DB2-H-BEDROOMS\r\n               MOVE DB2-H-VALUE-INT     TO DB2-H-VALUE\r\n       \r\n               MOVE DB2-POLICY-COMMON   TO CA-POLICY-COMMON\r\n               MOVE DB2-HOUSE           TO CA-HOUSE(1:WS-HOUSE-LEN)\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-H-FILLER(1:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n       \r\n           END-IF\nEXIT\n\nMOVE ' SELECT MOTOR ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT  ISSUEDATE,\r\n       EXPIRYDATE,\r\n       LASTCHANGED,\r\n       BROKERID,\r\n       BROKERSREFERENCE,\r\n       PAYMENT,\r\n       MAKE,\r\n       MODEL,\r\n       VALUE,\r\n       REGNUMBER,\r\n       COLOUR,\r\n       CC,\r\n       YEAROFMANUFACTURE,\r\n       PREMIUM,\r\n       ACCIDENTS\r\n       INTO  :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-BROKERID-INT INDICATOR :IND-BROKERID,\r\n       :DB2-BROKERSREF INDICATOR :IND-BROKERSREF,\r\n       :DB2-PAYMENT-INT INDICATOR :IND-PAYMENT,\r\n       :DB2-M-MAKE,\r\n       :DB2-M-MODEL,\r\n       :DB2-M-VALUE-INT,\r\n       :DB2-M-REGNUMBER,\r\n       :DB2-M-COLOUR,\r\n       :DB2-M-CC-SINT,\r\n       :DB2-M-MANUFACTURED,\r\n       :DB2-M-PREMIUM-INT,\r\n       :DB2-M-ACCIDENTS-INT\r\n       FROM  POLICY,MOTOR\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       MOTOR.POLICYNUMBER   AND\r\n       POLICY.CUSTOMERNUMBER =\r\n       :DB2-CUSTOMERNUM-INT             AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-MOTOR-LEN       TO WS-REQUIRED-CA-LEN\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n      *>         Length is sufficent so move data to commarea\r\n      *>         Move Integer fields to required length numerics\r\n      *>         Don't move null fields\r\n               IF IND-BROKERID NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-BROKERID-INT TO DB2-BROKERID\r\n               END-IF\r\n               IF IND-PAYMENT NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-PAYMENT-INT    TO DB2-PAYMENT\r\n               END-IF\r\n               MOVE DB2-M-CC-SINT      TO DB2-M-CC\r\n               MOVE DB2-M-VALUE-INT    TO DB2-M-VALUE\r\n               MOVE DB2-M-PREMIUM-INT  TO DB2-M-PREMIUM\r\n               MOVE DB2-M-ACCIDENTS-INT TO DB2-M-ACCIDENTS\r\n               MOVE DB2-M-PREMIUM-INT  TO CA-M-PREMIUM\r\n               MOVE DB2-M-ACCIDENTS-INT TO CA-M-ACCIDENTS\r\n       \r\n               MOVE DB2-POLICY-COMMON  TO CA-POLICY-COMMON\r\n               MOVE DB2-MOTOR          TO CA-MOTOR(1:WS-MOTOR-LEN)\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-M-FILLER(1:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n       \r\n           END-IF\nEXIT\n\nMOVE ' SELECT Commercial ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT\r\n       RequestDate,\r\n       StartDate,\r\n       RenewalDate,\r\n       Address,\r\n       Zipcode,\r\n       LatitudeN,\r\n       LongitudeW,\r\n       Customer,\r\n       PropertyType,\r\n       FirePeril,\r\n       FirePremium,\r\n       CrimePeril,\r\n       CrimePremium,\r\n       FloodPeril,\r\n       FloodPremium,\r\n       WeatherPeril,\r\n       WeatherPremium,\r\n       Status,\r\n       RejectionReason\r\n       INTO  :DB2-LASTCHANGED,\r\n       :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-B-Address,\r\n       :DB2-B-Postcode,\r\n       :DB2-B-Latitude,\r\n       :DB2-B-Longitude,\r\n       :DB2-B-Customer,\r\n       :DB2-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :DB2-B-RejectReason\r\n       FROM  POLICY,COMMERCIAL\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       COMMERCIAL.POLICYNUMBER   AND\r\n       POLICY.CUSTOMERNUMBER =\r\n       :DB2-CUSTOMERNUM-INT             AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-COMM-LEN        TO WS-REQUIRED-CA-LEN\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n               MOVE DB2-B-FirePeril-Int      TO DB2-B-FirePeril\r\n               MOVE DB2-B-FirePremium-Int    TO DB2-B-FirePremium\r\n               MOVE DB2-B-CrimePeril-Int     TO DB2-B-CrimePeril\r\n               MOVE DB2-B-CrimePremium-Int   TO DB2-B-CrimePremium\r\n               MOVE DB2-B-FloodPeril-Int     TO DB2-B-FloodPeril\r\n               MOVE DB2-B-FloodPremium-Int   TO DB2-B-FloodPremium\r\n               MOVE DB2-B-WeatherPeril-Int   TO DB2-B-WeatherPeril\r\n               MOVE DB2-B-WeatherPremium-Int TO DB2-B-WeatherPremium\r\n               MOVE DB2-B-Status-Int         TO DB2-B-Status\r\n      *> \r\n               MOVE DB2-POLICY-COMMON  TO CA-POLICY-COMMON\r\n               MOVE DB2-COMMERCIAL     TO CA-COMMERCIAL(1:WS-COMM-LEN)\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-B-FILLER(1:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n\nMOVE ' SELECT Commercial ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT\r\n       CustomerNumber,\r\n       RequestDate,\r\n       StartDate,\r\n       RenewalDate,\r\n       Address,\r\n       Zipcode,\r\n       LatitudeN,\r\n       LongitudeW,\r\n       Customer,\r\n       PropertyType,\r\n       FirePeril,\r\n       FirePremium,\r\n       CrimePeril,\r\n       CrimePremium,\r\n       FloodPeril,\r\n       FloodPremium,\r\n       WeatherPeril,\r\n       WeatherPremium,\r\n       Status,\r\n       RejectionReason\r\n       INTO\r\n       :DB2-CUSTOMERNUM-INT,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-B-Address,\r\n       :DB2-B-Postcode,\r\n       :DB2-B-Latitude,\r\n       :DB2-B-Longitude,\r\n       :DB2-B-Customer,\r\n       :DB2-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :DB2-B-RejectReason\r\n       FROM  POLICY,COMMERCIAL\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       COmmercial.POLICYNUMBER   AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-COMM-LEN        TO WS-REQUIRED-CA-LEN\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n               MOVE DB2-CustomerNum-Int      TO CA-Customer-Num\r\n               MOVE DB2-B-FirePeril-Int      TO DB2-B-FirePeril\r\n               MOVE DB2-B-FirePremium-Int    TO DB2-B-FirePremium\r\n               MOVE DB2-B-CrimePeril-Int     TO DB2-B-CrimePeril\r\n               MOVE DB2-B-CrimePremium-Int   TO DB2-B-CrimePremium\r\n               MOVE DB2-B-FloodPeril-Int     TO DB2-B-FloodPeril\r\n               MOVE DB2-B-FloodPremium-Int   TO DB2-B-FloodPremium\r\n               MOVE DB2-B-WeatherPeril-Int   TO DB2-B-WeatherPeril\r\n               MOVE DB2-B-WeatherPremium-Int TO DB2-B-WeatherPremium\r\n               MOVE DB2-B-Status-Int         TO DB2-B-Status\r\n      *> \r\n               MOVE DB2-POLICY-COMMON  TO CA-POLICY-COMMON\r\n               MOVE DB2-COMMERCIAL     TO CA-COMMERCIAL(1:WS-COMM-LEN)\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-B-FILLER(1:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n\nMOVE ' SELECT Commercial ' TO EM-SQLREQ\nMove 0 To ICOM-Record-Count\nEXEC SQL\r\n       OPEN Cust_Cursor\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '89' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n             PERFORM END-PROGRAM\r\n           END-IF\nPerform GET-Commercial-DB2-INFO-3-Cur\r\n                     With Test after Until SQLCODE > 0\nEXEC SQL\r\n       Close Cust_Cursor\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '88' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n             PERFORM END-PROGRAM\r\n           END-IF\nExit\n\nEXEC SQL\r\n       Fetch Cust_Cursor\r\n       INTO\r\n       :DB2-CUSTOMERNUM-INT,\r\n       :DB2-POLICYNUM-INT,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-B-Address,\r\n       :DB2-B-Postcode,\r\n       :DB2-B-Latitude,\r\n       :DB2-B-Longitude,\r\n       :DB2-B-Customer,\r\n       :DB2-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :DB2-B-RejectReason\r\n       END-EXEC\nIf SQLCODE = 0\r\n             MOVE DB2-B-FirePeril-Int      TO DB2-B-FirePeril\r\n             MOVE DB2-B-FirePremium-Int    TO DB2-B-FirePremium\r\n             MOVE DB2-B-CrimePeril-Int     TO DB2-B-CrimePeril\r\n             MOVE DB2-B-CrimePremium-Int   TO DB2-B-CrimePremium\r\n             MOVE DB2-B-FloodPeril-Int     TO DB2-B-FloodPeril\r\n             MOVE DB2-B-FloodPremium-Int   TO DB2-B-FloodPremium\r\n             MOVE DB2-B-WeatherPeril-Int   TO DB2-B-WeatherPeril\r\n             MOVE DB2-B-WeatherPremium-Int TO DB2-B-WeatherPremium\r\n             MOVE DB2-B-Status-Int         TO DB2-B-Status\r\n             MOVE DB2-CustomerNum-Int      TO CA-CUSTOMER-NUM\r\n             MOVE DB2-PolicyNum-Int        TO CA-POLICY-NUM\r\n             MOVE DB2-POLICY-COMMON        TO CA-POLICY-COMMON\r\n             MOVE DB2-COMMERCIAL     TO CA-COMMERCIAL(1:WS-COMM-LEN)\r\n       \r\n             Add 1 To ICOM-Record-Count\r\n             If ICOM-Record-Count > 20\r\n               Move 17 To SQLCODE\r\n             End-If\r\n           End-If\nEXIT\n\nMOVE ' SELECT Commercial ' TO EM-SQLREQ\nEXEC SQL\r\n       OPEN Zip_Cursor\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '89' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n             PERFORM END-PROGRAM\r\n           END-IF\nPerform GET-Commercial-DB2-INFO-5-Cur\r\n                     With Test after Until SQLCODE > 0\nEXEC SQL\r\n       Close Zip_Cursor\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '88' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n             PERFORM END-PROGRAM\r\n           END-IF\nExit\n\nEXEC SQL\r\n       Fetch Zip_Cursor\r\n       INTO\r\n       :DB2-CUSTOMERNUM-INT,\r\n       :DB2-POLICYNUM-INT,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-B-Address,\r\n       :DB2-B-Postcode,\r\n       :DB2-B-Latitude,\r\n       :DB2-B-Longitude,\r\n       :DB2-B-Customer,\r\n       :DB2-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :DB2-B-RejectReason\r\n       END-EXEC\nIf SQLCODE = 0\r\n             MOVE DB2-B-FirePeril-Int      TO DB2-B-FirePeril\r\n             MOVE DB2-B-FirePremium-Int    TO DB2-B-FirePremium\r\n             MOVE DB2-B-CrimePeril-Int     TO DB2-B-CrimePeril\r\n             MOVE DB2-B-CrimePremium-Int   TO DB2-B-CrimePremium\r\n             MOVE DB2-B-FloodPeril-Int     TO DB2-B-FloodPeril\r\n             MOVE DB2-B-FloodPremium-Int   TO DB2-B-FloodPremium\r\n             MOVE DB2-B-WeatherPeril-Int   TO DB2-B-WeatherPeril\r\n             MOVE DB2-B-WeatherPremium-Int TO DB2-B-WeatherPremium\r\n             MOVE DB2-B-Status-Int         TO DB2-B-Status\r\n             MOVE DB2-CustomerNum-Int      TO CA-CUSTOMER-NUM\r\n             MOVE DB2-PolicyNum-Int        TO CA-POLICY-NUM\r\n             MOVE DB2-POLICY-COMMON        TO CA-POLICY-COMMON\r\n             MOVE DB2-COMMERCIAL     TO CA-COMMERCIAL(1:WS-COMM-LEN)\r\n           End-If\nEXIT\n\nMOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(ABS-TIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(ABS-TIME)\r\n       MMDDYYYY(DATE1)\r\n       TIME(TIME1)\r\n       END-EXEC\nMOVE DATE1 TO EM-DATE\nMOVE TIME1 TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 230, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgipdb01.cbl\" at line number \"230\"\nBusiness Intent: mainframe_modernization\nTechnical Action: architectural_design\nKeywords: COBOL, Mainframe Modernization, Legacy Systems, DB2, Commercial Info, SQLCODE, COMMAREA, EIBCALEN"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "End-Program", "content": "EXEC CICS RETURN END-EXEC\n", "lineNumber": 312, "summary": "The below code segment is a \"PARAGRAPH\" named \"End-Program\" which is in the file \"lgipdb01.cbl\" at line number \"312\"\nBusiness Intent: Terminates the current transaction and returns control to the caller.\nTechnical Action: Executes a CICS Return command, ending the current program execution.\nKeywords: CICS, Return, Transaction, Termination, Program Execution"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-ENDOW-DB2-INFO", "content": "MOVE ' SELECT ENDOW ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT  ISSUEDATE,\r\n       EXPIRYDATE,\r\n       LASTCHANGED,\r\n       BROKERID,\r\n       BROKERSREFERENCE,\r\n       PAYMENT,\r\n       WITHPROFITS,\r\n       EQUITIES,\r\n       MANAGEDFUND,\r\n       FUNDNAME,\r\n       TERM,\r\n       SUMASSURED,\r\n       LIFEASSURED,\r\n       PADDINGDATA,\r\n       LENGTH(PADDINGDATA)\r\n       INTO  :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-BROKERID-INT INDICATOR :IND-BROKERID,\r\n       :DB2-BROKERSREF INDICATOR :IND-BROKERSREF,\r\n       :DB2-PAYMENT-INT INDICATOR :IND-PAYMENT,\r\n       :DB2-E-WITHPROFITS,\r\n       :DB2-E-EQUITIES,\r\n       :DB2-E-MANAGEDFUND,\r\n       :DB2-E-FUNDNAME,\r\n       :DB2-E-TERM-SINT,\r\n       :DB2-E-SUMASSURED-INT,\r\n       :DB2-E-LIFEASSURED,\r\n       :DB2-E-PADDINGDATA INDICATOR :IND-E-PADDINGDATA,\r\n       :DB2-E-PADDING-LEN INDICATOR :IND-E-PADDINGDATAL\r\n       FROM  POLICY,ENDOWMENT\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       ENDOWMENT.POLICYNUMBER   AND\r\n       POLICY.CUSTOMERNUMBER =\r\n       :DB2-CUSTOMERNUM-INT             AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-ENDOW-LEN       TO WS-REQUIRED-CA-LEN\r\n       \r\n      *> ----------------------------------------------------------------*\r\n      *>       Specific code to allow for length of VACHAR data\r\n      *>       check whether PADDINGDATA field is non-null\r\n      *>         and calculate length of endowment policy\r\n      *>         and position of free space in commarea after policy data\r\n      *> ----------------------------------------------------------------*\r\n             IF IND-E-PADDINGDATAL NOT EQUAL MINUS-ONE\r\n               ADD DB2-E-PADDING-LEN TO WS-REQUIRED-CA-LEN\r\n               ADD DB2-E-PADDING-LEN TO END-POLICY-POS\r\n             END-IF\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n      *>         Length is sufficent so move data to commarea\r\n      *>         Move Integer fields to required length numerics\r\n      *>         Don't move null fields\r\n               IF IND-BROKERID NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-BROKERID-INT    TO DB2-BROKERID\r\n               END-IF\r\n               IF IND-PAYMENT NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-PAYMENT-INT TO DB2-PAYMENT\r\n               END-IF\r\n      *> ----------------------------------------------------------------*\r\n               MOVE DB2-E-TERM-SINT       TO DB2-E-TERM\r\n               MOVE DB2-E-SUMASSURED-INT  TO DB2-E-SUMASSURED\r\n       \r\n               MOVE DB2-POLICY-COMMON     TO CA-POLICY-COMMON\r\n               MOVE DB2-ENDOW-FIXED\r\n                   TO CA-ENDOWMENT(1:WS-ENDOW-LEN)\r\n               IF IND-E-PADDINGDATA NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-E-PADDINGDATA TO\r\n                     CA-E-PADDING-DATA(1:DB2-E-PADDING-LEN)\r\n               END-IF\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-E-PADDING-DATA(END-POLICY-POS:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n       \r\n           END-IF\nEXIT\n", "lineNumber": 327, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-ENDOW-DB2-INFO\" which is in the file \"lgipdb01.cbl\" at line number \"327\"\nBusiness Intent: Retrieve endowment policy details for a specific customer based on their policy number.\nTechnical Action: Executes an SQL query to fetch data from the POLICY and ENDOWMENT tables, handles errors and returns error codes if necessary.\nKeywords: COBOL, CICS, DB2, SQL, Endowment Policy, Customer Number, Policy Number, Error Handling"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-HOUSE-DB2-INFO", "content": "MOVE ' SELECT HOUSE ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT  ISSUEDATE,\r\n       EXPIRYDATE,\r\n       LASTCHANGED,\r\n       BROKERID,\r\n       BROKERSREFERENCE,\r\n       PAYMENT,\r\n       PROPERTYTYPE,\r\n       BEDROOMS,\r\n       VALUE,\r\n       HOUSENAME,\r\n       HOUSENUMBER,\r\n       POSTCODE\r\n       INTO  :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-BROKERID-INT INDICATOR :IND-BROKERID,\r\n       :DB2-BROKERSREF INDICATOR :IND-BROKERSREF,\r\n       :DB2-PAYMENT-INT INDICATOR :IND-PAYMENT,\r\n       :DB2-H-PROPERTYTYPE,\r\n       :DB2-H-BEDROOMS-SINT,\r\n       :DB2-H-VALUE-INT,\r\n       :DB2-H-HOUSENAME,\r\n       :DB2-H-HOUSENUMBER,\r\n       :DB2-H-POSTCODE\r\n       FROM  POLICY,HOUSE\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       HOUSE.POLICYNUMBER   AND\r\n       POLICY.CUSTOMERNUMBER =\r\n       :DB2-CUSTOMERNUM-INT             AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-HOUSE-LEN       TO WS-REQUIRED-CA-LEN\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n      *>         Length is sufficent so move data to commarea\r\n      *>         Move Integer fields to required length numerics\r\n      *>         Don't move null fields\r\n               IF IND-BROKERID NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-BROKERID-INT  TO DB2-BROKERID\r\n               END-IF\r\n               IF IND-PAYMENT NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-PAYMENT-INT TO DB2-PAYMENT\r\n               END-IF\r\n               MOVE DB2-H-BEDROOMS-SINT TO DB2-H-BEDROOMS\r\n               MOVE DB2-H-VALUE-INT     TO DB2-H-VALUE\r\n       \r\n               MOVE DB2-POLICY-COMMON   TO CA-POLICY-COMMON\r\n               MOVE DB2-HOUSE           TO CA-HOUSE(1:WS-HOUSE-LEN)\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-H-FILLER(1:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n       \r\n           END-IF\nEXIT\n", "lineNumber": 441, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-HOUSE-DB2-INFO\" which is in the file \"lgipdb01.cbl\" at line number \"441\"\nBusiness Intent: Retrieve property data for a customer based on policy number and customer ID, with optional error handling for invalid inputs.\nTechnical Action: Executes an SQL SELECT statement to fetch property data from the POLICY and HOUSE tables, handles errors, and moves data to a COMMAREA.\nKeywords: COBOL, CICS, SQL, SELECT, FROM, WHERE, INTO, DB2, POLICY, HOUSE, CUSTOMERNUMBER, POLICYNUMBER, Error Handling, COMMAREA, MOVE, ADD, EXEC, RETURN"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-MOTOR-DB2-INFO", "content": "MOVE ' SELECT MOTOR ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT  ISSUEDATE,\r\n       EXPIRYDATE,\r\n       LASTCHANGED,\r\n       BROKERID,\r\n       BROKERSREFERENCE,\r\n       PAYMENT,\r\n       MAKE,\r\n       MODEL,\r\n       VALUE,\r\n       REGNUMBER,\r\n       COLOUR,\r\n       CC,\r\n       YEAROFMANUFACTURE,\r\n       PREMIUM,\r\n       ACCIDENTS\r\n       INTO  :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-BROKERID-INT INDICATOR :IND-BROKERID,\r\n       :DB2-BROKERSREF INDICATOR :IND-BROKERSREF,\r\n       :DB2-PAYMENT-INT INDICATOR :IND-PAYMENT,\r\n       :DB2-M-MAKE,\r\n       :DB2-M-MODEL,\r\n       :DB2-M-VALUE-INT,\r\n       :DB2-M-REGNUMBER,\r\n       :DB2-M-COLOUR,\r\n       :DB2-M-CC-SINT,\r\n       :DB2-M-MANUFACTURED,\r\n       :DB2-M-PREMIUM-INT,\r\n       :DB2-M-ACCIDENTS-INT\r\n       FROM  POLICY,MOTOR\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       MOTOR.POLICYNUMBER   AND\r\n       POLICY.CUSTOMERNUMBER =\r\n       :DB2-CUSTOMERNUM-INT             AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-MOTOR-LEN       TO WS-REQUIRED-CA-LEN\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n      *>         Length is sufficent so move data to commarea\r\n      *>         Move Integer fields to required length numerics\r\n      *>         Don't move null fields\r\n               IF IND-BROKERID NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-BROKERID-INT TO DB2-BROKERID\r\n               END-IF\r\n               IF IND-PAYMENT NOT EQUAL MINUS-ONE\r\n                 MOVE DB2-PAYMENT-INT    TO DB2-PAYMENT\r\n               END-IF\r\n               MOVE DB2-M-CC-SINT      TO DB2-M-CC\r\n               MOVE DB2-M-VALUE-INT    TO DB2-M-VALUE\r\n               MOVE DB2-M-PREMIUM-INT  TO DB2-M-PREMIUM\r\n               MOVE DB2-M-ACCIDENTS-INT TO DB2-M-ACCIDENTS\r\n               MOVE DB2-M-PREMIUM-INT  TO CA-M-PREMIUM\r\n               MOVE DB2-M-ACCIDENTS-INT TO CA-M-ACCIDENTS\r\n       \r\n               MOVE DB2-POLICY-COMMON  TO CA-POLICY-COMMON\r\n               MOVE DB2-MOTOR          TO CA-MOTOR(1:WS-MOTOR-LEN)\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-M-FILLER(1:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n       \r\n           END-IF\nEXIT\n", "lineNumber": 529, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-MOTOR-DB2-INFO\" which is in the file \"lgipdb01.cbl\" at line number \"529\"\nBusiness Intent: Retrieve policy data for a specific customer and policy number, including issuedate, expirydate, lastchanged, brokerid, and other relevant fields.\nTechnical Action: Perform an SQL query using DB2 to select data from the POLICY and MOTOR tables, based on matching policy numbers and customer numbers. If the query is successful, calculate the required size of the commarea and move data to it. Otherwise, handle errors by setting a return code and writing an error message.\nKeywords: COBOL, DB2, SQL, CICS, POLICY, MOTOR, customer, policy number, issuedate, expirydate, lastchanged, brokerid, payment, make, model, value, regnumber, colour, cc, yearofmanufacture, premium, accidents"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-Commercial-DB2-INFO-1", "content": "MOVE ' SELECT Commercial ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT\r\n       RequestDate,\r\n       StartDate,\r\n       RenewalDate,\r\n       Address,\r\n       Zipcode,\r\n       LatitudeN,\r\n       LongitudeW,\r\n       Customer,\r\n       PropertyType,\r\n       FirePeril,\r\n       FirePremium,\r\n       CrimePeril,\r\n       CrimePremium,\r\n       FloodPeril,\r\n       FloodPremium,\r\n       WeatherPeril,\r\n       WeatherPremium,\r\n       Status,\r\n       RejectionReason\r\n       INTO  :DB2-LASTCHANGED,\r\n       :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-B-Address,\r\n       :DB2-B-Postcode,\r\n       :DB2-B-Latitude,\r\n       :DB2-B-Longitude,\r\n       :DB2-B-Customer,\r\n       :DB2-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :DB2-B-RejectReason\r\n       FROM  POLICY,COMMERCIAL\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       COMMERCIAL.POLICYNUMBER   AND\r\n       POLICY.CUSTOMERNUMBER =\r\n       :DB2-CUSTOMERNUM-INT             AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-COMM-LEN        TO WS-REQUIRED-CA-LEN\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n               MOVE DB2-B-FirePeril-Int      TO DB2-B-FirePeril\r\n               MOVE DB2-B-FirePremium-Int    TO DB2-B-FirePremium\r\n               MOVE DB2-B-CrimePeril-Int     TO DB2-B-CrimePeril\r\n               MOVE DB2-B-CrimePremium-Int   TO DB2-B-CrimePremium\r\n               MOVE DB2-B-FloodPeril-Int     TO DB2-B-FloodPeril\r\n               MOVE DB2-B-FloodPremium-Int   TO DB2-B-FloodPremium\r\n               MOVE DB2-B-WeatherPeril-Int   TO DB2-B-WeatherPeril\r\n               MOVE DB2-B-WeatherPremium-Int TO DB2-B-WeatherPremium\r\n               MOVE DB2-B-Status-Int         TO DB2-B-Status\r\n      *> \r\n               MOVE DB2-POLICY-COMMON  TO CA-POLICY-COMMON\r\n               MOVE DB2-COMMERCIAL     TO CA-COMMERCIAL(1:WS-COMM-LEN)\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-B-FILLER(1:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 627, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-Commercial-DB2-INFO-1\" which is in the file \"lgipdb01.cbl\" at line number \"627\"\nBusiness Intent: Retrieve Commercial Policy Data\nTechnical Action: EXEC SQL SELECT statement with WHERE clause and data movement from COBOL to DB2, handling errors and calculating commarea size\nKeywords: COBOL, DB2, CICS, SQLCODE, EXEC SQL, SELECT, WHERE, COMMERCIAL POLICY, CUSTOMER NUMBER, POLICY NUMBER, COMMA AREA"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-Commercial-DB2-INFO-2", "content": "MOVE ' SELECT Commercial ' TO EM-SQLREQ\nEXEC SQL\r\n       SELECT\r\n       CustomerNumber,\r\n       RequestDate,\r\n       StartDate,\r\n       RenewalDate,\r\n       Address,\r\n       Zipcode,\r\n       LatitudeN,\r\n       LongitudeW,\r\n       Customer,\r\n       PropertyType,\r\n       FirePeril,\r\n       FirePremium,\r\n       CrimePeril,\r\n       CrimePremium,\r\n       FloodPeril,\r\n       FloodPremium,\r\n       WeatherPeril,\r\n       WeatherPremium,\r\n       Status,\r\n       RejectionReason\r\n       INTO\r\n       :DB2-CUSTOMERNUM-INT,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-B-Address,\r\n       :DB2-B-Postcode,\r\n       :DB2-B-Latitude,\r\n       :DB2-B-Longitude,\r\n       :DB2-B-Customer,\r\n       :DB2-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :DB2-B-RejectReason\r\n       FROM  POLICY,COMMERCIAL\r\n       WHERE ( POLICY.POLICYNUMBER =\r\n       COmmercial.POLICYNUMBER   AND\r\n       POLICY.POLICYNUMBER =\r\n       :DB2-POLICYNUM-INT               )\r\n       END-EXEC\nIF SQLCODE = 0\r\n      *>       Select was successful\r\n       \r\n      *>       Calculate size of commarea required to return all data\r\n             ADD WS-CA-HEADERTRAILER-LEN TO WS-REQUIRED-CA-LEN\r\n             ADD WS-FULL-COMM-LEN        TO WS-REQUIRED-CA-LEN\r\n       \r\n      *>       if commarea received is not large enough ...\r\n      *>         set error return code and return to caller\r\n             IF EIBCALEN IS LESS THAN WS-REQUIRED-CA-LEN\r\n               MOVE '98' TO CA-RETURN-CODE\r\n       EXEC CICS RETURN END-EXEC\r\n             ELSE\r\n               MOVE DB2-CustomerNum-Int      TO CA-Customer-Num\r\n               MOVE DB2-B-FirePeril-Int      TO DB2-B-FirePeril\r\n               MOVE DB2-B-FirePremium-Int    TO DB2-B-FirePremium\r\n               MOVE DB2-B-CrimePeril-Int     TO DB2-B-CrimePeril\r\n               MOVE DB2-B-CrimePremium-Int   TO DB2-B-CrimePremium\r\n               MOVE DB2-B-FloodPeril-Int     TO DB2-B-FloodPeril\r\n               MOVE DB2-B-FloodPremium-Int   TO DB2-B-FloodPremium\r\n               MOVE DB2-B-WeatherPeril-Int   TO DB2-B-WeatherPeril\r\n               MOVE DB2-B-WeatherPremium-Int TO DB2-B-WeatherPremium\r\n               MOVE DB2-B-Status-Int         TO DB2-B-Status\r\n      *> \r\n               MOVE DB2-POLICY-COMMON  TO CA-POLICY-COMMON\r\n               MOVE DB2-COMMERCIAL     TO CA-COMMERCIAL(1:WS-COMM-LEN)\r\n             END-IF\r\n       \r\n      *>       Mark the end of the policy data\r\n             MOVE 'FINAL' TO CA-B-FILLER(1:5)\r\n       \r\n           ELSE\r\n      *>       Non-zero SQLCODE from first SQL FETCH statement\r\n             IF SQLCODE EQUAL 100\r\n      *>         No rows found - invalid customer / policy number\r\n               MOVE '01' TO CA-RETURN-CODE\r\n             ELSE\r\n      *>         something has gone wrong\r\n               MOVE '90' TO CA-RETURN-CODE\r\n      *>         Write error message to TD QUEUE(CSMT)\r\n               PERFORM WRITE-ERROR-MESSAGE\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 730, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-Commercial-DB2-INFO-2\" which is in the file \"lgipdb01.cbl\" at line number \"730\"\nBusiness Intent: Retrieve commercial policy data from a database, performing a SQL query based on customer and policy number\nTechnical Action: Executes an SQL SELECT statement to fetch data from the POLICY and COMMERCIAL tables, handles errors with error code '98', and returns relevant data to the caller\nKeywords: COBOL, CICS, DB2, SQL, SELECT, FROM, WHERE, INTO, CustomerNumber, RequestDate, StartDate, RenewalDate, Address, Zipcode, LatitudeN, LongitudeW, Customer, PropertyType, FirePeril, FirePremium, CrimePeril, CrimePremium, FloodPeril, FloodPremium, WeatherPeril, WeatherPremium, Status, RejectionReason"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-Commercial-DB2-INFO-3", "content": "MOVE ' SELECT Commercial ' TO EM-SQLREQ\nMove 0 To ICOM-Record-Count\nEXEC SQL\r\n       OPEN Cust_Cursor\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '89' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n             PERFORM END-PROGRAM\r\n           END-IF\nPerform GET-Commercial-DB2-INFO-3-Cur\r\n                     With Test after Until SQLCODE > 0\nEXEC SQL\r\n       Close Cust_Cursor\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '88' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n             PERFORM END-PROGRAM\r\n           END-IF\nExit\n", "lineNumber": 835, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-Commercial-DB2-INFO-3\" which is in the file \"lgipdb01.cbl\" at line number \"835\"\nBusiness Intent: Retrieve commercial customer information from a DB2 database using CICS and COBOL, with error handling for SQLCODE.\nTechnical Action: Open and close a cursor, execute SQL queries (SELECT), perform record processing until a condition is met, and handle errors.\nKeywords: COBOL, CICS, DB2, SQL, Cursor, SELECT, Error Handling, Commercial Customer Information"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-Commercial-DB2-INFO-3-Cur", "content": "EXEC SQL\r\n       Fetch Cust_Cursor\r\n       INTO\r\n       :DB2-CUSTOMERNUM-INT,\r\n       :DB2-POLICYNUM-INT,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-B-Address,\r\n       :DB2-B-Postcode,\r\n       :DB2-B-Latitude,\r\n       :DB2-B-Longitude,\r\n       :DB2-B-Customer,\r\n       :DB2-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :DB2-B-RejectReason\r\n       END-EXEC\nIf SQLCODE = 0\r\n             MOVE DB2-B-FirePeril-Int      TO DB2-B-FirePeril\r\n             MOVE DB2-B-FirePremium-Int    TO DB2-B-FirePremium\r\n             MOVE DB2-B-CrimePeril-Int     TO DB2-B-CrimePeril\r\n             MOVE DB2-B-CrimePremium-Int   TO DB2-B-CrimePremium\r\n             MOVE DB2-B-FloodPeril-Int     TO DB2-B-FloodPeril\r\n             MOVE DB2-B-FloodPremium-Int   TO DB2-B-FloodPremium\r\n             MOVE DB2-B-WeatherPeril-Int   TO DB2-B-WeatherPeril\r\n             MOVE DB2-B-WeatherPremium-Int TO DB2-B-WeatherPremium\r\n             MOVE DB2-B-Status-Int         TO DB2-B-Status\r\n             MOVE DB2-CustomerNum-Int      TO CA-CUSTOMER-NUM\r\n             MOVE DB2-PolicyNum-Int        TO CA-POLICY-NUM\r\n             MOVE DB2-POLICY-COMMON        TO CA-POLICY-COMMON\r\n             MOVE DB2-COMMERCIAL     TO CA-COMMERCIAL(1:WS-COMM-LEN)\r\n       \r\n             Add 1 To ICOM-Record-Count\r\n             If ICOM-Record-Count > 20\r\n               Move 17 To SQLCODE\r\n             End-If\r\n           End-If\nEXIT\n", "lineNumber": 863, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-Commercial-DB2-INFO-3-Cur\" which is in the file \"lgipdb01.cbl\" at line number \"863\"\nBusiness Intent: Retrieve customer policy information from a DB2 database using FETCH Cust_Cursor and process the data accordingly.\nTechnical Action: Fetches data from a DB2 cursor, handles errors by checking SQLCODE, and processes the retrieved data to update variables.\nKeywords: COBOL, DB2, SQL, CICS, Fetch, Cursor, Error Handling, Business Logic"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-Commercial-DB2-INFO-5", "content": "MOVE ' SELECT Commercial ' TO EM-SQLREQ\nEXEC SQL\r\n       OPEN Zip_Cursor\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '89' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n             PERFORM END-PROGRAM\r\n           END-IF\nPerform GET-Commercial-DB2-INFO-5-Cur\r\n                     With Test after Until SQLCODE > 0\nEXEC SQL\r\n       Close Zip_Cursor\r\n       END-EXEC\nIF SQLCODE NOT EQUAL 0\r\n             MOVE '88' TO CA-RETURN-CODE\r\n             PERFORM WRITE-ERROR-MESSAGE\r\n             PERFORM END-PROGRAM\r\n           END-IF\nExit\n", "lineNumber": 919, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-Commercial-DB2-INFO-5\" which is in the file \"lgipdb01.cbl\" at line number \"919\"\nBusiness Intent: Retrieve commercial data from a DB2 database using SQL commands and handle any errors that may occur.\nTechnical Action: The code segment performs the following actions: opens a cursor, executes a SQL query to retrieve commercial data, handles potential errors with error handling mechanisms, and then closes the cursor. The mainframe program also utilizes performance features such as 'With Test' for improved efficiency.\nKeywords: CICS, COBOL, DB2, SQL, Error Handling, Cursor, Query, Mainframe, Performance Optimization, Test, Commercial Data"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "GET-Commercial-DB2-INFO-5-Cur", "content": "EXEC SQL\r\n       Fetch Zip_Cursor\r\n       INTO\r\n       :DB2-CUSTOMERNUM-INT,\r\n       :DB2-POLICYNUM-INT,\r\n       :DB2-LASTCHANGED,\r\n       :DB2-ISSUEDATE,\r\n       :DB2-EXPIRYDATE,\r\n       :DB2-B-Address,\r\n       :DB2-B-Postcode,\r\n       :DB2-B-Latitude,\r\n       :DB2-B-Longitude,\r\n       :DB2-B-Customer,\r\n       :DB2-B-PropType,\r\n       :DB2-B-FirePeril-Int,\r\n       :DB2-B-FirePremium-Int,\r\n       :DB2-B-CrimePeril-Int,\r\n       :DB2-B-CrimePremium-Int,\r\n       :DB2-B-FloodPeril-Int,\r\n       :DB2-B-FloodPremium-Int,\r\n       :DB2-B-WeatherPeril-Int,\r\n       :DB2-B-WeatherPremium-Int,\r\n       :DB2-B-Status-Int,\r\n       :DB2-B-RejectReason\r\n       END-EXEC\nIf SQLCODE = 0\r\n             MOVE DB2-B-FirePeril-Int      TO DB2-B-FirePeril\r\n             MOVE DB2-B-FirePremium-Int    TO DB2-B-FirePremium\r\n             MOVE DB2-B-CrimePeril-Int     TO DB2-B-CrimePeril\r\n             MOVE DB2-B-CrimePremium-Int   TO DB2-B-CrimePremium\r\n             MOVE DB2-B-FloodPeril-Int     TO DB2-B-FloodPeril\r\n             MOVE DB2-B-FloodPremium-Int   TO DB2-B-FloodPremium\r\n             MOVE DB2-B-WeatherPeril-Int   TO DB2-B-WeatherPeril\r\n             MOVE DB2-B-WeatherPremium-Int TO DB2-B-WeatherPremium\r\n             MOVE DB2-B-Status-Int         TO DB2-B-Status\r\n             MOVE DB2-CustomerNum-Int      TO CA-CUSTOMER-NUM\r\n             MOVE DB2-PolicyNum-Int        TO CA-POLICY-NUM\r\n             MOVE DB2-POLICY-COMMON        TO CA-POLICY-COMMON\r\n             MOVE DB2-COMMERCIAL     TO CA-COMMERCIAL(1:WS-COMM-LEN)\r\n           End-If\nEXIT\n", "lineNumber": 946, "summary": "The below code segment is a \"PARAGRAPH\" named \"GET-Commercial-DB2-INFO-5-Cur\" which is in the file \"lgipdb01.cbl\" at line number \"946\"\nBusiness Intent: Fetch and process customer policy information from a database using SQL\nTechnical Action: Executes an SQL FETCH operation to retrieve data and performs subsequent moves of integer values\nKeywords: COBOL, SQL, CICS, DB2, customer policy, data processing"}, {"fileName": "lgipdb01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "MOVE SQLCODE TO EM-SQLRC\nEXEC CICS ASKTIME ABSTIME(ABS-TIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(ABS-TIME)\r\n       MMDDYYYY(DATE1)\r\n       TIME(TIME1)\r\n       END-EXEC\nMOVE DATE1 TO EM-DATE\nMOVE TIME1 TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 997, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgipdb01.cbl\" at line number \"997\"\nBusiness Intent: Retrieve and format current date and time for error handling purposes.\nTechnical Action: Uses CICS ASKTIME and FORMATTIME commands to retrieve the current absolute time, then formats it into a human-readable format. Error handling is implemented by checking SQLCODE and EIBCALEN values, with specific actions taken based on the values.\nKeywords: CICS, ASKTIME, FORMATTIME, DATE, TIME, SQLCODE, EIBCALEN, Error Handling"}, {"fileName": "lgipol01.cbl", "type": "LINKAGE_SECTION", "name": "LINKAGE SECTION", "content": "01DFHCOMMAREA.\r\n      \n03CA-REQUEST-IDPICX(6).\r\n           \n03CA-RETURN-CODEPIC9(2).\r\n           \n03CA-CUSTOMER-NUMPIC9(10).\r\n           \n03CA-REQUEST-SPECIFICPICX(32482).\r\n      \n03CA-CUSTOMER-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-FIRST-NAMEPICX(10).\r\n              \n05CA-LAST-NAMEPICX(20).\r\n              \n05CA-DOBPICX(10).\r\n              \n05CA-HOUSE-NAMEPICX(20).\r\n              \n05CA-HOUSE-NUMPICX(4).\r\n              \n05CA-POSTCODEPICX(8).\r\n              \n05CA-NUM-POLICIESPIC9(3).\r\n              \n05CA-PHONE-MOBILEPICX(20).\r\n              \n05CA-PHONE-HOMEPICX(20).\r\n              \n05CA-EMAIL-ADDRESSPICX(100).\r\n              \n05CA-POLICY-DATAPICX(32267).\r\n      \n03CA-CUSTSECR-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-CUSTSECR-PASSPICX(32).\r\n              \n05CA-CUSTSECR-COUNTPICX(4).\r\n              \n05CA-CUSTSECR-STATEPICX.\r\n              \n05CA-CUSTSECR-DATAPICX(32445).\r\n      \n03CA-POLICY-REQUESTREDEFINESCA-REQUEST-SPECIFIC.\r\n              \n05CA-POLICY-NUMPIC9(10).\r\n      \n05CA-POLICY-COMMON.\r\n                 \n07CA-ISSUE-DATEPICX(10).\r\n                 \n07CA-EXPIRY-DATEPICX(10).\r\n                 \n07CA-LASTCHANGEDPICX(26).\r\n                 \n07CA-BROKERIDPIC9(10).\r\n                 \n07CA-BROKERSREFPICX(10).\r\n                 \n07CA-PAYMENTPIC9(6).\r\n              \n05CA-POLICY-SPECIFICPICX(32400).\r\n      \n05CA-ENDOWMENTREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-E-WITH-PROFITSPICX.\r\n                 \n07CA-E-EQUITIESPICX.\r\n                 \n07CA-E-MANAGED-FUNDPICX.\r\n                 \n07CA-E-FUND-NAMEPICX(10).\r\n                 \n07CA-E-TERMPIC99.\r\n                 \n07CA-E-SUM-ASSUREDPIC9(6).\r\n                 \n07CA-E-LIFE-ASSUREDPICX(31).\r\n                 \n07CA-E-PADDING-DATAPICX(32348).\r\n      \n05CA-HOUSEREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-H-PROPERTY-TYPEPICX(15).\r\n                 \n07CA-H-BEDROOMSPIC9(3).\r\n                 \n07CA-H-VALUEPIC9(8).\r\n                 \n07CA-H-HOUSE-NAMEPICX(20).\r\n                 \n07CA-H-HOUSE-NUMBERPICX(4).\r\n                 \n07CA-H-POSTCODEPICX(8).\r\n                 \n07CA-H-FILLERPICX(32342).\r\n      \n05CA-MOTORREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-M-MAKEPICX(15).\r\n                 \n07CA-M-MODELPICX(15).\r\n                 \n07CA-M-VALUEPIC9(6).\r\n                 \n07CA-M-REGNUMBERPICX(7).\r\n                 \n07CA-M-COLOURPICX(8).\r\n                 \n07CA-M-CCPIC9(4).\r\n                 \n07CA-M-MANUFACTUREDPICX(10).\r\n                 \n07CA-M-PREMIUMPIC9(6).\r\n                 \n07CA-M-ACCIDENTSPIC9(6).\r\n                 \n07CA-M-FILLERPICX(32323).\r\n      \n05CA-COMMERCIALREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-B-AddressPICX(255).\r\n                 \n07CA-B-PostcodePICX(8).\r\n                 \n07CA-B-LatitudePICX(11).\r\n                 \n07CA-B-LongitudePICX(11).\r\n                 \n07CA-B-CustomerPICX(255).\r\n                 \n07CA-B-PropTypePICX(255).\r\n                 \n07CA-B-FirePerilPIC9(4).\r\n                 \n07CA-B-FirePremiumPIC9(8).\r\n                 \n07CA-B-CrimePerilPIC9(4).\r\n                 \n07CA-B-CrimePremiumPIC9(8).\r\n                 \n07CA-B-FloodPerilPIC9(4).\r\n                 \n07CA-B-FloodPremiumPIC9(8).\r\n                 \n07CA-B-WeatherPerilPIC9(4).\r\n                 \n07CA-B-WeatherPremiumPIC9(8).\r\n                 \n07CA-B-StatusPIC9(4).\r\n                 \n07CA-B-RejectReasonPICX(255).\r\n                 \n07CA-B-FILLERPICX(31298).\r\n      \n05CA-CLAIMREDEFINESCA-POLICY-SPECIFIC.\r\n                 \n07CA-C-NumPIC9(10).\r\n                 \n07CA-C-DatePICX(10).\r\n                 \n07CA-C-PaidPIC9(8).\r\n                 \n07CA-C-ValuePIC9(8).\r\n                 \n07CA-C-CausePICX(255).\r\n                 \n07CA-C-ObservationsPICX(255).\r\n                 \n07CA-C-FILLERPICX(31854).", "lineNumber": -1, "summary": "Below is a \"LINKAGE SECTION\" in the file \"lgipol01.cbl\"\nStructure: LINKAGE SECTION\nDescription: \nFields: CA-REQUEST-ID, CA-CUSTOMER-NUMPIC, CA-POLICY-DATAPIC, CA-CUSTSECR-REQUEST, CA-POLICY-REQUEST, CA-HOUSER, CA-MOTOR, CA-COMMERCIAL, CA-CLAIM"}, {"fileName": "lgipol01.cbl", "type": "DATA_LAYOUT", "name": "DATA LAYOUT FOR lgipol01.cbl", "content": " 01  WS-HEADER.\n   03 WS-EYECATCHER            PIC X(16)\r\n                                        VALUE 'LGIPOL01------WS'.\n   03 WS-TRANSID               PIC X(4).\n   03 WS-TERMID                PIC X(4).\n   03 WS-TASKNUM               PIC 9(7).\n   03 WS-FILLER                PIC X.\n   03 WS-ADDR-DFHCOMMAREA      USAGE is POINTER.\n   03 WS-CALEN                 PIC S9(4) COMP.\n\n 01  ABS-TIME                    PIC S9(8) COMP VALUE +0.\n\n 01  TIME1                       PIC X(8)  VALUE SPACES.\n\n 01  DATE1                       PIC X(10) VALUE SPACES.\n\n 01  ERROR-MSG.\n   03 EM-DATE                  PIC X(8)  VALUE SPACES.\n   03 FILLER                   PIC X     VALUE SPACES.\n   03 EM-TIME                  PIC X(6)  VALUE SPACES.\n   03 FILLER                   PIC X(9)  VALUE ' LGIPOL01'.\n   03 EM-VARIABLE              PIC X(21) VALUE SPACES.\n\n 01  CA-ERROR-MSG.\n   03 FILLER                   PIC X(9)  VALUE 'COMMAREA='.\n   03 CA-DATA                  PIC X(90) VALUE SPACES.\n\n 01 LGIPDB01                     PIC x(8) Value 'LGIPDB01'.\n\n 01  WS-POLICY-LENGTHS.\n   03 WS-CUSTOMER-LEN          PIC S9(4) COMP VALUE +72.\n   03 WS-POLICY-LEN            PIC S9(4) COMP VALUE +72.\n   03 WS-ENDOW-LEN             PIC S9(4) COMP VALUE +52.\n   03 WS-HOUSE-LEN             PIC S9(4) COMP VALUE +58.\n   03 WS-MOTOR-LEN             PIC S9(4) COMP VALUE +65.\n   03 WS-COMM-LEN              PIC S9(4) COMP VALUE +1102.\n   03 WS-CLAIM-LEN             PIC S9(4) COMP VALUE +546.\n   03 WS-FULL-ENDOW-LEN        PIC S9(4) COMP VALUE +124.\n   03 WS-FULL-HOUSE-LEN        PIC S9(4) COMP VALUE +130.\n   03 WS-FULL-MOTOR-LEN        PIC S9(4) COMP VALUE +137.\n   03 WS-FULL-COMM-LEN         PIC S9(4) COMP VALUE +1174.\n   03 WS-FULL-CLAIM-LEN        PIC S9(4) COMP VALUE +618.\n   03 WS-SUMRY-ENDOW-LEN       PIC S9(4) COMP VALUE +25.\n\n 01  DB2-CUSTOMER.\n   03 DB2-FIRSTNAME            PIC X(10).\n   03 DB2-LASTNAME             PIC X(20).\n   03 DB2-DATEOFBIRTH          PIC X(10).\n   03 DB2-HOUSENAME            PIC X(20).\n   03 DB2-HOUSENUMBER          PIC X(4).\n   03 DB2-POSTCODE             PIC X(8).\n   03 DB2-PHONE-MOBILE         PIC X(20).\n   03 DB2-PHONE-HOME           PIC X(20).\n   03 DB2-EMAIL-ADDRESS        PIC X(100).\n\n 01  DB2-POLICY.\n   03 DB2-POLICYTYPE           PIC X.\n   03 DB2-POLICYNUMBER         PIC 9(10).\n   03 DB2-POLICY-COMMON.\n     05 DB2-ISSUEDATE         PIC X(10).\n     05 DB2-EXPIRYDATE        PIC X(10).\n     05 DB2-LASTCHANGED       PIC X(26).\n     05 DB2-BROKERID          PIC 9(10).\n     05 DB2-BROKERSREF        PIC X(10).\n     05 DB2-PAYMENT           PIC 9(6).\n\n 01  DB2-ENDOWMENT.\n   03 DB2-ENDOW-FIXED.\n     05 DB2-E-WITHPROFITS      PIC X.\n     05 DB2-E-EQUITIES         PIC X.\n     05 DB2-E-MANAGEDFUND      PIC X.\n     05 DB2-E-FUNDNAME         PIC X(10).\n     05 DB2-E-TERM             PIC 9(2).\n     05 DB2-E-SUMASSURED       PIC 9(6).\n     05 DB2-E-LIFEASSURED      PIC X(31).\n   03 DB2-E-PADDINGDATA         PIC X(32611).\n\n 01  DB2-HOUSE.\n   03 DB2-H-PROPERTYTYPE       PIC X(15).\n   03 DB2-H-BEDROOMS           PIC 9(3).\n   03 DB2-H-VALUE              PIC 9(8).\n   03 DB2-H-HOUSENAME          PIC X(20).\n   03 DB2-H-HOUSENUMBER        PIC X(4).\n   03 DB2-H-POSTCODE           PIC X(8).\n\n 01  DB2-MOTOR.\n   03 DB2-M-MAKE               PIC X(15).\n   03 DB2-M-MODEL              PIC X(15).\n   03 DB2-M-VALUE              PIC 9(6).\n   03 DB2-M-REGNUMBER          PIC X(7).\n   03 DB2-M-COLOUR             PIC X(8).\n   03 DB2-M-CC                 PIC 9(4).\n   03 DB2-M-MANUFACTURED       PIC X(10).\n   03 DB2-M-PREMIUM            PIC 9(6).\n   03 DB2-M-ACCIDENTS          PIC 9(6).\n\n 01  DB2-COMMERCIAL.\n   03 DB2-B-Address            PIC X(255).\n   03 DB2-B-Postcode           PIC X(8).\n   03 DB2-B-Latitude           PIC X(11).\n   03 DB2-B-Longitude          PIC X(11).\n   03 DB2-B-Customer           PIC X(255).\n   03 DB2-B-PropType           PIC X(255).\n   03 DB2-B-FirePeril          PIC 9(4).\n   03 DB2-B-FirePremium        PIC 9(8).\n   03 DB2-B-CrimePeril         PIC 9(4).\n   03 DB2-B-CrimePremium       PIC 9(8).\n   03 DB2-B-FloodPeril         PIC 9(4).\n   03 DB2-B-FloodPremium       PIC 9(8).\n   03 DB2-B-WeatherPeril       PIC 9(4).\n   03 DB2-B-WeatherPremium     PIC 9(8).\n   03 DB2-B-Status             PIC 9(4).\n   03 DB2-B-RejectReason       PIC X(255).\n\n 01  DB2-CLAIM.\n   03 DB2-C-Num                PIC 9(10).\n   03 DB2-C-Date               PIC X(10).\n   03 DB2-C-Paid               PIC 9(8).\n   03 DB2-C-Value              PIC 9(8).\n   03 DB2-C-Cause              PIC X(255).\n   03 DB2-C-Observations       PIC X(255).\n\n 01  DFHCOMMAREA.\n   03 CA-REQUEST-ID            PIC X(6).\n   03 CA-RETURN-CODE           PIC 9(2).\n   03 CA-CUSTOMER-NUM          PIC 9(10).\n   03 CA-REQUEST-SPECIFIC      PIC X(32482).\n   03 CA-CUSTOMER-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-FIRST-NAME         PIC X(10).\n     05 CA-LAST-NAME          PIC X(20).\n     05 CA-DOB                PIC X(10).\n     05 CA-HOUSE-NAME         PIC X(20).\n     05 CA-HOUSE-NUM          PIC X(4).\n     05 CA-POSTCODE           PIC X(8).\n     05 CA-NUM-POLICIES       PIC 9(3).\n     05 CA-PHONE-MOBILE       PIC X(20).\n     05 CA-PHONE-HOME         PIC X(20).\n     05 CA-EMAIL-ADDRESS      PIC X(100).\n     05 CA-POLICY-DATA        PIC X(32267).\n   03 CA-CUSTSECR-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-CUSTSECR-PASS      PIC X(32).\n     05 CA-CUSTSECR-COUNT     PIC X(4).\n     05 CA-CUSTSECR-STATE     PIC X.\n     05 CA-CUSTSECR-DATA      PIC X(32445).\n   03 CA-POLICY-REQUEST REDEFINES CA-REQUEST-SPECIFIC.\n     05 CA-POLICY-NUM         PIC 9(10).\n     05 CA-POLICY-COMMON.\n       07 CA-ISSUE-DATE      PIC X(10).\n       07 CA-EXPIRY-DATE     PIC X(10).\n       07 CA-LASTCHANGED     PIC X(26).\n       07 CA-BROKERID        PIC 9(10).\n       07 CA-BROKERSREF      PIC X(10).\n       07 CA-PAYMENT         PIC 9(6).\n     05 CA-POLICY-SPECIFIC    PIC X(32400).\n     05 CA-ENDOWMENT REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-E-WITH-PROFITS    PIC X.\n       07 CA-E-EQUITIES        PIC X.\n       07 CA-E-MANAGED-FUND    PIC X.\n       07 CA-E-FUND-NAME       PIC X(10).\n       07 CA-E-TERM            PIC 99.\n       07 CA-E-SUM-ASSURED     PIC 9(6).\n       07 CA-E-LIFE-ASSURED    PIC X(31).\n       07 CA-E-PADDING-DATA    PIC X(32348).\n     05 CA-HOUSE REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-H-PROPERTY-TYPE   PIC X(15).\n       07 CA-H-BEDROOMS        PIC 9(3).\n       07 CA-H-VALUE           PIC 9(8).\n       07 CA-H-HOUSE-NAME      PIC X(20).\n       07 CA-H-HOUSE-NUMBER    PIC X(4).\n       07 CA-H-POSTCODE        PIC X(8).\n       07 CA-H-FILLER          PIC X(32342).\n     05 CA-MOTOR REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-M-MAKE            PIC X(15).\n       07 CA-M-MODEL           PIC X(15).\n       07 CA-M-VALUE           PIC 9(6).\n       07 CA-M-REGNUMBER       PIC X(7).\n       07 CA-M-COLOUR          PIC X(8).\n       07 CA-M-CC              PIC 9(4).\n       07 CA-M-MANUFACTURED    PIC X(10).\n       07 CA-M-PREMIUM         PIC 9(6).\n       07 CA-M-ACCIDENTS       PIC 9(6).\n       07 CA-M-FILLER          PIC X(32323).\n     05 CA-COMMERCIAL REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-B-Address         PIC X(255).\n       07 CA-B-Postcode        PIC X(8).\n       07 CA-B-Latitude        PIC X(11).\n       07 CA-B-Longitude       PIC X(11).\n       07 CA-B-Customer        PIC X(255).\n       07 CA-B-PropType        PIC X(255).\n       07 CA-B-FirePeril       PIC 9(4).\n       07 CA-B-FirePremium     PIC 9(8).\n       07 CA-B-CrimePeril      PIC 9(4).\n       07 CA-B-CrimePremium    PIC 9(8).\n       07 CA-B-FloodPeril      PIC 9(4).\n       07 CA-B-FloodPremium    PIC 9(8).\n       07 CA-B-WeatherPeril    PIC 9(4).\n       07 CA-B-WeatherPremium  PIC 9(8).\n       07 CA-B-Status          PIC 9(4).\n       07 CA-B-RejectReason    PIC X(255).\n       07 CA-B-FILLER          PIC X(31298).\n     05 CA-CLAIM      REDEFINES CA-POLICY-SPECIFIC.\n       07 CA-C-Num             PIC 9(10).\n       07 CA-C-Date            PIC X(10).\n       07 CA-C-Paid            PIC 9(8).\n       07 CA-C-Value           PIC 9(8).\n       07 CA-C-Cause           PIC X(255).\n       07 CA-C-Observations    PIC X(255).\n       07 CA-C-FILLER          PIC X(31854).\n\n", "lineNumber": -2, "summary": "Below is a \"DATA LAYOUT FOR lgipol01.cbl\" in the file \"lgipol01.cbl\"\nStructure: DATA LAYOUT FOR lgipol01.cbl\nDescription: Legacy COBOL system structure analysis. Goal: Identify business entity, key fields, and storage/file I/O/API usage.\nFields: WS-EYECATCHER, WS-TRANSID, WS-TERMID, WS-TASKNUM, ABS-TIME, TIME1, DATE1, ERROR-MSG, CA-ERROR-MSG, DB2-CUSTOMER, DB2-POLICY, DB2-ENDOWMENT, DB2-HOUSE, DB2-MOTOR, DB2-COMMERCIAL, DB2-CLAIM"}, {"fileName": "lgipol01.cbl", "type": "SECTION", "name": "MAINLINE", "content": "EXIT\n\nEXEC CICS ASKTIME ABSTIME(ABS-TIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(ABS-TIME)\r\n       MMDDYYYY(DATE1)\r\n       TIME(TIME1)\r\n       END-EXEC\nMOVE DATE1 TO EM-DATE\nMOVE TIME1 TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n\n", "lineNumber": 280, "summary": "The below code segment is a \"SECTION\" named \"MAINLINE\" which is in the file \"lgipol01.cbl\" at line number \"280\"\nBusiness Intent: Retrieve current date and time, format it in MMDDYYYY and TIME formats, and perform a link to the LGSTSQ program with error handling.\nTechnical Action: Uses CICS commands ASKTIME and FORMATTIME to retrieve and format the date and time. Then uses LINK command to invoke the LGSTSQ program with a COMMAREA for error messages.\nKeywords: CICS, COBOL, ASKTIME, FORMATTIME, LINK, COMMAREA, Error Handling"}, {"fileName": "lgipol01.cbl", "type": "PARAGRAPH", "name": "WRITE-ERROR-MESSAGE", "content": "EXEC CICS ASKTIME ABSTIME(ABS-TIME)\r\n       END-EXEC\r\n       EXEC CICS FORMATTIME ABSTIME(ABS-TIME)\r\n       MMDDYYYY(DATE1)\r\n       TIME(TIME1)\r\n       END-EXEC\nMOVE DATE1 TO EM-DATE\nMOVE TIME1 TO EM-TIME\nEXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(ERROR-MSG)\r\n       LENGTH(LENGTH OF ERROR-MSG)\r\n       END-EXEC\nIF EIBCALEN > 0 THEN\r\n             IF EIBCALEN < 91 THEN\r\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             ELSE\r\n               MOVE DFHCOMMAREA(1:90) TO CA-DATA\r\n       EXEC CICS LINK PROGRAM('LGSTSQ')\r\n       COMMAREA(CA-ERROR-MSG)\r\n       LENGTH(LENGTH OF CA-ERROR-MSG)\r\n       END-EXEC\r\n             END-IF\r\n           END-IF\nEXIT\n", "lineNumber": 317, "summary": "The below code segment is a \"PARAGRAPH\" named \"WRITE-ERROR-MESSAGE\" which is in the file \"lgipol01.cbl\" at line number \"317\"\nBusiness Intent: Retrieve and format the current system time for logging purposes, and link to a program to process error messages if present.\nTechnical Action: Use COBOL statements to execute CICS commands (ASKTIME, FORMATTIME) and LINK to another program, handling errors if necessary.\nKeywords: CICS, COBOL, system_time, logging, error_handling, LINK_PROGRAM"}]